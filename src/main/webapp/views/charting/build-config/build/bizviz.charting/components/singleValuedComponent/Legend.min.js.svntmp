/*! BizViz Charting Library V3.0.1 (2017-06-21 19:02:45) 
 Copyright (c) 2015-2017. Big Data BizViz LLC. All Rights Reserved */

function Legend(a,b){this.base=Widget,this.base(),this.m_bordercolor="",this.m_bgalpha="",this.m_bggradients="",this.m_borderthickness="",this.m_bggradientrotation="",this.m_borderalpha="",this.m_fontfamily="",this.m_fontsize="",this.m_fontcolor="",this.m_fontstyle="",this.m_fontweight="",this.m_textdecoration="",this.m_legenddirection="",this.m_legendcheckbox="",this.m_legendsymbol="",this.m_associatedchartid="",this.m_showborder="",this.m_chartContainer=a,this.m_zIndex=b,this.m_chartFrame=new ChartFrame,this.m_legendwidth=12,this.m_legendheight=10,this.m_legendcolors="#E08283,#38d3a9,#797979",this.m_legendnames="Series1,Series2,Series3",this.m_legendshapes="cube,triangle,point",this.legendsWidthArray=[],this.marginLeft=15,this.marginTop=10,this.marginGap=10,this.checkboxChangedFlag=!1,this.m_original_x,this.m_original_y,this.m_original_width,this.m_original_height,this.m_original_zindex,this.legendNames=[],this.legendDisplayNames=[],this.legendColors=[],this.legendShapes=[],this.isMaximized=!1}Legend.prototype=new Widget,Legend.prototype.setProperty=function(a){this.ParseJsonAttributes(a.Object,this),this.initCanvas()},Legend.prototype.ParseJsonAttributes=function(a,b){for(var c in a)if("Legend"==c)for(rectangleKey in a[c])this.setAttributeValueToNode(rectangleKey,a[c],b);else this.setAttributeValueToNode(c,a,b)},Legend.prototype.initCanvas=function(){var a=this;$("#draggableDiv"+a.m_objectid).remove(),this.initializeDraggableDivAndCanvas()},Legend.prototype.initializeDraggableDivAndCanvas=function(){this.setDashboardNameAndObjectId(),this.m_draggableDiv=this.createDraggableDiv(this.m_chartContainer,this.m_zIndex),this.createDraggableCanvas(this.m_draggableDiv),this.setCanvasContext(),this.initMouseClickEvent()},Legend.prototype.setDashboardNameAndObjectId=function(){this.m_objectId=this.m_objectid,2==this.m_objectid.split(".").length&&(this.m_objectid=this.m_objectid.split(".")[1]),this.m_componentid=this.m_objectid},Legend.prototype.initialize=function(a,b){this.parseXML(a,b)},Legend.prototype.draw=function(){this.drawObject()},Legend.prototype.drawObject=function(){this.getAssociatedChartObject()&&(this.isMaximized=this.getAssociatedChartObject().isMaximized),IsBoolean(this.checkboxChangedFlag)||(!IsBoolean(this.m_designMode)&&void 0!=this.getAssociatedChartObject()&&IsBoolean(this.getAssociatedChartObject().isMaximized)?this.repositionLegend(this.associatedChartObject):void 0!=this.m_original_x&&this.setOriginalPosition(),this.init(),this.drawChart())},Legend.prototype.getAssociatedChartObject=function(){if(void 0!=this.m_dashboard.m_widgetsArray)for(var a=0;a<this.m_dashboard.m_widgetsArray.length;a++)if(this.m_associatedchartid==this.m_dashboard.m_widgetsArray[a].m_objectid)return this.m_dashboard.m_widgetsArray[a]},Legend.prototype.getLegendName=function(a){return a.getLegendNames()},Legend.prototype.getLegendColors=function(a){var b=(a.getLegendNames(),a.getSeriesColors());return b},Legend.prototype.getLegendShapes=function(a){return a.m_plotShapeArray},Legend.prototype.getBgGradients=function(){return this.m_bggradients},Legend.prototype.createLegendContainerDiv=function(){var a=this;$("#LegendContainerDiv"+a.m_objectid).remove();var b=document.createElement("div");b.setAttribute("id","LegendContainerDiv"+a.m_objectid),b.setAttribute("style","position:absolute;left:0px;top:0px;width:inherit;height:inherit;overflow:overlay;"),$("#draggableDiv"+a.m_objectid).append(b)},Legend.prototype.init=function(){this.checkBoxWidth=1*this.m_fontsize<12?12:1*this.m_fontsize,this.createLegendContainerDiv(),this.m_chartFrame.init(this),this.m_designMode||void 0==this.getAssociatedChartObject()?this.setLegendInfoForStatic():(this.associatedChartObject=this.getAssociatedChartObject(),this.setLegendInfoForAssignedChart(this.associatedChartObject))},Legend.prototype.setLegendInfoForAssignedChart=function(a){this.legendNames=[],this.legendDisplayNames=[],this.legendColors=[],this.legendShapes=[];var b=a.getLegendInfo();for(var c in b)this.legendNames.push(b[c].seriesName),this.legendDisplayNames.push(b[c].displayName),this.legendColors.push(b[c].color),this.legendShapes.push(b[c].shape)},Legend.prototype.setLegendInfoForStatic=function(a){this.legendNames=this.m_legendnames.split(","),this.legendDisplayNames=this.m_legendnames.split(","),this.legendColors=this.m_legendcolors.split(","),this.legendShapes=this.m_legendshapes.split(",")},Legend.prototype.drawChart=function(){this.m_chartFrame.drawFrame(),void 0!=this.legendNames&&(this.calculateLegendsWidth(),this.drawLegend())},Legend.prototype.drawLegend=function(){for(var a=0;a<this.legendNames.length;a++)""!=this.legendNames[a]&&(IsBoolean(this.m_legendcheckbox)&&this.drawLegendCheckbox(a),this.drawHtmlLegends(a),this.drawHtmlLegendText(a))},Legend.prototype.drawLegendCheckbox=function(a){var b=this,c=this.getCheckboxCoordinates(a),d=document.createElement("input");d.setAttribute("type","checkbox"),IsBoolean(this.m_designMode)||void 0==b.associatedChartObject?d.setAttribute("checked",!0):d.setAttribute(1==IsBoolean(b.associatedChartObject.m_seriesVisibleArr[this.legendNames[a]])?"checked":"unchecked",!0),d.setAttribute("id",this.m_objectid+"LegendCheckbox"+this.legendNames[a]),d.setAttribute("style","position:absolute;top:"+c.y+"px;left:"+c.x+"px;"),$("#LegendContainerDiv"+b.m_objectid).append(d),$(d).css({width:b.fontScaling(this.checkBoxWidth)+"px",height:b.fontScaling(this.checkBoxWidth)+"px"}),IsBoolean(b.m_designMode)||(d.onchange=function(){void 0!=b.associatedChartObject&&(b.associatedChartObject.m_seriesVisibleArr[$(this).attr("id").split("LegendCheckbox")[1]]=this.checked,b.checkboxChangedFlag=!0,b.associatedChartObject.draw()),b.getDataPointAndUpdateGlobalVariable(b.legendDisplayNames[a],b.legendNames[a],b.legendColors[a])})},Legend.prototype.drawHtmlLegends=function(a){"defaultshape"!=this.m_legendsymbol&&void 0!=this.legendShapes&&this.legendShapes.length>0?this.drawLegendShape(a,this.m_shapeMap.hasOwnProperty(this.legendShapes[a])?this.m_shapeMap[this.legendShapes[a]]:this.m_shapeMap.default):this.drawLegendShape(a,this.m_shapeMap.default)},Legend.prototype.drawLegendShape=function(a,b){var c=this,d=this.getLegendShapeCoordinates(a),e=document.createElement("div");e.setAttribute("id","LegendShape"+c.legendNames[a]+c.m_objectid),e.setAttribute("style","position:absolute;left:"+d.x+"px;top:"+d.y+"px;background:"+hex2rgb("#ffffff",0)+";"),$("#LegendContainerDiv"+c.m_objectid).append(e);var f=document.createElement("a");$(f).attr("class",b);var g=this.m_legendwidth;"bd-diamond"==b?g=1*this.m_legendwidth+2:"bd-stop"!=b&&"bd-cross"!=b||(g=1*this.m_legendwidth-1),$(f).css({color:this.legendColors[a],"font-size":1*g+"px",display:"inherit","margin-top":"-2px"}),$(e).append(f)},Legend.prototype.drawHtmlLegendText=function(a){var b=this,c=this.getTextCoordinates(a),d=document.createElement("div"),e=this.fontScaling(1*this.m_fontsize)>10?-4:-2;d.appendChild(document.createTextNode(this.legendDisplayNames[a])),d.setAttribute("id",b.m_objectid+""+b.legendNames[a]),d.setAttribute("title",this.legendNames[a]),d.setAttribute("style","margin-bottom:0px;position:absolute;margin-top:"+this.fontScaling(e)+"px;left:"+c.x+"px;top:"+c.y+"px;font-weight:"+this.m_fontweight+";font-size:"+this.fontScaling(1*this.m_fontsize)+"px;font-style:"+this.m_fontstyle+";font-family:"+this.m_fontfamily+";color:"+this.m_fontcolor+";text-decoration:"+this.m_textdecoration+";"),$("#LegendContainerDiv"+b.m_objectid).append(d),d.onclick=function(){IsBoolean(b.m_designMode)||b.getDataPointAndUpdateGlobalVariable(b.legendDisplayNames[a],b.legendNames[a],b.legendColors[a])}},Legend.prototype.getCheckboxCoordinates=function(a){var b,c;if("vertical"==this.m_legenddirection)b=this.fontScaling(1*this.marginLeft),c=1*this.marginTop+this.getLegendTextHeight(this.fontScaling(1*this.m_fontsize)+"px",this.m_fontfamily)*a+this.marginGap*a-5;else{var d=this.getHorizontalCoordinates(a);b=this.fontScaling(d.hx)+this.fontScaling(1*this.marginLeft),c=1*this.marginTop+this.getLegendTextHeight(this.fontScaling(1*this.m_fontsize)+"px",this.m_fontfamily)*d.hy+this.marginGap*d.hy-5}return{x:b,y:c}},Legend.prototype.getLegendShapeCoordinates=function(a){var b,c,d=IsBoolean(this.m_legendcheckbox)?1*this.marginGap+this.checkBoxWidth:0;if("vertical"==this.m_legenddirection)b=this.fontScaling(1*this.marginLeft)+this.fontScaling(d),c=1*this.marginTop+this.getLegendTextHeight(this.fontScaling(1*this.m_fontsize)+"px",this.m_fontfamily)*a+this.marginGap*a;else{var e=this.getHorizontalCoordinates(a);b=this.fontScaling(1*e.hx)+this.fontScaling(1*this.marginLeft)+this.fontScaling(d),c=1*this.marginTop+this.getLegendTextHeight(this.fontScaling(1*this.m_fontsize)+"px",this.m_fontfamily)*e.hy+this.marginGap*e.hy}return{x:b,y:c}},Legend.prototype.getTextCoordinates=function(a){var b,c,d=IsBoolean(this.m_legendcheckbox)?1*this.marginGap+this.checkBoxWidth:0;if("vertical"==this.m_legenddirection)b=this.fontScaling(1*this.marginLeft)+1*this.m_legendwidth+this.fontScaling(1*this.marginGap)+this.fontScaling(1*d),c=1*this.marginTop+this.getLegendTextHeight(this.fontScaling(1*this.m_fontsize)+"px",this.m_fontfamily)*a+this.marginGap*a;else{var e=this.getHorizontalCoordinates(a);b=this.fontScaling(1*e.hx)+this.fontScaling(1*this.marginLeft)+1*this.m_legendwidth+this.fontScaling(1*this.marginGap)+this.fontScaling(1*d),c=1*this.marginTop+this.getLegendTextHeight(this.fontScaling(1*this.m_fontsize)+"px",this.m_fontfamily)*e.hy+this.marginGap*e.hy}return{x:b,y:c}},Legend.prototype.getHorizontalCoordinates=function(a){for(var b,c,d=0,e=0,f=0;f<this.legendsWidthArray.length;f++)if(e=1*e+1*this.legendsWidthArray[f],e>this.m_width&&(d++,e=this.legendsWidthArray[f]),f==a){b=e-this.legendsWidthArray[f],c=d;break}return{hx:b,hy:c}},Legend.prototype.calculateLegendsWidth=function(){var a=this;this.m_legendwidth=this.fontScaling(this.m_fontsize),this.m_legendheight=this.fontScaling(this.m_fontsize),this.ctx.font=""+this.m_fontstyle+" "+this.m_fontweight+" "+this.fontScaling(1*this.m_fontsize)+"px "+this.m_fontfamily;var b=IsBoolean(this.m_legendcheckbox)?1*this.marginGap+this.checkBoxWidth:0;this.createSpanToCalculateWidth(),this.legendsWidthArray=[];for(var c=0;c<this.legendDisplayNames.length;c++){var d=this.getTextWidth(this.legendDisplayNames[c]),e=1*this.marginLeft+1*b+1*this.marginGap+1*this.m_legendwidth+1*this.marginGap+1*d+1*this.marginGap;this.legendsWidthArray.push(e)}$("#textWidthCalcDiv"+a.m_objectid).remove()},Legend.prototype.createSpanToCalculateWidth=function(){var a=this;$("#textWidthCalcDiv"+a.m_objectid).remove();var b=document.createElement("div");b.id="textWidthCalcDiv"+a.m_objectid,b.style.position="absolute",b.style.float="left",b.style.whiteSpace="nowrap",b.style.visibility="hidden",b.style.display="none",b.style.fontSize=this.fontScaling(1*this.m_fontsize)+"px",b.style.fontFamily=this.m_fontfamily,b.style.fontWeight=this.m_fontweight,b.style.fontStyle=this.m_fontstyle,document.body.appendChild(b)},Legend.prototype.getTextWidth=function(a){var b=this;try{return $("#textWidthCalcDiv"+b.m_objectid).html(""+a),$("#textWidthCalcDiv"+b.m_objectid).width()}catch(b){return this.ctx.measureText(""+a).width}},Legend.prototype.getNoOfRows=function(a){for(var b=1,c=0,d=0;d<this.legendsWidthArray.length;d++)c=1*c+1*this.legendsWidthArray[d],c>1*a&&(b++,c=this.legendsWidthArray[d]);return b},Legend.prototype.getOneRowHeight=function(){return 1*this.marginTop+1*this.m_legendheight+1*this.marginGap},Legend.prototype.getLargestLegend=function(){for(var a=0,b=0;b<this.legendsWidthArray.length;b++)1*this.legendsWidthArray[b]>a&&(a=this.legendsWidthArray[b]);return a},Legend.prototype.getLegendMargins=function(a){var b=0,c=0;if("horizontal"==this.m_legenddirection){var d=this.getNoOfRows(a),e=this.getOneRowHeight();b=d*e,c=0}else b=0,c=this.getLargestLegend();return{bottom:b,right:c}},Legend.prototype.repositionLegend=function(a){var b,c,d,e,f=this;this.m_original_x=$("#draggableDiv"+f.m_objectid)[0].offsetLeft,this.m_original_y=$("#draggableDiv"+f.m_objectid)[0].offsetTop,this.m_original_width=this.m_width,this.m_original_height=this.m_height,this.m_original_zindex=this.m_zIndex;var g=($("#draggableCanvas"+a.m_objectid),$("#draggableDiv"+a.m_objectid)),h=this.getLegendMargins(g.css("width"));"horizontal"==this.m_legenddirection?(b=g.css("left").split("px")[0],c=1*g.css("top").split("px")[0]+1*g.css("height").split("px")[0],d=g.css("width").split("px")[0],e=h.bottom):(b=1*g.css("left").split("px")[0]+1*g.css("width").split("px")[0],c=g.css("top").split("px")[0],d=h.right,e=g.css("height").split("px")[0]),$("#draggableDiv"+f.m_objectid).css({"z-index":a.maximizeZindex,left:b+"px",top:c+"px",width:d+"px",height:e+"px"}),$("#draggableCanvas"+f.m_objectid).attr("width",d),$("#draggableCanvas"+f.m_objectid).attr("height",e),$("#draggableCanvas"+f.m_objectid).css({width:d,height:e}),this.adjustPixelRatio(),this.m_width=d,this.m_height=e},Legend.prototype.setOriginalPosition=function(){var a=this;this.m_width=this.m_original_width,this.m_height=this.m_original_height,$("#draggableDiv"+a.m_objectid)[0].offsetLeft=this.m_original_x,$("#draggableDiv"+a.m_objectid)[0].offsetTop=this.m_original_y,$("#draggableDiv"+a.m_objectid).css({"z-index":this.m_zIndex,left:1*this.m_original_x+"px",top:1*this.m_original_y+"px",width:this.m_original_width+"px",height:this.m_original_height+"px"}),$("#draggableCanvas"+a.m_objectid).attr("width",this.m_original_width),$("#draggableCanvas"+a.m_objectid).attr("height",this.m_original_height),$("#draggableCanvas"+a.m_objectid).css({width:this.m_original_width,height:this.m_original_height}),this.adjustPixelRatio(),this.m_x=0,this.m_y=0},Legend.prototype.getLegendTextHeight=function(a,b){var c=$('<span style="font-size:'+this.fontScaling(1*a)+"; font-family:"+b+';">Hg</span>'),d=$('<div style="display: inline-block; width: 1px; height: 0px;"></div>'),e=$("<div></div>");e.append(c,d);var f=$("body");f.append(e);try{var g={};d.css({verticalAlign:"baseline"}),g.ascent=d.offset().top-c.offset().top,d.css({verticalAlign:"bottom"}),g.height=d.offset().top-c.offset().top,g.descent=g.height-g.ascent}finally{e.remove()}return g.height},Legend.prototype.getDataPointAndUpdateGlobalVariable=function(a,b,c){var d={drillDisplayField:a,drillField:b};this.updateDataPoints(d,c)};
//# sourceMappingURL=Legend.min.js.map