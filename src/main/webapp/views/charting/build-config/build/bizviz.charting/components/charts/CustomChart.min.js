/*! BDB Charting Library V10.0.0 (2025-08-14 11:37:12) 
 Copyright 2015-2024 BDB (BizViz Technologies Pvt Ltd). All Rights Reserved */
function CustomChart(t,e){this.base=Chart,this.base(),this.m_chartContainer=t,this.m_zIndex=e,this.m_jspaths=[],this.m_csspaths=[],this.m_htmlcontent='<div class="statusMessage"><p>Data not available !</p></div>',this.m_csscontent="body{margin: 0px; font-family: Roboto} .statusMessage p{ color: #EF6C00; font-size: 12px; margin: 0; position: absolute; top: 50%; left: 50%; margin-right: -50%; transform: translate(-50%, -50%); }",this.m_jscontent="",this.m_frame=""}CustomChart.prototype=new Chart,CustomChart.prototype.setProperty=function(t){this.ParseJsonAttributes(t.Object,this),this.initCanvas()},CustomChart.prototype.initCanvas=function(){$("#draggableDiv"+this.m_objectid).remove(),this.initializeDraggableDivAndCanvas()},CustomChart.prototype.initializeDraggableDivAndCanvas=function(){this.setDashboardNameAndObjectId(),this.m_draggableDiv=this.createDraggableDiv(this.m_chartContainer,this.m_zIndex),this.createDraggableCanvas(this.m_draggableDiv),this.setCanvasContext()},CustomChart.prototype.ParseJsonAttributes=function(t,e){for(var i in this.chartJson=t)if("Chart"==i)for(var a in t[i])switch(a){case"Title":for(var s in t[i][a]){var r=this.getNodeAttributeName(s);e.m_title[r]=t[i][a][s]}break;case"SubTitle":for(var o in t[i][a]){var r=this.getNodeAttributeName(o);e.m_subTitle[r]=t[i][a][o]}break;default:e[r=this.getNodeAttributeName(a)]=t[i][a]}else e[r=this.getNodeAttributeName(i)]=t[i]},CustomChart.prototype.setFields=function(t){try{t=getDuplicateArray(t)}catch(t){}for(var e=[],i=(this.m_fieldsJson=t).length,a=0;a<i;a++)switch(this.getProperAttributeNameValue(t[a],"Type")){case"Series":case"CalculatedField":e.push(t[a])}this.setSeries(e)},CustomChart.prototype.setSeries=function(t){this.m_seriesNames=[],this.m_seriesDisplayNames=[];for(var e=0,i=t.length,a=0;a<i;a++){this.m_seriesNames[e]=this.getProperAttributeNameValue(t[a],"Name");var s=this.formattedDescription(this,this.getProperAttributeNameValue(t[a],"DisplayName"));this.m_seriesDisplayNames[e]=s,e++}},CustomChart.prototype.getFields=function(){return this.m_fieldsJson},CustomChart.prototype.getDataProvider=function(){return this.m_dataProvider},CustomChart.prototype.eventCallBack=function(t,e,i){"mousemove"!=t.type&&"mouseout"!=t.type&&"click"==t.type&&this.updateDataPointsToGV({drillRecord:e,drillColor:""})},CustomChart.prototype.getSeriesNames=function(){return this.m_seriesNames},CustomChart.prototype.setCategorySeriesData=function(){this.m_categoryData=[],this.m_seriesData=[];for(var t=0,e=this.getDataProvider().length;t<e;t++){var i=this.getDataProvider()[t];this.isEmptyCategory=!1;for(var a=0,s=this.getSeriesNames().length;a<s;a++){this.m_seriesData[a]||(this.m_seriesData[a]=[]);var r="",o=this.getSeriesNames()[a];null!=i[o]&&"undefined"!=i[o]&&(r=i[o]),isNaN(r)&&(r=getNumericComparableValue(r)),this.m_seriesData[a][t]=r}}},CustomChart.prototype.setStartX=function(){this.m_startX=+this.m_x},CustomChart.prototype.setEndX=function(){this.m_endX=+this.m_startX+ +this.m_width},CustomChart.prototype.setStartY=function(){this.m_startY=+this.m_y+this.m_height},CustomChart.prototype.setEndY=function(){this.m_endY=+this.m_y+ +this.getMarginForTitle()+ +this.getMarginForSubTitle()},CustomChart.prototype.init=function(){this.setCategorySeriesData(),this.isSeriesDataEmpty(),this.setChartDrawingArea(),this.m_chartFrame.init(this),this.m_title.init(this),this.m_subTitle.init(this)},CustomChart.prototype.drawChart=function(){if(this.drawChartFrame(),this.drawTitle(),this.drawSubTitle(),this.m_designMode){this.createInnerDiv(this.m_draggableDiv);try{this.drawDesignModeCustomChart()}catch(t){this.drawMessage("Failed to import custom chart, Please check log !")}}else{var t=this.IsDrawingPossible();IsBoolean(t.permission)?this.drawCustomChart():this.drawMessage(t.message)}},CustomChart.prototype.IsDrawingPossible=function(){return IsBoolean(this.m_isEmptySeries)?{permission:"false",message:this.m_status.noData}:{permission:"true",message:this.m_status.success}},CustomChart.prototype.drawChartFrame=function(){this.m_chartFrame.drawFrame()},CustomChart.prototype.drawTitle=function(){this.m_title.draw()},CustomChart.prototype.drawSubTitle=function(){this.m_subTitle.draw()},CustomChart.prototype.hideCanvas=function(){$("#draggableCanvas"+this.m_objectid).css("display","none"),$("#draggableDiv"+this.m_objectid).find("svg").remove()},CustomChart.prototype.createInnerDiv=function(t){$("#innerDiv"+this.m_objectid).remove();var e=document.createElement("div");return e.setAttribute("id","innerDiv"+this.m_objectid),e.style.height="100%",e.style.width="100%",e.style.top="0%",e.style.left="0%",e.style.position="absolute",e.style.zIndex="2",$(t).append(e),e},CustomChart.prototype.drawDesignModeCustomChart=function(){var t=["2012","2013","2014","2015","2016","2017","2018"],e=[3,6,12,6,24,9,15],i=this.m_width,a=this.m_height,s=40,r=+this.getEndY()+20,o="#f89406",n=Raphael("innerDiv"+this.m_objectid,i,a),h={font:"12px Roboto",fill:"#808080"},c=(i-10)/t.length,m=(a-s-r)/Math.max.apply(Math,e),i=n.path().attr({stroke:o,"stroke-width":4,"stroke-linejoin":"round"}),r=n.path().attr({stroke:"none",opacity:.2,fill:o}),o=n.set();n.set();o.hide();for(var d,l,p,u,g=0,C=t.length;g<C;g++){var y,b,f,v,_,w,D=Math.round(a-s-m*e[g]),x=Math.round(10+c*(g+.5));n.text(x,a-20-6,t[g]).attr(h).toBack(),g||(_=["M",x,D,"C",x,D],w=["M",10+.5*c,a-s,"L",x,D,"C",x,D]),g&&g<C-1&&(y=Math.round(a-s-m*e[g-1]),b=Math.round(10+c*(g-.5)),v=Math.round(a-s-m*e[g+1]),f=Math.round(10+c*(g+1.5)),y=y,l=D,v=v,u=p=void 0,p=((d=x)-(b=b))/2,u=((f=f)-d)/2,b=Math.atan((d-b)/Math.abs(l-y)),f=Math.atan((f-d)/Math.abs(l-v)),b=y<l?Math.PI-b:b,f=v<l?Math.PI-f:f,y=Math.PI/2-(b+f)%(2*Math.PI)/2,v={x1:d-p*Math.sin(y+b),y1:l+p*Math.cos(y+b),x2:d+u*Math.sin(y+f),y2:l+u*Math.cos(y+f)},_=_.concat([v.x1,v.y1,x,D,v.x2,v.y2]),w=w.concat([v.x1,v.y1,x,D,v.x2,v.y2])),n.circle(x,D,4).attr({fill:"rgba(248, 148, 6, 0.5)",stroke:"#fff","stroke-width":2})}_=_.concat([x,D,x,D]),w=w.concat([x,D,x,D,"L",x,a-s,"z"]),i.attr({path:_}),r.attr({path:w})},CustomChart.prototype.setDesignModeCustomChart=function(){this.m_jspaths=[{name:"d3",src:"//d3js.org/d3.v4.min.js"}],this.m_htmlcontent='<div class="customCompContainer" id="customCompContainer'+this.m_objectid+'"></div>',this.m_csscontent="body{ margin: 0px; padding: 0px; background: transparent;} .customCompContainer{width:100%; height: 100%;}",this.m_jscontent='var drawDesignModeCustomComp = function(w, h, id, data, cat, ser, sercolor, chartID) {    \tvar svg = d3.select("#"+id)    \t.append("svg")    \t.attr("width", w)    \t.attr("height", h),        margin = {top: 40, right: 40, bottom: 40, left: 40},        width = +svg.attr("width") - margin.left - margin.right,        height = +svg.attr("height") - margin.top - margin.bottom;    \tvar x = d3.scaleBand().rangeRound([0, width]).padding(0.1),    \t    y = d3.scaleLinear().rangeRound([height, 0]);    \t    \tvar g = svg.append("g")    \t    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");    \t    \tvar tooltipdiv = d3.select("body").append("div")\t        .attr("class", "d3tooltip")\t\t\t\t        .style("background", "#ffffff")        .style("padding", "10px")        .style("opacity", 0)        .style("display", "none")        .style("position", "absolute");    \t    \tx.domain(data.map(function(d) { return d[cat]; }));    \t  y.domain([0, d3.max(data, function(d) { return 1*d[ser]; })]);    \t    \t  g.append("g")    \t      .attr("class", "axis axis--x")    \t      .attr("transform", "translate(0," + height + ")")    \t      .call(d3.axisBottom(x));    \t    \t  g.append("g")    \t      .attr("class", "axis axis--y")    \t      .call(d3.axisLeft(y).ticks(5))    \t    .append("text")    \t      .attr("transform", "rotate(-90)")    \t      .attr("y", 6)    \t      .attr("dy", "0.71em")    \t      .attr("text-anchor", "end")    \t      .text("Frequency");    \t    \t  g.selectAll(".d3bar")    \t    .data(data)    \t    .enter().append("rect")    \t      .attr("class", "d3bar")    \t      .style("fill", sercolor)    \t      .attr("x", function(d) { return x(d[cat]); })    \t      .attr("y", function(d) { return y(d[ser]); })    \t      .attr("width", x.bandwidth())    \t      .attr("height", function(d) { return height - y(d[ser]); })    \t          \t      .on("mousemove", function(d,i,e) {    \t    \t  tooltipdiv.transition()                    .duration(100)        \t\t\t .style("display", "block")                    .style("opacity", 1);    \t    \t  tooltipdiv.html((d[cat]) + "<br/>"  + ser +": "+ d[ser])                    .style("left", (d3.event.pageX + 30) + "px")                    .style("top", (d3.event.pageY - 30) + "px");\t\t\t\t\tparent.window.dGlobals.containerCallback(chartID, event, d,i,e);                })            .on("mouseout", function(d,i,e) {            \ttooltipdiv.transition()                    .duration(400)        \t\t\t .style("display", "none")                    .style("opacity", 0);\t\t\t\t\tparent.window.dGlobals.containerCallback(chartID, event, d,i,e);            })            .on("click", function(d,i,e) {    \t    \t  \tparent.window.dGlobals.containerCallback(chartID, event, d,i,e);                });    };        drawDesignModeCustomComp('+(this.m_width-2*this.m_borderthickness)+", "+(this.m_height-2*this.m_borderthickness-this.getEndY())+', "customCompContainer'+this.m_objectid+'", [{date: "13-May", a: "5", b: "3"},{date: "14-May", a: "4", b: "2"},{date: "15-May", a: "3", b: "1"},{date: "16-May", a: "4", b: "2"}], "date", "a", "#f89406");'},CustomChart.prototype.getEndY=function(){return this.m_y+ +this.getMarginForTitle()+ +this.getMarginForSubTitle()},CustomChart.prototype.getMarginForTitle=function(){return IsBoolean(this.getShowGradient())||IsBoolean(this.m_showmaximizebutton)||IsBoolean(this.getTitle().m_showtitle)?+this.getTitleBarHeight():0},CustomChart.prototype.getMarginForSubTitle=function(){return(IsBoolean(this.m_subTitle.m_showsubtitle)||IsBoolean(this.getShowGradient())||IsBoolean(this.getTitle().m_showtitle))&&""!=this.m_subTitle.getDescription()?1.5*this.fontScaling(this.m_subTitle.getFontSize()):0},CustomChart.prototype.getPreProcessedScript=function(){return this.m_designMode?"":"var bizvizchart = {chartJson: "+JSON.stringify(this.chartJson)+"}; bizvizchart.chart = parent.sdk.getWidget(bizvizchart.chartJson.referenceID); bizvizchart.getData=function(){return bizvizchart.chart.getDataProvider()}; bizvizchart.getFields=function(){return bizvizchart.chart.getFields()}; bizvizchart.getWidth=function(){return bizvizchart.chart.m_width - bizvizchart.chart.m_borderthickness*2}; bizvizchart.getHeight=function(){return bizvizchart.chart.m_height - bizvizchart.chart.m_borderthickness*2 - bizvizchart.chart.getEndY()*1}; bizvizchart.eventCallBack=function(event, data, index){ bizvizchart.chart.eventCallBack(event, data, index); };"},CustomChart.prototype.drawCustomChart=function(){var t=[],t=this.m_jspaths.map(function(t){return'<script type="text/javascript" src="'+getNoProtocolUrl(t.src)+'"><\/script>'}),e=[],t=((e=this.m_csspaths.map(function(t){return'<link rel="stylesheet" href="'+getNoProtocolUrl(t.src)+'" type="text/css">'})).push('<link rel="stylesheet" href="'+window.location.origin+'/home/shared/brand/fonts/font.css" type="text/css">'),"<html><head>"+t.join(" ")+e.join(" ")+"<style>body{ margin:0px; padding:0px; background: transparent;}"+this.m_csscontent+"</style></head><body>"+this.m_htmlcontent+'<script type="text/javascript">try{'+this.getPreProcessedScript()+'}catch(e){console.log(e);}<\/script><script type="text/javascript">try{ '+this.m_jscontent+"}catch(e){console.log(e);}<\/script></body></html>"),e=(""===this.m_frame&&($("#draggableDiv"+this.m_objectid).find("iframe").remove(),this.m_frame=document.createElement("iframe"),this.m_frame.setAttribute("id","CustomChart"+this.m_objectid),$("#draggableDiv"+this.m_objectid).append(this.m_frame)),$(this.m_frame).css({width:"100%",height:this.m_height-2*this.m_borderthickness-+this.getEndY()+"px",position:"absolute",top:this.getEndY()+"px",left:"0%",background:"transparent",border:"none"}),$(this.m_frame).contents(),$(this.m_frame)[0]),e=e.contentDocument||(e.contentWindow||e).document;try{e.open(),e.writeln(t),e.close()}catch(t){alertPopUpModal({type:"error",message:"Error in custom component drawing",timeout:"3000"})}};
//# sourceMappingURL=CustomChart.min.js.map