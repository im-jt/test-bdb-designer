/*! BDB Charting Library V10.0.0 (2025-08-14 11:37:12) 
 Copyright 2015-2024 BDB (BizViz Technologies Pvt Ltd). All Rights Reserved */
function DataSearch(t,e){this.base=Widget,this.base(),this.m_objectID=[],this.m_chartContainer=t,this.m_zIndex=e,this.m_globalkey="",this.m_objectID=[],this.m_componentid="",this.m_selecteddsid="",this.isDataStoreLoaded=!1,this.m_selecteddstore={},this.m_searchquery="",this.m_nlqresultobject={},this.m_associatedchart={chart:"",ds:"",fields:[],data:[]},this.m_associateddschartid="",this.m_panelheight=300,this.m_paneliconfontsize=14,this.m_fontcolor="#000000",this.m_fontweight="normal",this.m_fontfamily="roboto",this.m_fontsize="12",this.m_fontstyle="normal",this.m_textdecoration="none",this.m_cursortype="pointer",this.m_placeholdertext="Data Search",this.m_seriescolor=["#03C9A9","#F64747","#4183D7","#F89406","#23C759","#2682D5","#FEAE47","#3E9FC5","#8BBFDC","#86dff9"],this.m_fieldname="",this.m_fieldvalue=""}DataSearch.prototype=new Widget,DataSearch.prototype.setProperty=function(t){this.ParseJsonAttributes(t.Object,this),this.initCanvas()},DataSearch.prototype.ParseJsonAttributes=function(t,e){for(var i in this.chartJson=t)if("DataSearch"==i)for(var o in t[i])this.setAttributeValueToNode(o,t[i],e);else this.setAttributeValueToNode(i,t,e)},DataSearch.prototype.initCanvas=function(){$("#draggableDiv"+this.m_objectid).remove(),this.initializeDraggableDivAndCanvas()},DataSearch.prototype.initializeDraggableDivAndCanvas=function(t,e){this.setDashboardNameAndObjectId(),this.m_draggableDiv=this.createDraggableDiv(this.m_chartContainer,this.m_zIndex)},DataSearch.prototype.setDashboardNameAndObjectId=function(){this.m_objectId=this.m_objectid,2==this.m_objectid.split(".").length&&(this.m_objectid=this.m_objectid.split(".")[1]),this.m_componentid="dataSearchDiv"+this.m_objectid},DataSearch.prototype.setDataProvider=function(t){},DataSearch.prototype.draw=function(){this.drawObject()},DataSearch.prototype.drawObject=function(){this.init(),this.drawChart(),""!=this.m_onafterrendercallback&&onAfterRender(this.m_onafterrendercallback)},DataSearch.prototype.init=function(){},DataSearch.prototype.drawChart=function(){this.drawContainerDiv()},DataSearch.prototype.drawContainerDiv=function(){var t,e,i=this;IsBoolean(this.m_isActive)&&(t=$("#draggableDiv"+i.m_objectid),null!=$("#"+i.m_componentid)&&$("#"+i.m_componentid).remove(),(e=document.createElement("div")).setAttribute("id",i.m_componentid),e.setAttribute("class","dataSearchDiv"),$(e).css({height:this.m_height+"px",border:this.m_borderthickness+"px solid "+this.m_bordercolor,"border-radius":this.m_borderradius+"px","background-color":hex2rgb(convertColorToHex(this.m_backgroundcolor),this.m_bgalpha)}),$(t).append(e),this.createInputNLQDiv(e),this.m_selecteddsid)&&""!==this.m_selecteddsid&&this.getCubeInfo(this.m_selecteddsid)},DataSearch.prototype.setPlaceholderCSS=function(t,e){var i,o="";for(i in e)o=o+i+": "+e[i]+";";var s=t+"::placeholder{ "+o+"} ";s+=t+"::-ms-input-placeholder{ "+o+"}";try{$("<div />",{html:"&shy;<style>"+s+"</style>"}).appendTo(this.m_chartContainer)}catch(t){}},DataSearch.prototype.createInputNLQDiv=function(t){var a=this,e=document.createElement("div"),n=(e.setAttribute("class","inputNLQDiv"),$(e).css({height:this.m_height+"px"}),$(t).append(e),document.createElement("input")),r=(n.type="text",n.setAttribute("placeholder",a.m_placeholdertext),n.setAttribute("id","inputNLQ"+a.m_objectid),n.setAttribute("class","inputNLQText"),n.value=a.m_searchquery,$(n).css({color:convertColorToHex(this.m_fontcolor),"font-size":+this.m_fontsize*this.minWHRatio()+"px","font-family":selectGlobalFont(this.m_fontfamily),"font-weight":selectGlobalFont(this.m_fontweight),"font-style":selectGlobalFont(this.m_fontstyle),"text-decoration":this.m_textdecoration}),$(e).append(n),a.setPlaceholderCSS("#inputNLQ"+a.m_objectid,{color:convertColorToHex(this.m_fontcolor),"font-weight":selectGlobalFont(this.m_fontweight),"font-style":selectGlobalFont(this.m_fontstyle),"text-decoration":this.m_textdecoration}),document.createElement("span"));r.id="clearInputText"+a.m_objectid,r.setAttribute("class","inputNLQClear bd-close"),$(r).on("mouseenter",function(t){var e,i,o,s;a.m_designMode||(a.removeToolTipDiv(),(i=document.getElementById("draggablesParentDiv"+a.m_dashboard.m_id)).scrollLeft,i.scrollTop,o=(e=$(i).offset()).top+$(i)[0].clientTop-$(i)[0].scrollTop,e=e.left+$(i)[0].clientLeft-$(i)[0].scrollLeft,i=$(this)[0].offsetLeft,s=$(this)[0].offsetTop,o=t.pageY-t.offsetY-o+s+20,s=t.pageX-e-i+25,(i=document.createElement("div")).innerHTML="Clear the search",i.setAttribute("id","toolTipDiv"),i.setAttribute("class","settingIcon"),i.setAttribute("placement","bottom"),$(".draggablesParentDiv").append(i),o=$.extend(a.getTooltipStyles(),{top:o+"px",left:s+"px"}),$(i).css(o),i.offsetWidth,ht=+i.offsetHeight,s=t.pageX-t.offsetX+$(n)[0].offsetWidth-i.offsetWidth/2+$(r)[0].offsetWidth/2-e-16+"px",$(i).css("left",s),$(i).css("box-shadow","0 5px 15px -5px rgb(0 0 0 / 50%)"))}).on("mouseleave",function(){a.removeToolTipDiv()}),$(r).css({"line-height":this.m_height+"px",color:convertColorToHex(this.m_fontcolor)}),$(e).append(r),a.m_designMode||(detectDevice.mobile()||detectDevice.tablet()?r.addEventListener("touchstart",function(t){n.value="",a.m_searchquery="",$(r).hide(),$(n).css("width","100%"),a.m_nlqresultobject={}},!1):r.addEventListener("click",function(t){n.value="",a.m_searchquery="",$(r).hide(),$(n).css("width","100%"),a.m_nlqresultobject={}},!1),n.addEventListener("keyup",function(t){t.preventDefault(),a.m_searchquery=$(t.target).val(),a.inputCursorPos=this.selectionEnd,""!=a.m_searchquery?($(n).css("width","calc(100% - 25px)"),$(r).show()):($(r).hide(),$(n).css("width","100%"),a.m_nlqresultobject={}),13===t.keyCode&&(detectDevice.mobile()||detectDevice.tablet()?((t=new Event("touchstart")).touches=[],document.getElementById("inputNLP"+a.m_objectid).dispatchEvent(t)):document.getElementById("inputNLP"+a.m_objectid).click())})),this.createControlButtons(t)},DataSearch.prototype.createControlButtons=function(t){for(var e=this,i=document.createElement("div"),o=($(t).append(i),i.setAttribute("class","NLQButtonContainer"),$(i).css({height:this.m_height+"px","line-height":this.m_height+"px"}),[{iClass:"bd-search inputNLPSearch",id:"inputNLP",title:"Search",value:"Input NLP"},{iClass:"bd-save inputNLPSave",id:"saveNLQ",title:"Save this search query",value:"Save NLP"},{iClass:"bd-list inputNLPList",id:"listNLQ",title:"List saved queries",value:"List NLP"},{iClass:"bd-data-base-1 inputNLPDataStore",id:"dataStore",title:"Select a DataStore",value:"Get DataStore"}]),s=0;s<o.length;s++){var a=document.createElement("div"),n=($(i).append(a),a.setAttribute("class","NLQButtonContainerIcon"),document.createElement("span"));$(a).append(n),n.setAttribute("id",o[s].id+e.m_objectid),n.setAttribute("class","bdmenuicon icons "+o[s].iClass),n.value=o[s].value,$(n).css({"font-size":+this.m_paneliconfontsize*this.minWHRatio()+"px",color:convertColorToHex(this.m_fontcolor)}),e.m_designMode||this.initMouseAndTouchEvent("#"+o[s].id+e.m_objectid,o[s].title)}e.m_designMode||this.initializeCtrlBtnEvent()},DataSearch.prototype.initMouseAndTouchEvent=function(h,m){var u,e,i;IsBoolean(this.m_designMode)||(u=this,e=function(t){u.removeToolTipDiv()},i=function(t){OnMouseClick(u)},"ontouchstart"in document.documentElement?$("#draggableDiv"+u.m_objectid).bind("touchstart",function(t){t.stopImmediatePropagation(),($("."+u.m_objecttype+"ToolTipDiv").length?e.bind($(h)):function(t){var e,i,o,s,a,n;t.stopImmediatePropagation(),u.m_designMode||""==u.m_tooltip||" "==u.m_tooltip||(0===$(".draggablesParentDiv").find("#toolTipDiv").length?(e=(i=document.getElementById("draggablesParentDiv"+u.m_dashboard.m_id)).scrollLeft,i=i.scrollTop,s=+(o=t.originalEvent.touches[0].pageY)+ +i+20,t=+(t=t.originalEvent.touches[0].pageX)+ +e-150<0?+t+ +e:+t+ +e-160,(a=document.createElement("div")).innerHTML=u.checkToolTipDesc,a.setAttribute("id","toolTipDiv"),a.setAttribute("class",u.m_objecttype+"ToolTipDiv"),$(".draggablesParentDiv").append(a),n=$.extend(u.getTooltipStyles(),{top:s+"px",left:t+"px"}),$(a).css(n),20+s+ +$(a).height()>u.m_dashboard.m_AbsoluteLayout.m_height+i&&(s=+o-20+ +i-+$(a).height(),$(a).css("top",s)),10+t+ +$(a).width()>u.m_dashboard.m_AbsoluteLayout.m_width+e&&(t=+o-10+ +e-+$(a).width(),$(a).css("left",t))):u.removeToolTipDiv())}.bind(this))(t),i.bind(this)(t)}).bind("touchend",function(t){}):$(h).click(function(t){i.bind(this)(t)}).hover(function(t){!function(t){$(this).css("cursor",u.m_cursortype)}.bind(this)(t)}).mousemove(function(t){!function(t){var e,i,o,s,a,n,r,d,c,l;u.m_designMode||""==u.m_tooltip||" "==u.m_tooltip||(t.stopPropagation(),u.removeToolTipDiv(),e=(l=document.getElementById("draggablesParentDiv"+u.m_dashboard.m_id)).scrollLeft,i=l.scrollTop,o=(s=$(l).offset()).top+$(l)[0].clientTop-$(l)[0].scrollTop,s=s.left+$(l)[0].clientLeft-$(l)[0].scrollLeft,l=$(this)[0].offsetLeft,c=$(this)[0].offsetTop,a=t.pageY-o-c+5,n=t.pageX-s-l+5,(r=document.createElement("div")).innerHTML=m,r.setAttribute("id","toolTipDiv"),r.setAttribute("class","settingIcon"),r.setAttribute("placement","bottom"),$(".draggablesParentDiv").append(r),u.m_width,d=+u.m_height,d=$.extend(u.getTooltipStyles(),{top:t.pageY-t.offsetY+d-o-c-u.m_height/8+"px",left:t.pageX-t.offsetX-s-l+10+"px"}),$(r).css(d),c=$(".NLQButtonContainerIcon").width()>$(h)[0].offsetWidth?$(".NLQButtonContainerIcon").width()-$(h)[0].offsetWidth:0,l=t.pageX-t.offsetX-r.offsetWidth/2+$(h)[0].offsetWidth/2+c/2-s-20+"px",$(r).css("left",l),$(r).css("box-shadow","0 5px 15px -5px rgb(0 0 0 / 50%)"),10+a+ +$(r).height()>+u.m_dashboard.m_AbsoluteLayout.m_height+i&&(a=o-10+ +i-+$(r).height(),$(r).css("top",a)),10+n+ +$(r).width()>+u.m_dashboard.m_AbsoluteLayout.m_width+e&&(n-=+$(r).width(),$(r).css("left",n)))}.bind(this)(t)}).mouseout(function(t){e.bind(this)(t)}),$("#draggableDiv"+u.m_objectid).on("swipeleft",function(t){onSwipeLeft(u,t)}).on("swiperight",function(t){onSwipeRight(u,t)}).on("mousewheel",function(t){u.hideToolTip()}),$(".draggablesParentDiv").on("scroll",function(t){u.hideToolTip()}),$("#WatermarkDiv").on("scroll",function(t){u.hideToolTip()}))},DataSearch.prototype.setNoDataStoreElementStatus=function(){var t=this,e=($("#dataStorelistDiv"+t.m_objectid).remove(),document.createElement("div")),t=($(t.m_chartContainer).append(e),e.setAttribute("id","dataStorelistDiv"+t.m_objectid),e.setAttribute("class","dataStoreListDiv"),$(e).css({padding:"10px",top:+t.m_top+ +t.m_height+"px",left:t.m_left+"px",width:t.m_width+"px",border:t.m_borderthickness+"px solid "+t.m_bordercolor,"border-radius":t.m_borderradius+"px",color:convertColorToHex(t.m_fontcolor),"background-color":hex2rgb(convertColorToHex(t.m_backgroundcolor),t.m_bgalpha)}),document.createElement("div"));t.innerHTML="DataStore list is empty!",$(t).css({"text-align":"center","font-size":+this.m_fontsize*this.minWHRatio()+"px","font-family":selectGlobalFont(this.m_fontfamily),"font-weight":selectGlobalFont(this.m_fontweight),"font-style":selectGlobalFont(this.m_fontstyle),"text-decoration":this.m_textdecoration}),$(e).append(t)},DataSearch.prototype.setDataStoreElement=function(t){var e=this,i=t.sort(function(t,e){t=t.name.toUpperCase(),e=e.name.toUpperCase();return t<e?-1:e<t?1:0}),t=($("#dataStorelistDiv"+e.m_objectid).remove(),document.createElement("div")),o=($(e.m_chartContainer).append(t),t.setAttribute("id","dataStorelistDiv"+e.m_objectid),t.setAttribute("class","dataStoreListDiv"),$(t).css({top:+e.m_top+ +e.m_height+"px",left:e.m_left+"px",width:e.m_width+"px",height:e.m_panelheight+"px",border:e.m_borderthickness+"px solid "+e.m_bordercolor,"border-radius":e.m_borderradius+"px",color:convertColorToHex(e.m_fontcolor),"background-color":hex2rgb(convertColorToHex(e.m_backgroundcolor),e.m_bgalpha)}),document.createElement("div")),s=($(t).append(o),o.setAttribute("class","searchTextContainer"),document.createElement("input")),a=($(o).append(s),s.id="search-wrapper"+e.m_objectid,s.type="text",s.setAttribute("class","dataStoreSearch"),s.setAttribute("placeholder","Search DataStore"),$(s).css({"font-size":+this.m_fontsize*this.minWHRatio()+"px","font-family":selectGlobalFont(this.m_fontfamily),"font-weight":selectGlobalFont(this.m_fontweight),"font-style":selectGlobalFont(this.m_fontstyle),"text-decoration":this.m_textdecoration}),e.setPlaceholderCSS("#search-wrapper"+e.m_objectid,{color:convertColorToHex(this.m_fontcolor),"font-weight":selectGlobalFont(this.m_fontweight),"font-style":selectGlobalFont(this.m_fontstyle),"text-decoration":this.m_textdecoration}),e.m_designMode||$(s).keyup(function(t){t.stopPropagation();t=$(t.target).val().toLowerCase();e.searchDSinList(t)}),document.createElement("ul"));$(t).append(a),a.setAttribute("id","dataStoreUL"+e.m_objectid);for(var n=0;n<i.length;n++){var r=i[n];""!==r.name&&this.createListContent(r,a)}$(a).find(".dataStore-li-label").css({"font-size":+this.m_fontsize*this.minWHRatio()+"px","font-family":selectGlobalFont(this.m_fontfamily),"font-weight":selectGlobalFont(this.m_fontweight),"font-style":selectGlobalFont(this.m_fontstyle),"text-decoration":this.m_textdecoration})},DataSearch.prototype.searchDSinList=function(e){$("#dataStorelistDiv"+this.m_objectid).find("li").hide(),$("#dataStorelistDiv"+this.m_objectid).find("li").filter(function(t){return-1!=$(this).find(".dataStore-li-label").text().toLowerCase().indexOf(e)}).show()},DataSearch.prototype.createListContent=function(t,e){var i=this,o=document.createElement("li"),e=(o.setAttribute("id","li"+t.id),o.setAttribute("class","dataStore-li"),o.data=t,$(e).append(o),document.createElement("span")),e=($(o).append(e),e.setAttribute("id","Apply"+i.m_objectid+t.id),e.setAttribute("class","dataStore-li-apply bdmenuicon icons bd-ok"),e.title="Click to select this DataStore",e.value="Select",$(e).css({"font-size":+this.m_fontsize*this.minWHRatio()+"px"}),document.createElement("span"));$(o).append(e),e.setAttribute("class","dataStore-li-label"),e.innerHTML=t.name,e.title=t.name,i.m_designMode||(detectDevice.mobile()||detectDevice.tablet()?$(o).on("taphold",function(t){t.stopPropagation(),void 0===this.eventHandled?(t=this.data.id.toString(),i.moveSelectedDSOnTopOfList(t,!0),i.m_nlqresultobject={},this.eventHandled=!0):this.eventHandled=void 0}):o.addEventListener("click",function(t){t.stopPropagation();t=this.data.id.toString();i.moveSelectedDSOnTopOfList(t,!0),i.m_nlqresultobject={}},!1))},DataSearch.prototype.moveSelectedDSOnTopOfList=function(t,e){var i=this,o=$("#dataStoreUL"+i.m_objectid).find("#li"+t);""!=t&&null!=t&&o&&($(o).siblings().removeClass("dataStore-li-selected"),$(o).addClass("dataStore-li-selected"),$(o).parent().prepend($(o)),$(o).parent().scrollTop(0),e)&&i.getCubeInfo(t),$("#search-wrapper"+i.m_objectid).val(""),i.searchDSinList(""),$("#inputNLQ"+i.m_objectid).val(""),$("#clearInputText"+i.m_objectid).hide()},DataSearch.prototype.drawDSSuggestionDiv=function(t){var i=this,e=($("#nlq-suggestion-div"+i.m_objectid).remove(),document.createElement("div")),o=($(i.m_chartContainer).append(e),e.id="nlq-suggestion-div"+i.m_objectid,e.setAttribute("class","nlq-suggestion-div"),$(e).css({top:+i.m_top+ +i.m_height+"px",left:i.m_left+"px",width:i.m_width+"px",height:i.m_panelheight+"px",border:i.m_borderthickness+"px solid "+i.m_bordercolor,"border-radius":i.m_borderradius+"px",color:convertColorToHex(i.m_fontcolor),"background-color":hex2rgb(convertColorToHex(i.m_backgroundcolor),i.m_bgalpha)}),document.createElement("div")),s=($(e).append(o),o.id="nlq-suggestion-btnContainer"+i.m_objectid,o.setAttribute("class","nlq-suggestion-btnContainer"),i.createDSSuggestionCtrlBtn("savedQueryBtn","Search suggestions")),s=($(o).append(s),i.createDSSuggestionCtrlBtn("savedDSInfoBtn","Data Store Information")),o=($(o).append(s),i.createNLQQuerySuggestionDiv(t)),s=($(e).append(o),i.createNLQFieldSuggestionDiv());$(e).append(s),detectDevice.mobile()||detectDevice.tablet()?$(e).find(".ds-info-list").bind("taphold",function(t){var e;t.stopPropagation(),void 0===this.eventHandled?($(this).parent()[0].id=="nlq-field-suggestion-innerDiv"+i.m_objectid?i.appendTextInDSInputBox(this):$(this).parent()[0].id=="nlq-query-suggestion-div"+i.m_objectid&&(t=$("#inputNLQ"+i.m_objectid),e=$(this).find("span").text(),t.val(""),t.val(e),t.focus(),t.css("width","calc(100% - 25px)"),$("#clearInputText"+i.m_objectid).show(),(e=new Event("touchstart")).touches=[],document.getElementById("inputNLP"+i.m_objectid).dispatchEvent(e)),this.eventHandled=!0):this.eventHandled=void 0}):$(e).find(".ds-info-list").bind("click",function(t){var e;t.stopPropagation(),$(this).parent()[0].id=="nlq-field-suggestion-innerDiv"+i.m_objectid?i.appendTextInDSInputBox(this):$(this).parent()[0].id=="nlq-query-suggestion-div"+i.m_objectid&&(t=$("#inputNLQ"+i.m_objectid),e=$(this).find("span").text(),t.val(""),t.val(e),t.focus(),t.css("width","calc(100% - 25px)"),$("#clearInputText"+i.m_objectid).show(),document.getElementById("inputNLP"+i.m_objectid).click())})},DataSearch.prototype.appendTextInDSInputBox=function(t){var e,i=this,t=$(t).find("span").text(),o=$("#inputNLQ"+i.m_objectid),s="";i.inputCursorPos&&0<i.inputCursorPos?(s=(e=o.val()).slice(0,i.inputCursorPos)+t+e.slice(i.inputCursorPos),o.val(s)):(e=o.val(),o.val(s=""!=e?e+" "+t:t)),""!=s&&(o.css("width","calc(100% - 25px)"),$("#clearInputText"+i.m_objectid).show(),o.focus())},DataSearch.prototype.appendTextInDSInputBox=function(t){var e,i=this,t=$(t).find("span").text(),o=$("#inputNLQ"+i.m_objectid),i=i.inputCursorPos&&0<i.inputCursorPos?(e=o.val()).slice(0,i.inputCursorPos)+t+e.slice(i.inputCursorPos):""!=(e=o.val())?e+" "+t:t;o.val(i)},DataSearch.prototype.createNLQQuerySuggestionDiv=function(t){var e=document.createElement("div");return e.id="nlq-query-suggestion-div"+this.m_objectid,e.setAttribute("class","nlq-suggestion-wrapper nlq-query-suggestion"),this.createDSSuggestionContent(t,e,"ds-savedquery-list","bd-search"),e},DataSearch.prototype.createNLQFieldSuggestionDiv=function(){var t=this,e=document.createElement("div"),i=(e.id="nlq-field-suggestion-div"+t.m_objectid,e.setAttribute("class","nlq-suggestion-wrapper nlq-field-suggestion"),document.createElement("div")),o=($(e).append(i),i.id="nlq-field-suggestion-innerDiv"+t.m_objectid,i.setAttribute("class","nlq-field-suggestion-facts"),t.m_selecteddstore.defenition.fieldDef.facts),o=(t.createDSSuggestionContent(o,i,"ds-facts-list","bd-dimension-1"),document.createElement("div")),i=($(e).append(o),o.id="nlq-field-suggestion-innerDiv"+t.m_objectid,o.setAttribute("class","nlq-field-suggestion-measures"),t.m_selecteddstore.defenition.fieldDef.measures);return t.createDSSuggestionContent(i,o,"ds-measures-list","bd-number-1"),$(e).hide(),e},DataSearch.prototype.createDSSuggestionContent=function(t,e,i,o){var s=this,a=t;if(0<a.length)for(var n=0;n<a.length;n++){var r=document.createElement("p"),d=(r.setAttribute("class","ds-info-list "+i),$(e).append(r),document.createElement("i")),d=($(r).append(d),d.setAttribute("class",o),$(d).css({"font-size":+s.m_fontsize*s.minWHRatio()+"px"}),document.createElement("span"));$(r).append(d),d.title=a[n],d.innerHTML=a[n],$(d).css({"font-size":+s.m_fontsize*s.minWHRatio()+"px","font-family":selectGlobalFont(s.m_fontfamily),"font-weight":selectGlobalFont(this.m_fontweight),"font-style":selectGlobalFont(this.m_fontstyle),"text-decoration":this.m_textdecoration})}},DataSearch.prototype.createDSSuggestionCtrlBtn=function(t,e){var i=this,o=document.createElement("input");return o.type="button",o.id=t+i.m_objectid,o.setAttribute("class",t),o.value=e,o.title=e,$(o).css({"font-size":+i.m_fontsize*i.minWHRatio()+"px","font-family":selectGlobalFont(i.m_fontfamily),"font-weight":selectGlobalFont(this.m_fontweight),"font-style":selectGlobalFont(this.m_fontstyle),"text-decoration":this.m_textdecoration}),detectDevice.mobile()||detectDevice.tablet()?o.addEventListener("touchstart",function(t){t.stopPropagation(),$(this).siblings().removeClass("filterSaver-selectedBtn"),this.id=="savedQueryBtn"+i.m_objectid?($("#nlq-query-suggestion-div"+i.m_objectid).show(),$("#nlq-field-suggestion-div"+i.m_objectid).hide()):this.id=="savedDSInfoBtn"+i.m_objectid&&($("#nlq-field-suggestion-div"+i.m_objectid).show(),$("#nlq-query-suggestion-div"+i.m_objectid).hide()),$(this).addClass("filterSaver-selectedBtn")},!1):o.addEventListener("click",function(t){t.stopPropagation(),$(this).siblings().removeClass("filterSaver-selectedBtn"),this.id=="savedQueryBtn"+i.m_objectid?($("#nlq-query-suggestion-div"+i.m_objectid).show(),$("#nlq-field-suggestion-div"+i.m_objectid).hide()):this.id=="savedDSInfoBtn"+i.m_objectid&&($("#nlq-field-suggestion-div"+i.m_objectid).show(),$("#nlq-query-suggestion-div"+i.m_objectid).hide()),$(this).addClass("filterSaver-selectedBtn")},!1),t+i.m_objectid=="savedQueryBtn"+i.m_objectid&&$(o).addClass("filterSaver-selectedBtn"),o},DataSearch.prototype.initializeCtrlBtnEvent=function(){var s=this,t=$("#inputNLP"+s.m_objectid)[0],e=$("#saveNLQ"+s.m_objectid)[0],i=$("#listNLQ"+s.m_objectid)[0],o=$("#dataStore"+s.m_objectid)[0];detectDevice.mobile()||detectDevice.tablet()?t.addEventListener("touchstart",function(t){s.m_searchquery=$("#inputNLQ"+s.m_objectid).val(),$("#nlq-suggestion-div"+s.m_objectid).hide(),s.getNLP(s.m_selecteddsid)},!1):t.addEventListener("click",function(t){s.m_searchquery=$("#inputNLQ"+s.m_objectid).val(),$("#nlq-suggestion-div"+s.m_objectid).hide(),s.getNLP(s.m_selecteddsid)},!1),detectDevice.mobile()||detectDevice.tablet()?e.addEventListener("touchstart",function(t){s.saveNLPQuery()},!1):e.addEventListener("click",function(t){s.saveNLPQuery()},!1),detectDevice.mobile()||detectDevice.tablet()?i.addEventListener("touchstart",function(t){t.stopPropagation(),$("#dataStorelistDiv"+s.m_objectid).hide(),$("#nlq-suggestion-div"+s.m_objectid)&&""!==s.m_selecteddsid?$("#nlq-suggestion-div"+s.m_objectid).toggle():alertPopUpModal({type:"error",message:"DataStore is not selected",timeout:"3000"})},!1):(i.addEventListener("click",function(t){t.stopPropagation(),$("#dataStorelistDiv"+s.m_objectid).hide(),$("#nlq-suggestion-div"+s.m_objectid)&&""!==s.m_selecteddsid?$("#nlq-suggestion-div"+s.m_objectid).toggle():alertPopUpModal({type:"error",message:"DataStore is not selected",timeout:"3000"})},!1),i.addEventListener("dblclick",function(t){t.stopPropagation(),""!==s.m_selecteddsid&&void 0!==s.m_selecteddsid&&s.getNLPQuery(s.m_selecteddsid)},!1)),detectDevice.mobile()||detectDevice.tablet()?o.addEventListener("touchstart",function(t){t.stopPropagation(),$("#nlq-suggestion-div"+s.m_objectid).hide(),$("#search-wrapper"+s.m_objectid).focus(),IsBoolean(s.isDataStoreLoaded)?$("#dataStorelistDiv"+s.m_objectid).toggle():s.getDatastoreDetails()},!1):(o.addEventListener("click",function(t){t.stopPropagation(),$("#nlq-suggestion-div"+s.m_objectid).hide(),IsBoolean(s.isDataStoreLoaded)?$("#dataStorelistDiv"+s.m_objectid).toggle():s.getDatastoreDetails()},!1),o.addEventListener("dblclick",function(t){t.stopPropagation(),$("#nlq-suggestion-div"+s.m_objectid).hide(),s.getDatastoreDetails()},!1)),$(s.m_chartContainer).click(function(t){var e=$("#draggableDiv"+s.m_objectid),i=$("#nlq-suggestion-div"+s.m_objectid),o=$("#dataStorelistDiv"+s.m_objectid);t.target.id==e.attr("id")||e.has(t.target).length||t.target.id==i.attr("id")||i.has(t.target).length||t.target.id==o.attr("id")||o.has(t.target).length||(i&&i.is(":visible")||o&&o.is(":visible"))&&($("#nlq-suggestion-div"+s.m_objectid).hide(),$("#dataStorelistDiv"+s.m_objectid).hide())})},DataSearch.prototype.autoCompleteText=function(t){var e=req_url.designer.pluginService,t={criteriaIds:JSON.stringify(t)};showLoader(),this.webServiceCall(e,t,function(t,e){},function(t,e){})},DataSearch.prototype.getNLP=function(t){var i=this,e=req_url.designer.pluginService,o={consumerName:"CUBEPROCESSSERVICE",serviceName:"getNLP",data:JSON.stringify({cubeId:t,userText:i.m_searchquery}),isSecure:"true"};""!==t?""!==this.m_searchquery?(showLoader(),this.webServiceCall(e,o,function(t,e){if(t=getDecryptedResponse(t),i.m_nlqresultobject=t||{},IsBoolean(e)){if(t&&t.data)try{i.m_nlqresultobject.data=JSON.parse(t.data)}catch(t){}else alertPopUpModal({type:"error",message:"Invalid search result",timeout:"3000"}),i.m_nlqresultobject.sentence=i.m_searchquery,i.m_nlqresultobject.data=[];try{i.drawAssociatedChart()}catch(t){}}else alertPopUpModal({type:"error",message:"Failed to get search result",timeout:"3000"})},function(t,e){alertPopUpModal({type:"error",message:"Failed to get search result",timeout:"3000"})})):alertPopUpModal({type:"warning",message:"Please write a query",timeout:"3000"}):alertPopUpModal({type:"error",message:"DataStore is not selected",timeout:"3000"})},DataSearch.prototype.drawAssociatedChart=function(){if(this.m_associatedchart.chart=this.getChartObjectById(this.m_associateddschartid),this.m_associatedchart.chart)if(this.m_associatedchart.ds=this.getDatasetObjectById(this.m_associateddschartid),this.m_associatedchart.ds){if(this.m_associatedchart.fields=[],this.m_nlqresultobject.metadata&&(this.m_nlqresultobject.metadata.category||this.m_nlqresultobject.metadata.series)){for(var t=0;t<this.m_nlqresultobject.metadata.category.length;t++)this.m_associatedchart.fields.push(this.m_associatedchart.ds.getFieldJsonforOneField("Category",this.m_seriescolor[t],this.m_nlqresultobject.metadata.category[t].dimension));for(var e=0;e<this.m_nlqresultobject.metadata.series.length;e++){var i=this.m_nlqresultobject.metadata.series[e].op+"_"+this.m_nlqresultobject.metadata.series[e].measure;i,this.m_associatedchart.fields.push(this.m_associatedchart.ds.getFieldJsonforOneField("Series",this.m_seriescolor[e],i))}}this.m_associatedchart.data=this.m_nlqresultobject.data;try{this.handleOnChangeEvent()}catch(t){}this.m_associatedchart.ds.dataSetFieldsJSONParsing(this.m_associatedchart.fields),this.m_associatedchart.ds.setDataView(this.m_associatedchart.data),this.m_associatedchart.ds.setDataStore(this.m_associatedchart.data),this.m_associatedchart.chart.m_title.m_description=this.m_nlqresultobject.sentence,this.m_associatedchart.chart.setDataProvider(this.m_associatedchart.data),this.m_associatedchart.chart.setFields(this.m_associatedchart.fields),this.m_associatedchart.chart.draw()}else{alertPopUpModal({type:"warning",message:this.m_associatedchart.chart.m_referenceid+" does not have dataset",timeout:"3000"});try{this.handleOnChangeEvent()}catch(t){}}else{alertPopUpModal({type:"warning",message:"No chart is associated for result",timeout:"3000"});try{this.handleOnChangeEvent()}catch(t){}}},DataSearch.prototype.saveNLPQuery=function(){var i=this,t=req_url.designer.pluginService,e={consumerName:"CUBEPROCESSSERVICE",serviceName:"saveNLPQuery",data:JSON.stringify({sentence:i.m_nlqresultobject.sentence,cubeId:i.m_selecteddsid,userText:i.m_searchquery}),isSecure:"true"};i.m_nlqresultobject&&i.m_nlqresultobject.sentence&&""!==i.m_nlqresultobject.sentence?""!==i.m_selecteddsid?""!==i.m_searchquery?(showLoader(),this.webServiceCall(t,e,function(t,e){t=getDecryptedResponse(t),IsBoolean(e)&&(""!==i.m_selecteddsid&&void 0!==i.m_selecteddsid&&i.getNLPQuery(i.m_selecteddsid),alertPopUpModal({type:"success",message:"Query has been saved",timeout:"3000"}))},function(t,e){alertPopUpModal({type:"error",message:"Failed to save the query",timeout:"3000"})})):alertPopUpModal({type:"warning",message:"Please write a query",timeout:"3000"}):alertPopUpModal({type:"error",message:"DataStore is not selected",timeout:"3000"}):alertPopUpModal({type:"warning",message:"Please write a query",timeout:"3000"})},DataSearch.prototype.getNLPQuery=function(t){var o=this,e=req_url.designer.pluginService,t={consumerName:"CUBEPROCESSSERVICE",serviceName:"getNLPQuery",data:JSON.stringify({cubeId:t}),isSecure:"true"};showLoader(),this.webServiceCall(e,t,function(t,e){var i=[];t=getDecryptedResponse(t),IsBoolean(e)&&t&&t.data&&(i=t.data,0<t.data.length)?alertPopUpModal({type:"success",message:"Saved queries has been loaded",timeout:"3000"}):alertPopUpModal({type:"info",message:"There are no saved queries for this DataStore",timeout:"3000"}),o.drawDSSuggestionDiv(i)},function(t,e){alertPopUpModal({type:"error",message:"Failed to load the saved queries",timeout:"3000"})})},DataSearch.prototype.getDatastoreDetails=function(){var i=this,t=req_url.designer.pluginService,e={consumerName:"CUBEPROCESSSERVICE",serviceName:"getDatastoreDetails",data:JSON.stringify({id:"0",datasourcetype:"all"}),isSecure:"true"};showLoader(),this.webServiceCall(t,e,function(t,e){t=getDecryptedResponse(t),IsBoolean(e)?t&&t.bizvizCubes?(i.isDataStoreLoaded=!0,0<t.bizvizCubes.length?(i.setDataStoreElement(t.bizvizCubes),""!==i.m_selecteddsid&&void 0!==i.m_selecteddsid&&i.moveSelectedDSOnTopOfList(i.m_selecteddsid,!1),alertPopUpModal({type:"success",message:"DataStores has been loaded",timeout:"3000"})):(i.setNoDataStoreElementStatus(),alertPopUpModal({type:"warning",message:"DataStore list is empty!",timeout:"3000"}))):alertPopUpModal({type:"error",message:"DataStores list is Empty",timeout:"3000"}):alertPopUpModal({type:"error",message:"Failed to load DataStores",timeout:"3000"})},function(t,e){alertPopUpModal({type:"error",message:"Failed to load DataStores",timeout:"3000"})})},DataSearch.prototype.getCubeInfo=function(t){var i=this,e=req_url.designer.pluginService,t={consumerName:"CUBEPROCESSSERVICE",serviceName:"getCubeInfo",data:JSON.stringify({id:t}),isSecure:"true"};showLoader(),this.webServiceCall(e,t,function(t,e){(t=getDecryptedResponse(t))&&t.success&&null!=t.bizvizCube&&null!=t.bizvizCube.defenition&&(i.m_selecteddsid=t.bizvizCube.id.toString(),i.m_selecteddstore=t.bizvizCube,t=JSON.parse(t.bizvizCube.defenition),i.m_selecteddstore.defenition=t,$("#dataStorelistDiv"+i.m_objectid).hide(),""!==i.m_selecteddsid&&void 0!==i.m_selecteddsid&&i.getNLPQuery(i.m_selecteddsid),alertPopUpModal({type:"success",message:"DataStore is selected",timeout:"3000"}))},function(t,e){alertPopUpModal({type:"error",message:"DataStore selection failed",timeout:"3000"})})},DataSearch.prototype.handleOnChangeEvent=function(){var t={};t[""==this.m_fieldname||null==this.m_fieldname?"Value":this.m_fieldname]=this.m_fieldvalue,this.updateDataPoints(t)};
//# sourceMappingURL=DataSearch.min.js.map