/*! BDB Charting Library V10.0.0 (2025-08-14 11:37:12) 
 Copyright 2015-2024 BDB (BizViz Technologies Pvt Ltd). All Rights Reserved */
function Legend(e,t){this.base=Widget,this.base(),this.m_bordercolor="",this.m_bgalpha="",this.m_bggradients="",this.m_borderthickness="",this.m_bggradientrotation="",this.m_borderalpha="",this.m_fontfamily="",this.m_fontsize="",this.m_fontcolor="",this.m_fontstyle="",this.m_fontweight="",this.m_textdecoration="",this.m_legenddirection="",this.m_legendcheckbox="",this.m_legendsymbol="",this.m_associatedchartid="",this.m_associatedrepeaterchartid="",this.m_showborder=!1,this.m_chartContainer=e,this.m_zIndex=t,this.m_chartFrame=new ChartFrame,this.m_legendwidth=12,this.m_legendheight=10,this.m_legendcolors="#E08283,#38d3a9,#797979",this.m_legendnames="Series1,Series2,Series3",this.m_legendshapes="cube,triangle,point",this.legendsWidthArray=[],this.marginLeft=15,this.marginTop=10,this.marginGap=10,this.m_rowpadding=4,this.m_columnpadding=0,this.checkboxChangedFlag=!1,this.m_original_x,this.m_original_y,this.m_original_width,this.m_original_height,this.m_original_zindex,this.legendNames=[],this.legendDisplayNames=[],this.legendColors=[],this.legendShapes=[],this.m_legendObjectArr=[],this.m_isstaticlegend="false",this.isMaximized=!1,this.m_enhanceCheckbox=!1,this.m_rollovercolor="transparent",this.m_cursortype="pointer",this.reloadLegend=!0,this.m_legendtextalign="left",this.m_multipleassociatedchart={enable:!1,id:[]},this.m_legendhscroll=!1}Legend.prototype=new Widget,Legend.prototype.setProperty=function(e){this.ParseJsonAttributes(e.Object,this),this.initCanvas()},Legend.prototype.ParseJsonAttributes=function(e,t){for(var i in this.chartJson=e)if("Legend"==i)for(var s in e[i])this.setAttributeValueToNode(s,e[i],t);else this.setAttributeValueToNode(i,e,t)},Legend.prototype.initCanvas=function(){$("#draggableDiv"+this.m_objectid).remove(),this.initializeDraggableDivAndCanvas()},Legend.prototype.initializeDraggableDivAndCanvas=function(){this.setDashboardNameAndObjectId(),this.m_draggableDiv=this.createDraggableDiv(this.m_chartContainer,this.m_zIndex),this.createDraggableCanvas(this.m_draggableDiv),this.setCanvasContext(),this.initMouseClickEvent()},Legend.prototype.setDashboardNameAndObjectId=function(){this.m_objectId=this.m_objectid,2==this.m_objectid.split(".").length&&(this.m_objectid=this.m_objectid.split(".")[1]),this.m_componentid=this.m_objectid},Legend.prototype.draw=function(){this.drawObject()},Legend.prototype.drawObject=function(){this.getAssociatedChartObject()&&(this.isMaximized=this.getAssociatedChartObject().isMaximized),IsBoolean(this.checkboxChangedFlag)?IsBoolean(this.reloadLegend)?null==this.getAssociatedChartObject()||IsBoolean(this.getAssociatedChartObject().isMaximized)||(this.init(),this.drawChart()):(this.init(),this.drawChart(),""!=this.m_onafterrendercallback&&onAfterRender(this.m_onafterrendercallback)):(!IsBoolean(this.m_designMode)&&IsBoolean(this.reloadLegend)&&null!=this.getAssociatedChartObject()&&IsBoolean(this.getAssociatedChartObject().isMaximized)?(this.repositionLegend(this.getAssociatedChartObject()),this.reloadLegend=!1):null==this.m_original_x||IsBoolean(this.isMaximized)||(this.setOriginalPosition(),this.reloadLegend=!0),this.init(),this.drawChart(),""!=this.m_onafterrendercallback&&onAfterRender(this.m_onafterrendercallback))},Legend.prototype.getAssociatedChartObject=function(){return this.associatedChartObject=this.getRepeaterChartObjectById(this.m_associatedchartid),this.associatedChartObject},Legend.prototype.getLegendName=function(e){return e.getLegendNames()},Legend.prototype.getLegendColors=function(e){return e.getSeriesColors()},Legend.prototype.getLegendShapes=function(e){return e.m_plotShapeArray},Legend.prototype.getBgGradients=function(){return this.m_bggradients},Legend.prototype.createLegendContainerDiv=function(){var e,t=this,i=($("#LegendContainerDiv"+t.m_objectid).remove(),document.createElement("div"));i.setAttribute("id","LegendContainerDiv"+t.m_objectid),"vertical"==this.m_legenddirection?(i.setAttribute("class","LegendVContainerDiv"),i.setAttribute("style","position:absolute;left:0px;top:0px;width:inherit;height:inherit;overflow:auto;text-align:"+t.m_legendtextalign+";")):(i.setAttribute("class","LegendHContainerDiv"),e=IsBoolean(this.m_legendhscroll)?"max-content":"inherit",i.setAttribute("style","display: flow-root;position:absolute;left:0px;top:0px;width:"+e+";height:inherit;overflow:auto;text-align:"+t.m_legendtextalign+";")),$("#draggableDiv"+t.m_objectid).append(i)},Legend.prototype.init=function(){this.checkBoxWidth=+this.m_fontsize<12?12:+this.m_fontsize,this.createLegendContainerDiv(),this.m_chartFrame.init(this),this.m_cursortype=IsBoolean(this.m_legendcheckbox)?"pointer":"default",this.m_designMode||null==this.getAssociatedChartObject()?this.setLegendInfoForStatic():this.setLegendInfoForAssignedChart(this.getAssociatedChartObject())},Legend.prototype.setLegendInfoForAssignedChart=function(e){var t,i=this,s=(this.legendNames=[],this.legendDisplayNames=[],this.legendColors=[],this.legendShapes=[],this.m_legendObjectArr=[],e.getLegendInfo());for(t in s)this.legendNames.push(s[t].seriesName),this.legendDisplayNames.push(s[t].displayName),this.legendColors.push(s[t].color),this.legendShapes.push(s[t].shape),this.m_legendObjectArr.push({legendName:s[t].seriesName,legendShape:s[t].shape,legendColor:s[t].color,legendDisplayName:s[t].displayName,index:s[t].index});if(this.m_legendObjectArr.sort(function(e,t){return e.index-t.index}),IsBoolean(this.m_isstaticlegend))for(var n=this.m_legendnames.split(","),a=(a=this.m_legendnames.split(",")).map(function(e){return i.getValueFromGlobalVariable(e,"square",!1)}),d=this.m_legendcolors.split(","),r=this.m_legendshapes.split(","),o=0;o<n.length;o++)this.m_legendObjectArr.push({legendName:n[o],legendShape:r[o],legendColor:d[o],legendDisplayName:a[o],legendType:"static"})},Legend.prototype.setLegendInfoForStatic=function(e){var t=this;this.m_legendObjectArr=[],this.legendNames=this.m_legendnames.split(","),this.legendDisplayNames=this.m_legendnames.split(","),this.legendDisplayNames=this.legendDisplayNames.map(function(e){return t.getValueFromGlobalVariable(e,"square",!1)}),this.legendColors=this.m_legendcolors.split(","),this.legendShapes=this.m_legendshapes.split(",");for(var i=0;i<this.legendNames.length;i++)this.m_legendObjectArr.push({legendName:this.legendNames[i],legendShape:this.legendShapes[i],legendColor:this.legendColors[i],legendDisplayName:this.legendDisplayNames[i]})},Legend.prototype.drawChart=function(){this.m_chartFrame.drawFrame(),0<this.m_legendObjectArr.length&&(this.calculateLegendsWidth(),this.drawLegend())},Legend.prototype.drawLegend=function(){for(var e,t=0;t<this.m_legendObjectArr.length;t++)""!=this.m_legendObjectArr[t].legendName&&(e=IsBoolean(this.m_legendcheckbox),IsBoolean(this.m_isstaticlegend)&&"static"==this.m_legendObjectArr[t].legendType&&(e=!1),this.drawLegendDiv(t),e&&this.drawLegendCheckbox(t),this.drawHtmlLegends(t),this.drawHtmlLegendText(t))},Legend.prototype.drawLegendDiv=function(e){var t=this,i=document.createElement("div");i.setAttribute("id","LegendDiv"+this.m_objectid+e),i.setAttribute("class","legend-row-div"),"vertical"==this.m_legenddirection?i.setAttribute("style","display: table-row;vertical-align:top;cursor: "+this.m_cursortype+";"):i.setAttribute("style","display: inline-flex; padding-top: "+t.fontScaling(2)+"px; vertical-align:top; margin-right: 15px; cursor: "+this.m_cursortype+";"),$("#LegendContainerDiv"+t.m_objectid).append(i),$("#LegendDiv"+this.m_objectid+e).hover(function(){$(this).css("background",t.m_rollovercolor)},function(){$(this).css("background","transparent")})},Legend.prototype.drawLegendCheckbox=function(e){var t=this,i=document.createElement("div"),s=document.createElement("input");s.setAttribute("type","checkbox"),s.setAttribute("class","cr-checkbox"),this.m_enhanceCheckbox&&s.setAttribute("class","option-input-cr cr-checkbox"),s.setAttribute("id",this.m_objectid+"LegendCheckbox"+this.m_legendObjectArr[e].legendName),IsBoolean(this.m_designMode)||null==t.getAssociatedChartObject()?s.setAttribute("checked",!0):s.setAttribute(1==IsBoolean(t.getAssociatedChartObject().m_seriesVisibleArr[this.m_legendObjectArr[e].legendName])?"checked":"unchecked",!0),i.setAttribute("id",this.m_objectid+"LegendCheckboxDiv"+this.m_legendObjectArr[e].legendName),i.setAttribute("class","legend-checkbox-div"),i.setAttribute("style","display: table-cell;vertical-align: middle;position: relative;text-align: center;width: 25px;padding: "+this.m_rowpadding/2+"px "+this.m_columnpadding+"px "+this.m_rowpadding/2+"px "+this.m_columnpadding+"px;"),$(i).append(s),$("#LegendDiv"+this.m_objectid+e).append(i),$(s).css({width:t.fontScaling(this.checkBoxWidth)+"px",height:t.fontScaling(this.checkBoxWidth)+"px",display:"inline-block","vertical-align":"middle",margin:"0px 0 0",position:"absolute",top:"45%",left:"50%",transform:"translate(-50%, -50%)"}),IsBoolean(t.m_designMode)||(s.onchange=function(){t.redrawAssociatedChart($(this).attr("id").split("LegendCheckbox")[1],this.checked),t.getDataPointAndUpdateGlobalVariable(t.m_legendObjectArr[e].legendDisplayName,t.m_legendObjectArr[e].legendName,t.m_legendObjectArr[e].legendColor)})},Legend.prototype.redrawAssociatedChart=function(t,e){var i,s=this.getAssociatedChartObject();if(null!=s)if(s.m_legendFlag=!1,IsBoolean(s.m_isRepeaterPart))for(var n=s.m_parentObj,a=0;a<n.m_repeaterCharts.length;a++){n.m_repeaterCharts[a].m_seriesVisibleArr[t]=e;var d=n.m_repeaterCharts[a].m_parentObj.m_defaultlegendfields.findIndex(function(e){return e.key==t});-1!=d&&n.m_repeaterCharts[a].m_parentObj.m_defaultlegendfields[d]&&(n.m_repeaterCharts[a].m_parentObj.m_defaultlegendfields[d].value=e),this.checkboxChangedFlag=!0,s.setChartState("legendCheckboxChanged"),n.m_repeaterCharts[a].draw()}else s.m_seriesVisibleArr[t]=e,s.m_defaultlegendfields&&-1!=(i=s.m_defaultlegendfields.findIndex(function(e){return e.key==t}))&&s.m_defaultlegendfields[i]&&(s.m_defaultlegendfields[i].value=e),this.checkboxChangedFlag=!0,s.draw();this.redrawMultipleAssociatedCharts(t,e)},Legend.prototype.redrawMultipleAssociatedCharts=function(e,t){if(this.m_multipleassociatedchart&&IsBoolean(this.m_multipleassociatedchart.enable)){var i=this.m_multipleassociatedchart.id,s=this.getAssociatedChartObject();s&&s.m_referenceid&&-1==i.indexOf(s.m_referenceid)&&i.push(s.m_referenceid);for(var n=0;n<i.length;n++)null==(s=this.getChartObjectByReferenceId(i[n]))||IsBoolean(s.isValidRepeaterConfig())||(this.m_associatedchartid=s.m_objectid,s.m_associatedlegendid=this.m_objectid,s.m_seriesVisibleArr[e]=t,this.checkboxChangedFlag=!0,s.draw())}},Legend.prototype.drawHtmlLegends=function(e){"defaultshape"!=this.m_legendsymbol&&0<this.m_legendObjectArr.length&&null!=this.m_legendObjectArr[e].legendShape?this.drawLegendShape(e,this.m_shapeMap.hasOwnProperty(this.m_legendObjectArr[e].legendShape)?this.m_shapeMap[this.m_legendObjectArr[e].legendShape]:this.m_shapeMap.default):this.drawLegendShape(e,this.m_shapeMap.default)},Legend.prototype.drawLegendShape=function(e,t){var i=document.createElement("div"),s=(i.setAttribute("id","LegendShape"+this.m_legendObjectArr[e].legendName+this.m_objectid),"display: table-cell;align-items:center;vertical-align: middle;text-align: -webkit-center;width: 25px;padding: "+this.m_rowpadding/2+"px "+this.m_columnpadding+"px "+this.m_rowpadding/2+"px "+this.m_columnpadding+"px;"),s=(i.setAttribute("style",s),i.setAttribute("class","legend-shape-div"),$("#LegendDiv"+this.m_objectid+e).append(i),document.createElement("a")),n=($(s).attr("class",t),this.m_enhanceCheckbox&&$(s).attr("class",t+" legend-shape"),this.m_legendwidth);"bd-diamond"==t&&0!=n?n=+this.m_legendwidth+2:"bd-stop"!=t&&"bd-cross"!=t||0==n||(n=+this.m_legendwidth-1),$(s).css({color:this.m_legendObjectArr[e].legendColor,"font-size":+n+"px",display:"inline-flex","text-decoration":"none","vertical-align":"middle"}),$(i).append(s)},Legend.prototype.drawHtmlLegendText=function(e){var t=this,i=document.createElement("div"),s=document.createElement("label"),n=document.createElement("span"),a=(s.setAttribute("for",this.m_objectid+"LegendCheckbox"+this.m_legendObjectArr[e].legendName),n.innerHTML=this.m_legendObjectArr[e].legendDisplayName,i.setAttribute("id",t.m_objectid+""+t.m_legendObjectArr[e].legendName),"display:table-cell;vertical-align:middle;padding:"+this.m_rowpadding/2+"px "+this.m_columnpadding+"px "+this.m_rowpadding/2+"px "+this.m_columnpadding+"px;");i.setAttribute("style",a),i.setAttribute("class","legend-label-div"),n.setAttribute("style","margin-bottom:0px;cursor: "+this.m_cursortype+";font-weight:"+this.m_fontweight+";font-size:"+this.fontScaling(+this.m_fontsize)+"px;font-style:"+this.m_fontstyle+";font-family:"+selectGlobalFont(this.m_fontfamily)+";color:"+this.m_fontcolor+";text-decoration:"+this.m_textdecoration+";"),$(s).append(n),$(i).append(s),$("#LegendDiv"+this.m_objectid+e).append(i),IsBoolean(this.m_legendcheckbox)||IsBoolean(t.m_designMode)||(i.onclick=function(){t.getDataPointAndUpdateGlobalVariable(t.m_legendObjectArr[e].legendDisplayName,t.m_legendObjectArr[e].legendName,t.m_legendObjectArr[e].legendColor)}),$(s).css({display:"inline-flex","margin-bottom":"0px","vertical-align":"middle"})},Legend.prototype.calculateLegendsWidth=function(){this.m_legendwidth=this.fontScaling(this.m_fontsize),this.m_legendheight=this.fontScaling(this.m_fontsize),this.ctx.font=this.m_fontstyle+" "+this.m_fontweight+" "+this.fontScaling(+this.m_fontsize)+"px "+selectGlobalFont(this.m_fontfamily);var e=IsBoolean(this.m_legendcheckbox)?+this.marginGap+this.checkBoxWidth:0;this.createSpanToCalculateWidth(),this.legendsWidthArray=[];for(var t=0;t<this.m_legendObjectArr.length;t++){var i=this.getTextWidth(this.m_legendObjectArr[t].legendDisplayName),i=+this.marginLeft+ +e+ +this.marginGap+ +this.m_legendwidth+ +this.marginGap+ +i+ +this.marginGap;this.legendsWidthArray.push(i)}$("#textWidthCalcDiv"+this.m_objectid).remove()},Legend.prototype.createSpanToCalculateWidth=function(){$("#textWidthCalcDiv"+this.m_objectid).remove();var e=document.createElement("div");e.id="textWidthCalcDiv"+this.m_objectid,e.style.position="absolute",e.style.float="left",e.style.whiteSpace="nowrap",e.style.visibility="hidden",e.style.display="none",e.style.fontSize=this.fontScaling(+this.m_fontsize)+"px",e.style.fontFamily=selectGlobalFont(this.m_fontfamily),e.style.fontWeight=this.m_fontweight,e.style.fontStyle=this.m_fontstyle,document.body.appendChild(e)},Legend.prototype.getTextWidth=function(t){try{return $("#textWidthCalcDiv"+this.m_objectid).html(""+t),$("#textWidthCalcDiv"+this.m_objectid).width()}catch(e){return this.ctx.measureText(""+t).width}},Legend.prototype.getNoOfRows=function(e){for(var t=1,i=0,s=0;s<this.legendsWidthArray.length;s++)+e<(i=+i+ +this.legendsWidthArray[s])&&(t++,i=this.legendsWidthArray[s]);return t},Legend.prototype.getOneRowHeight=function(){return+this.marginTop+ +this.m_legendheight+ +this.marginGap},Legend.prototype.getLargestLegend=function(){for(var e=0,t=0;t<this.legendsWidthArray.length;t++)+this.legendsWidthArray[t]>e&&(e=this.legendsWidthArray[t]);return e},Legend.prototype.getLegendMargins=function(e){var t;return e="horizontal"==this.m_legenddirection?(t=this.getNoOfRows(e)*this.getOneRowHeight(),0):(t=0,this.getLargestLegend()),{bottom:t,right:e}},Legend.prototype.repositionLegend=function(e){var t,i,s,n=this,a=(this.m_original_x=$("#draggableDiv"+n.m_objectid)[0].offsetLeft,this.m_original_y=$("#draggableDiv"+n.m_objectid)[0].offsetTop,this.m_original_width=this.m_width,this.m_original_height=this.m_height,this.m_original_zindex=this.m_zIndex,$("#draggableDiv"+e.m_objectid)),d=a.width(),d=this.getLegendMargins(d),d="horizontal"==this.m_legenddirection?(t=a.css("left").split("px")[0],i=+a.css("top").split("px")[0]+ +a.css("height").split("px")[0],s=a.css("width").split("px")[0],d.bottom):(t=+a.css("left").split("px")[0]+ +a.css("width").split("px")[0],i=a.css("top").split("px")[0],s=d.right,a.css("height").split("px")[0]);$("#draggableDiv"+n.m_objectid).css({"z-index":e.maximizeZindex,left:t+"px",top:n.fontScaling(i)+"px",width:s+"px",height:d+"px"}),$("#draggableCanvas"+n.m_objectid).attr("width",s),$("#draggableCanvas"+n.m_objectid).attr("height",d),$("#draggableCanvas"+n.m_objectid).css({width:s,height:d}),this.adjustPixelRatio(),this.m_width=s,this.m_height=d},Legend.prototype.setOriginalPosition=function(){var e=this;this.m_width=this.m_original_width,this.m_height=this.m_original_height,$("#draggableDiv"+e.m_objectid)[0].offsetLeft=this.m_original_x,$("#draggableDiv"+e.m_objectid)[0].offsetTop=this.m_original_y,$("#draggableDiv"+e.m_objectid).css({"z-index":this.m_zIndex,left:+this.m_original_x+"px",top:+this.m_original_y+"px",width:this.m_original_width+"px",height:this.m_original_height+"px"}),$("#draggableCanvas"+e.m_objectid).attr("width",this.m_original_width),$("#draggableCanvas"+e.m_objectid).attr("height",this.m_original_height),$("#draggableCanvas"+e.m_objectid).css({width:this.m_original_width,height:this.m_original_height}),this.adjustPixelRatio(),this.m_x=0,this.m_y=0},Legend.prototype.getLegendTextHeight=function(e,t){var e=$('<span style="font-size:'+this.fontScaling(+e)+"; font-family:"+t+';">Hg</span>'),t=$('<div style="display: inline-block; width: 1px; height: 0px;"></div>'),i=$("<div></div>");i.append(e,t),$("body").append(i);try{var s={};t.css({verticalAlign:"baseline"}),s.ascent=t.offset().top-e.offset().top,t.css({verticalAlign:"bottom"}),s.height=t.offset().top-e.offset().top,s.descent=s.height-s.ascent}finally{i.remove()}return s.height},Legend.prototype.getDataPointAndUpdateGlobalVariable=function(e,t,i){this.updateDataPoints({drillDisplayField:e,drillField:t},i)};
//# sourceMappingURL=Legend.min.js.map