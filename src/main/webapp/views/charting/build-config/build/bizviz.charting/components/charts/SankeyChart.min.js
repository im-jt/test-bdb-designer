/*! BDB Charting Library V10.0.0 (2025-08-14 11:37:12) 
 Copyright 2015-2024 BDB (BizViz Technologies Pvt Ltd). All Rights Reserved */
function SankeyChart(t,e){this.base=Chart,this.base(),this.m_x=680,this.m_y=320,this.m_width=300,this.m_height=260,this.m_barWidth=10,this.m_categoryData=[],this.m_seriesData=[],this.m_categoryNames=[],this.m_seriesNames=[],this.m_barSeriesArray=[],this.m_xPositionArray=[],this.m_yPositionArray=[],this.m_barWidth="",this.m_barHeightArray=[],this.m_seriesVisiblityPosition,this.m_showpercentvalue=!1,this.m_showmarkingorpercentvalue=!1,this.m_showPercentValueFlag=!0,this.m_seriesInitializeFlag=!0,this.noOfRows=1,this.m_title=new svgTitle(this),this.m_subTitle=new svgSubTitle,this.m_chartContainer=t,this.m_zIndex=e,this.m_showhorizontalmarkerline=!1,this.m_subcategoryorientation="left",this.m_mergesubcategory="false",this.dataMap={},this.m_color=[],this.m_colors="#cccccc,26265",this.m_defaultcolor="#808080",this.m_cloudgradients="#216cdf, #285bbb, #284b99, #253b77, #202c58",this.m_aggroperation="avg",this.m_showcatsubcatpartitioner="true",this.m_showcatpartitioner="true",this.m_enableanimation="false",this.m_baranimationduration=.5,this.m_stackborderwidth="0",this.m_stackbordercolor="#ffffff",this.m_enablestackshadow="false",this.m_stackshadowcolor="#000000",this.m_stackshadowopacity="0.3",this.m_canvastype="svg",this.m_stacksvgtype="rect",this.m_controlbarwidth="auto",this.m_stackborderradius="0",this.enableDrillHighlighter="false",this.m_textalign="right",this.m_drilltoggle=!0,this.m_categorycolors={categoryDefaultColor:"",categoryDefaultColorSet:"",showColorsFromCategoryName:"false",CategoryColor:[]},this.m_conditionalcolors={ConditionalColor:[]},this.m_subcategorycolors={subCategoryDefaultColor:"",subCategoryDefaultColorSet:"",showColorsFromSubCategoryName:"false",subCategoryColor:[]},this.m_sankeydata={nodes:[],links:[]},this.m_nullValue=!1,this.firstLevelNodes=""}SankeyChart.prototype=new Chart,SankeyChart.prototype.setProperty=function(t){this.ParseJsonAttributes(t.Object,this),this.initCanvas()},SankeyChart.prototype.ParseJsonAttributes=function(t,e){for(var a in this.chartJson=t)if("Chart"==a)for(var i in t[a])switch(i){case"Title":for(var r in t[a][i]){var s=this.getNodeAttributeName(r);e.m_title[s]=t[a][i][r]}break;case"SubTitle":for(var o in t[a][i]){var s=this.getNodeAttributeName(o);e.m_subTitle[s]=t[a][i][o]}break;case"CategoryColors":var n,l=new CategoryColors;for(n in this.setCategoryColors(l),t[a][i])if("CategoryColor"===n){var h=this.getArrayOfSingleLengthJson(t[a][i][n]);l.cateogryNameColorMap=new Object;for(var m=0;m<h.length;m++){var g,u=new CategoryColor;for(g in l.setCategoryColor(u),h[m])u[s=this.getNodeAttributeName(g)]=h[m][g];l.cateogryNameColorMap[u.getCategoryName()]=u.getColor()}}else{var s=this.getNodeAttributeName(n);e.m_categoryColors[s]=t[a][i][n]}l.setCategoryDefaultColorSet();break;case"SubCategoryColors":var c,y=new SubCategoryColors;for(c in this.setSubCategoryColors(y),t[a][i])if("subCategoryColor"===c){var p=this.getArrayOfSingleLengthJson(t[a][i][c]);y.subcateogryNameColorMap=new Object;for(m=0;m<p.length;m++){var d,_=new SubCategoryColor;for(d in y.setSubCategoryColor(_),p[m])_[s=this.getNodeAttributeName(d)]=p[m][d];y.subcateogryNameColorMap[_.getSubCategoryName()]=_.getColor()}}else{s=this.getNodeAttributeName(c);e.m_subCategoryColors[s]=t[a][i][c]}y.setSubCategoryDefaultColorSet();break;case"ConditionalColors":if(""!=t[a][i])for(var f=new ConditionalColors,b=(this.setConditionalColors(f),this.getArrayOfSingleLengthJson(t[a][i].ConditionalColor)),m=0;m<b.length;m++){var C,S=new ConditionalColor;for(C in f.setConditionalColor(S),b[m])S[s=this.getNodeAttributeName(C)]=b[m][C]}break;default:e[s=this.getNodeAttributeName(i)]=t[a][i]}else e[s=this.getNodeAttributeName(a)]=t[a]},SankeyChart.prototype.getDataProvider=function(){return this.m_dataProvider},SankeyChart.prototype.getCategoryNames=function(){return this.m_categoryNames},SankeyChart.prototype.getCategoryDisplayNames=function(){return this.m_categoryDisplayNames},SankeyChart.prototype.getSubCategoryNames=function(){return this.m_subCategoryNames},SankeyChart.prototype.drawNodeChartToolTip=function(t){var t=t.data,e=(this.m_tooltipborderwidth,this.m_tooltipbordercolor,'<table class=" chart-tooltip bdtooltip" >'),e=(e=(e+='<tr><td colspan="3" class="chart-tooltip-head" style=\'background:'+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'><span class='colorspan' style='background-color:"+t[0].color+";'></span>"+t[0].text+"</td></tr>")+('<tr><td align="left" style=\'background:'+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'>Name</td><td align=\"left\" style='background:"+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'>"+t[1].text+"</td></tr>"))+('<tr><td align="left" style=\'background:'+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'>Value</td><td align=\"left\" style='background:"+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'>"+t[1].value+"</td></tr>");return void 0!==t[2]&&(e+='<tr><td align="left" style=\'background:'+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'>Percentage</td><td align=\"left\" style='background:"+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'>"+t[2].percentage+" %</td></tr>"),e+="</table>"},SankeyChart.prototype.drawEdgeChartToolTip=function(t){var t=t.data,e=(this.m_tooltipborderwidth,this.m_tooltipbordercolor,'<table class=" chart-tooltip bdtooltip" >'),e=(e=(e=(e+='<tr><td colspan="3" class="chart-tooltip-head" style=\'background:'+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'><span class='colorspan' style='background-color:"+t[0].color+";'></span>"+t[0].text+"</td></tr>")+('<tr><td align="left" style=\'background:'+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'>Source</td><td align=\"left\" style='background:"+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'>"+t[1].source+"</td></tr>"))+('<tr><td align="left" style=\'background:'+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'>Target</td><td align=\"left\" style='background:"+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'>"+t[1].target+"</td></tr>"))+('<tr><td align="left" style=\'background:'+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'>Value</td><td align=\"left\" style='background:"+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'>"+t[1].value+"</td></tr>");return void 0!==t[2]&&(e+='<tr><td align="left" style=\'background:'+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'>Percentage</td><td align=\"left\" style='background:"+this.m_tooltipbackgroundcolor+";font-size:"+parseInt(this.m_tooltipfontsize)+"px;'>"+t[2].percentage+" %</td></tr>"),e+="</table>"},SankeyChart.prototype.getToolTipData=function(t,e){var a=this,i=[],t=(null!=t.data&&("edge"==t.dataType?(i[0]={text:"Edge Link",color:t.color,value:t.value},i[1]={source:t.data.source,target:t.data.target,value:t.data.actvalue,percentage:t.data.percentage},IsBoolean(a.m_showpercentvalue)&&(i[2]={percentage:t.data.percentage})):(i[0]={text:"Node",color:t.color,value:a.m_sankeydata.nodes[e].actvalue},i[1]={text:t.data.name,value:a.m_sankeydata.nodes[e].actvalue,percentage:a.m_sankeydata.nodes[e].percentage},IsBoolean(a.m_showpercentvalue)&&(i[2]={percentage:a.m_sankeydata.nodes[e].percentage}))),{});t.cat="",t.data=new Array;for(var r,e=0;e<i.length;e++)""==i[e].value||isNaN(i[e].value)||null==i[e].value||"null"==i[e].value?i[e].value=i[e].value:(r=+i[e].value)%1!=0&&"default"!==a.m_tooltipprecision?i[e].value=r.toFixed(a.m_tooltipprecision):i[e].value=+r,""==i[e].percentage||isNaN(i[e].percentage)||null==i[e].percentage||"null"==i[e].percentage?i[e].percentage=i[e].percentage:(r=+i[e].percentage)%1!=0&&"default"!==a.m_tooltipprecision?i[e].percentage=r.toFixed(a.m_tooltipprecision):i[e].percentage=+r,i[e].value=this.getUpdatedFormatterForToolTip(i[e].value,i[e].text);return t.data=i,t},SankeyChart.prototype.setFormatter=function(){var t,e;this.m_unitSymbol="",this.m_formatterPosition="",this.m_isFormatter=!1,"none"!=this.m_formater&&""!=this.m_formater&&(t=this.getFormater(),"none"!=(e=this.getUnit()))&&""!=e&&(this.m_isFormatter=!0,this.m_unitSymbol=this.m_util.getFormatterSymbol(t,e),this.m_formatterPosition=this.getSignPosition(),""==this.m_formatterPosition)&&(this.m_formatterPosition="suffix")},SankeyChart.prototype.setSecondaryFormatter=function(){var t,e;this.m_secondaryUnitSymbol="",this.m_secondaryFormatterPosition="",this.m_isSecondaryFormatter=!1,"none"!=this.m_secondaryformater&&""!=this.m_secondaryformater&&(t=this.getSecondaryFormater(),""!=(e=this.getSecondaryUnit())&&"none"!=e&&null!=e&&(this.m_isSecondaryFormatter=!0,this.m_secondaryUnitSymbol=this.m_util.getFormatterSymbol(t,e)),this.m_secondaryFormatterPosition="suffix")},SankeyChart.prototype.getFormatterForToolTip=function(t){var e,a,i,r,s,o,n;return isNaN(getNumericComparableValue(t))?t:((""+t).indexOf(","),e=""!=this.m_signposition?this.m_signposition:"suffix",a=this.m_tooltipprecision,o=this.m_unit,r=this.m_secondaryunit,n="default"===a?+getNumericComparableValue(t):(+getNumericComparableValue(t)).toFixed(a),""!=o?(i=this.m_util.getFormatterSymbol("Currency",o),"auto"==(r=this.m_util.getFormatterSymbol("Number",r))?(t=getNumericComparableValue(t),s=getNumberFormattedSymbol(+t,o),o=getNumberFormattedNumericValue(+t,a,o),o=this.m_util.updateTextWithFormatter(o,"",a),n=this.m_util.addFormatter(o,s,"suffix")):(n=this.m_util.updateTextWithFormatter(n,r,a),"none"!=r&&""!=r&&(n=this.m_util.addFormatter(n,r,"suffix"))),"NaN"==n||""===n?"":this.m_util.addFormatter(getFormattedNumberWithCommas(n,this.m_numberformatter),i,e)):"NaN"==n?t:n)},SankeyChart.prototype.getPrecisonData=function(t){var e,a,i=t.value,r=((""+(i=IsBoolean(this.m_showpercentvalue)?i.split("%")[0]:i)).indexOf(","),""!=this.m_signposition?this.m_signposition:"suffix"),s=this.m_precision,o=this.m_unit,n=this.m_secondaryunit,l="default"===s?+getNumericComparableValue(i):(+getNumericComparableValue(i)).toFixed(s);return l=""!=o?(e=this.m_util.getFormatterSymbol("Currency",o),"auto"==(n=this.m_util.getFormatterSymbol("Number",n))?(i=getNumericComparableValue(i),a=getNumberFormattedSymbol(+i,o),o=getNumberFormattedNumericValue(+i,s,o),o=this.m_util.updateTextWithFormatter(o,"",s),l=this.m_util.addFormatter(o,a,"suffix")):(l=this.m_util.updateTextWithFormatter(l,n,s),"none"!=n&&""!=n&&(l=this.m_util.addFormatter(l,n,"suffix"))),"NaN"==l||""===l?"":this.m_util.addFormatter(getFormattedNumberWithCommas(l,this.m_numberformatter),e,r)):"NaN"==l?i:l,IsBoolean(this.m_showpercentvalue)?t.name+" : "+l+"%":t.name+" : "+l},SankeyChart.prototype.getSecondaryFormaterAddedText=function(textValue,secondaryUnitSymbol){var formattedText=textValue,secondaryFormatterPosition="suffix";try{eval("var formattedText = this.m_util.addUnitAs"+secondaryFormatterPosition+"(textValue,secondaryUnitSymbol);")}catch(e){}return formattedText},SankeyChart.prototype.getFieldFormatterForToolTip=function(fieldname,value){var data=value,m_precision;if(data=getNumericComparableValue(data),isNaN(data)||""==data||null==data)return data;if(this.m_precision=this.formatterMap[fieldname].precision,m_precision="default"!==this.m_precision?this.m_precision:(m_precision=(data+"").split("."),void 0!==m_precision[1]?m_precision[1].length:0),"none"!=this.formatterMap[fieldname].secondformatter&&""!=this.formatterMap[fieldname].secondformatter&&""!=this.formatterMap[fieldname].secondunitname&&"none"!=this.formatterMap[fieldname].secondunitname)if(this.m_secondaryUnitSymbol=this.m_util.getFormatterSymbol(this.formatterMap[fieldname].secondformatter,this.formatterMap[fieldname].secondunitname),this.m_secondaryFormatterPosition="suffix","auto"!=this.m_secondaryUnitSymbol)try{data=this.m_util.updateTextWithFormatter(data,this.m_secondaryUnitSymbol,m_precision),data=this.getLocaleWithPrecision(data,m_precision),eval("data = this.m_util.addUnitAs"+this.m_secondaryFormatterPosition+"(data,this.m_secondaryUnitSymbol);")}catch(e){}else{var symbol=getNumberFormattedSymbol(+data),data=getNumberFormattedNumericValue(+data,m_precision);data=this.getLocaleWithPrecision(data,m_precision),eval("data = this.m_util.addUnitAs"+this.m_secondaryFormatterPosition+"(data,symbol);")}else data=this.getLocaleWithPrecision(data,m_precision);return"none"!=this.formatterMap[fieldname].formatter&&""!=this.formatterMap[fieldname].formatter&&"none"!=this.formatterMap[fieldname].unitname&&""!=this.formatterMap[fieldname].unitname&&(this.m_unitSymbol=this.m_util.getFormatterSymbol(this.formatterMap[fieldname].formatter,this.formatterMap[fieldname].unitname),null!=this.m_unitSymbol)?(""==this.formatterMap[fieldname].signposition&&(this.formatterMap[fieldname].signposition="suffix"),this.m_util.addFormatter(data,this.m_unitSymbol,this.formatterMap[fieldname].signposition,m_precision)):data},SankeyChart.prototype.setFields=function(t){this.m_fieldsJson=t;for(var e=[],a=(this.m_categoryJSON=[],this.m_subCategoryJSON=[],[]),i=[],r=0;r<t.length;r++)switch(this.getProperAttributeNameValue(t[r],"Type")){case"Category":e.push(t[r]),this.m_categoryJSON.push(t[r]);break;case"SubCategory":i.push(t[r]),this.m_subCategoryJSON.push(t[r]);break;case"Series":case"CalculatedField":a.push(t[r])}0<i.length&&0<e.length&&i[0].Name==e[0].Name&&(i=e,e=[]),0==i.length&&0!=e.length&&(this.m_subcategoryorientation="left",i=e,e=[]),this.setCategory(e),this.setSubCategory(i),this.setSeries(a)},SankeyChart.prototype.setCategory=function(t){this.m_categoryNames=[],this.m_categoryFieldColor=[],this.m_categoryDisplayNames=[],this.m_allCategoryNames=[],this.m_allCategoryDisplayNames=[],this.m_categoryVisibleArr={};for(var e=0,a=0;a<t.length;a++){this.m_allCategoryNames[a]=this.getProperAttributeNameValue(t[a],"Name");var i=this.formattedDescription(this,this.getProperAttributeNameValue(t[a],"DisplayName"));this.m_allCategoryDisplayNames[a]=i,this.m_categoryVisibleArr[this.m_allCategoryDisplayNames[a]]=this.getProperAttributeNameValue(t[a],"visible"),IsBoolean(this.m_categoryVisibleArr[this.m_allCategoryDisplayNames[a]])&&(this.m_categoryNames[e]=this.getProperAttributeNameValue(t[a],"Name"),this.m_categoryDisplayNames[e]=i,this.m_categoryFieldColor[e]=this.getProperAttributeNameValue(t[a],"Color"),e++)}},SankeyChart.prototype.setSubCategory=function(t){this.m_subCategoryNames=[],this.m_subCategoryDisplayNames=[],this.m_allSubCategoryNames=[],this.m_allSubCategoryDisplayNames=[],this.m_subCategoryVisibleArr={};for(var e=0;e<t.length;e++){this.m_allSubCategoryNames[e]=this.getProperAttributeNameValue(t[e],"Name");var a=this.formattedDescription(this,this.getProperAttributeNameValue(t[e],"DisplayName"));this.m_allSubCategoryDisplayNames[e]=a,this.m_subCategoryVisibleArr[this.m_allSubCategoryDisplayNames[e]]=this.getProperAttributeNameValue(t[e],"visible"),IsBoolean(this.m_subCategoryVisibleArr[this.m_allSubCategoryDisplayNames[e]])&&(this.m_subCategoryNames[0]=this.getProperAttributeNameValue(t[e],"Name"),this.m_subCategoryDisplayNames[0]=a)}},SankeyChart.prototype.setSeries=function(t){this.m_seriesNames=[],this.m_seriesDisplayNames=[],this.m_seriesColors=[],this.m_legendNames=[],this.m_seriesVisibleArr={},this.m_allSeriesDisplayNames=[],this.m_allSeriesNames=[],this.m_plotTrasparencyArray=[],this.m_seriesDataLabelProperty=[];var e=0;this.legendMap={};for(var a=0;a<t.length;a++){var i=this.formattedDescription(this,this.getProperAttributeNameValue(t[a],"DisplayName"));this.m_allSeriesDisplayNames[a]=i,this.m_allSeriesNames[a]=this.getProperAttributeNameValue(t[a],"Name"),this.m_seriesVisibleArr[this.m_allSeriesNames[a]]=this.getProperAttributeNameValue(t[a],"visible"),IsBoolean(this.m_seriesVisibleArr[this.m_allSeriesNames[a]])&&(this.m_seriesDisplayNames[e]=i,this.m_seriesNames[e]=this.getProperAttributeNameValue(t[a],"Name"),this.m_legendNames[e]=i,this.m_seriesColors[e]=convertColorToHex(this.getProperAttributeNameValue(t[a],"Color")),this.m_seriesDataLabelProperty[e]=this.getProperAttributeNameValue(t[a],"DataLabelCustomProperties"),void 0!==this.m_seriesDataLabelProperty[e]?(IsBoolean(this.m_seriesDataLabelProperty[e].useFieldColor)&&(this.m_seriesDataLabelProperty[e].dataLabelFontColor=this.m_seriesColors[e]),void 0!==this.m_seriesDataLabelProperty[e].showPercentValue&&IsBoolean(this.m_seriesDataLabelProperty[e].showPercentValue)&&"100%"==this.m_charttype&&(this.m_seriesDataLabelProperty[e].datalabelField=this.m_seriesNames[e]),IsBoolean(this.m_seriesDataLabelProperty[e].dataLabelUseComponentFormater)&&(this.m_seriesDataLabelProperty[e].datalabelFormaterCurrency=this.m_unit,this.m_seriesDataLabelProperty[e].datalabelFormaterPrecision=this.m_precision,this.m_seriesDataLabelProperty[e].datalabelFormaterPosition=this.m_signposition,this.m_seriesDataLabelProperty[e].datalabelFormaterUnit=this.m_secondaryunit)):this.m_seriesDataLabelProperty[e]=this.getDataLabelProperties(),i=this.getProperAttributeNameValue(t[a],"PlotTransparency"),this.m_plotTrasparencyArray[e]=null!=i&&null!==i&&""!==i?i:1,i={seriesName:this.m_seriesNames[e],displayName:this.m_seriesDisplayNames[e],color:this.m_seriesColors[e],shape:"cube"},this.legendMap[this.m_seriesNames[e]]=i,e++)}this.setLegendsIntialLoad(this.m_defaultlegendfields)},SankeyChart.prototype.getLegendInfo=function(){return this.legendMap},SankeyChart.prototype.getAllSeriesNames=function(){return this.m_allSeriesNames},SankeyChart.prototype.getAllCategoryNames=function(){return this.m_allCategoryNames},SankeyChart.prototype.getAllSubCategoryNames=function(){return this.m_allSubCategoryNames},SankeyChart.prototype.getSeriesNames=function(){return this.m_seriesNames},SankeyChart.prototype.getSeriesDisplayNames=function(){return this.m_seriesDisplayNames},SankeyChart.prototype.getSeriesColors=function(){return this.m_seriesColors},SankeyChart.prototype.setLegendNames=function(t){this.m_legendNames=t},SankeyChart.prototype.getLegendNames=function(){return this.m_legendNames},SankeyChart.prototype.setAllFieldsName=function(){this.m_allfieldsName=[];for(var t=0;t<this.getAllCategoryNames().length;t++)this.m_allfieldsName.push(this.getAllCategoryNames()[t]);for(t=0;t<this.getAllSubCategoryNames().length;t++)this.m_allfieldsName.push(this.getAllSubCategoryNames()[t]);for(var e=0;e<this.getAllSeriesNames().length;e++)this.m_allfieldsName.push(this.getAllSeriesNames()[e])},SankeyChart.prototype.getAllFieldsName=function(){return this.m_allfieldsName},SankeyChart.prototype.setAllFieldsDisplayName=function(){this.m_allfieldsDisplayName=[];for(var t=0;t<this.getCategoryDisplayNames().length;t++)this.m_allfieldsDisplayName.push(this.getCategoryDisplayNames()[t]);for(var e=0;e<this.getSeriesDisplayNames().length;e++)this.m_allfieldsDisplayName.push(this.getSeriesDisplayNames()[e])},SankeyChart.prototype.getAllFieldsDisplayName=function(){return this.m_allfieldsDisplayName},SankeyChart.prototype.setCategoryData=function(){this.m_categoryData=[],this.isEmptyCategory=!0;for(var t=0;t<this.getCategoryNames().length;t++)this.isEmptyCategory=!1,this.m_categoryData[t]=this.getDataFromJSON(this.getCategoryNames()[t])},SankeyChart.prototype.setSubCategoryData=function(){this.m_subCategoryData=[],this.isEmptySubCategory=!0;for(var t=0;t<this.getSubCategoryNames().length;t++)this.isEmptySubCategory=!1,this.m_subCategoryData[t]=this.getDataFromJSON(this.getSubCategoryNames()[t])},SankeyChart.prototype.getSubCategoryData=function(){return this.m_subCategoryData},SankeyChart.prototype.getCategoryData=function(){return this.m_categoryData},SankeyChart.prototype.setSeriesData=function(){this.m_seriesData=[];for(var t=0;t<this.getSeriesNames().length;t++)this.m_seriesData.push(this.getDataFromJSON(this.getSeriesNames()[t]))},SankeyChart.prototype.getSeriesData=function(){return this.m_seriesData},SankeyChart.prototype.setSeriesColor=function(t){this.m_seriesColor=t},SankeyChart.prototype.getSeriesColor=function(){return this.m_seriesColor},SankeyChart.prototype.init=function(){this.setCategoryData(),this.setSubCategoryData(),this.setSeriesData(),this.initializeColor(),this.setSankeyData(),this.visibleSeriesInfo=this.getVisibleSeriesData(this.getSeriesData()),this.setColorsForSeries(),0!=this.getCategoryNames().length&&null!=this.getSubCategoryNames()[0]&&this.manageRepeatedSubCategory(),this.setAllFieldsName(),this.setAllFieldsDisplayName(),this.isSeriesDataEmpty(),this.setShowSeries(this.getAllFieldsName()),this.updateSeriesDataWithCommaSeperators(),this.visibleSeriesInfo=this.getVisibleSeriesData(this.getSeriesData()),this.createSVG(),this.initMouseClickEventForSVG(this.svgContainerId),this.m_chartFrame.init(this),this.m_title.init(this),this.m_subTitle.init(this),this.setFormatter(),this.setSecondaryFormatter(),this.initializeToolTipProperty(),this.m_tooltip.init(this)},SankeyChart.prototype.setSankeyData=function(){var n=this,r=n.m_categoryNames[0],s=n.m_subCategoryNames[0],o=n.m_seriesNames[0],e=(d=(d=n.m_dataProvider.map(function(t){var e=t[r],a=t[s];if(e&&a&&"null"!==e&&"null"!==a&&null!==e&&null!==a)return{source:e,target:a,value:n.countDecimalPlaces(parseFloat(t[o]))}})).filter(function(t){return null!=t}),new Set),l=(d.forEach(function(t){e.add(t.source),e.add(t.target)}),{}),h=(d.forEach(function(t){var e=t.source,t=t.target;l[t]||(l[t]=[]),l[t].push(e)}),{}),t=(new Set,e.forEach(function(t){h[t]=0}),e.forEach(function(a){var i;null==l[a]?d.forEach(function(t){t.source==a&&(h[a]+=t.value)}):l[i=a].forEach(function(e){d.forEach(function(t){t.target==i&&t.source==e&&(h[a]+=t.value)})})}),{});for(const _ in h)h.hasOwnProperty(_)&&(t[_]=parseFloat(n.countDecimalPlaces(h[_])));var a=Object.entries(t).map(function([t]){return t}),m=d.map(function(t){return t.target}),g=a.filter(function(t){return!m.includes(t)}),u=0,c=(g.forEach(function(a){Object.entries(t).map(function([t,e]){t==a&&(u+=e)})}),n.getFirstlevelNodes(t,d),u=parseFloat(n.countDecimalPlaces(u)),n.getCategoryColors().m_categoryColor),y=null!=this.getSubCategoryColors()?this.getSubCategoryColors().m_subcategoryColor:[],p=[];for(i=0;i<50;i++)p.push("#"+Math.floor(16777215*Math.random()).toString(16));var g=Object.entries(t).map(function([t,e]){var a,i=parseFloat(n.countDecimalPlaces(e/u*100).toString()),r=IsBoolean(n.m_showpercentvalue)?0<i?i+"%":"":e,s=IsBoolean(n.m_showrandomnodecolor)?n.getRandomHexColor():""==n.chartJson.Chart.Level.Colors?n.m_defaultcolor:"",o="",s=(""!=s&&(o={color:s,borderColor:s}),"");return 0<c.length&&(s=n.returnCategoryColor(c,t)),""!=(s=""==(s=0<y.length&&""!=(a=n.returnSubCategoryColor(y,t))?a:s)?n.getValueColorAlert(e):s)?{name:t,value:r,itemStyle:{color:s,borderColor:s},total:u,actvalue:e,percentage:i}:{name:t,value:r,itemStyle:o,total:u,actvalue:e,percentage:i}}),d=d.map(function(t){return{source:t.source,target:t.target,value:t.value,total:u,actvalue:t.value,percentage:parseFloat(n.countDecimalPlaces(t.value/u*100).toString())}}),a=(n.m_nullValue=d.some(function(t){return isNaN(t.value)||"null"===t.source||"null"===t.target}),n.m_sankeydata.nodes=g,n.m_sankeydata.links=d,n.m_nullValue=n.checkSameNodeName(n.m_sankeydata),n.m_sankeydata.nodes.map(function(t){return t.name})),m=n.m_sankeydata.links.map(function(t){return t.target}),g=a.filter(function(t){return!m.includes(t)}),a=(n.highestFirstWidth=this.calculateNodeWidth(g),n.m_sankeydata.nodes.map(function(t){return t.name})),m=n.m_sankeydata.links.map(function(t){return t.source}),g=a.filter(function(t){return!m.includes(t)});n.highestLastWidth=this.calculateNodeWidth(g)},SankeyChart.prototype.getValueColorAlert=function(value){var temp=this,seriesColors="",seriesColor=temp.getConditionalColors().m_ConditionalColor;if(null!=seriesColor&&null!==seriesColor&&""!==seriesColor&&0<seriesColor.length)for(var i=0;i<seriesColor.length;i++){var compareTo=parseFloat(seriesColor[i].m_compareto),operator="="==seriesColor[i].m_operator?"==":""+seriesColor[i].m_operator,compareTo,values;try{"=="!=operator&&"!="!=operator||!IsBoolean(isNaN(value))?"between"==operator?(compareTo=seriesColor[i].m_compareto,values=(""+compareTo).split("~"),result=value>=+values[0]&&value<=+values[1]):eval("result  = "+value+operator+compareTo):eval("result  = '"+value+"'"+operator+"'"+compareTo+"'")}catch(e){result=!1}IsBoolean(result)&&(seriesColors=convertColorToHex(seriesColor[i].m_color))}return seriesColors},SankeyChart.prototype.getRandomHexColor=function(){let e="#";for(let t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},SankeyChart.prototype.returnCategoryColor=function(t,e){var a="",i=this.firstLevelNodes;if(0<t.length)for(var r=0;r<t.length;r++){var s=i.includes(e);-1!==e.indexOf(t[r].m_categoryname)&&""!=t[r].m_categoryname&&s&&(a=t[r].m_color)}return a},SankeyChart.prototype.returnSubCategoryColor=function(t,e){var a="",i=this.firstLevelNodes;if(0<t.length)for(var r=0;r<t.length;r++){var s=i.includes(e);-1===e.indexOf(t[r].m_subcategoryname)||""==t[r].m_subcategoryname||s||(a=t[r].m_color)}return a},SankeyChart.prototype.calculateNumberOfLevels=function(t){var e=new Set,a=0,i=(t.forEach(function(t){e.add(t.source),e.add(t.target)}),{});return t.forEach(function(t){var e=(i[t.source]||1)+1;i[t.target]=e,a=Math.max(a,e)}),a},SankeyChart.prototype.getFirstlevelNodes=function(t,e){var t=Object.entries(t).map(function([t]){return t}),a=e.map(function(t){return t.target}),e=t.filter(function(t){return!a.includes(t)});this.firstLevelNodes=e},SankeyChart.prototype.countDecimalPlaces=function(t){var e,a,i;return isNaN(t)?0:(i=0,-1<(a=t.toString()).indexOf("e-")&&([e,a]=a.split("e-"),i=parseInt(a,10)),5<(i=Math.floor(t)!==t?t.toString().split(".")[1].length||0:i)?t.toFixed(5):t)},SankeyChart.prototype.calculateNodeWidth=function(t){var r=this,s=0,o={};return t.forEach(function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg"),a=(document.body.appendChild(t),document.createElementNS("http://www.w3.org/2000/svg","text")),i=(a.setAttribute("fill","black"),a.setAttribute("font-size",r.m_labelfontsize+"px"),a.setAttribute("font-family",r.m_labelfontfamily),a.setAttribute("font-weight",r.m_labelfontweight),r.m_sankeydata.nodes.find(t=>t.name===e)),i=(i?(o.value=i.value,o.name=e,i=r.getPrecisonData(o),a.textContent=i):a.textContent=e,t.appendChild(a),a.getBBox().width);s<i&&(s=i),document.body.removeChild(t)}),s},SankeyChart.prototype.manageRepeatedSubCategory=function(){for(var t,e={},a={},i={},r=0;r<this.m_categoryData[0].length;r++){null==e[this.m_categoryData[0][r]]&&(e[this.m_categoryData[0][r]]={},a[this.m_categoryData[0][r]]={},i[this.m_categoryData[0][r]]={}),null==e[this.m_categoryData[0][r]][this.m_subCategoryData[0][r]]&&(e[this.m_categoryData[0][r]][this.m_subCategoryData[0][r]]=[],a[this.m_categoryData[0][r]][this.m_subCategoryData[0][r]]=[],i[this.m_categoryData[0][r]][this.m_subCategoryData[0][r]]=[]);var s=[],o=[],n=[];this.setSeriesDataLabel();for(var l=0;l<this.m_seriesData.length;l++)s.push(this.m_seriesData[l][r]);for(l=0;l<this.m_seriesDataForDataLabel.length;l++)o.push(this.m_seriesDataForDataLabel[l][r]);for(l=0;l<this.m_seriesColorsArray.length;l++)n.push(this.m_seriesColorsArray[l][r]);e[this.m_categoryData[0][r]][this.m_subCategoryData[0][r]].push(s),a[this.m_categoryData[0][r]][this.m_subCategoryData[0][r]].push(o),i[this.m_categoryData[0][r]][this.m_subCategoryData[0][r]].push(n)}for(t in e)for(var h in e[t]){for(var m=[],g=[],u=[],c=0;c<e[t][h][0].length;c++){for(var y,p=[],d=[],_=[],r=0;r<e[t][h].length;r++)isNaN(e[t][h][r][c])?(y=removeCommaFromSrting(e[t][h][r][c]),p.push(""!==y?y:e[t][h][r][c])):p.push(e[t][h][r][c]),d.push(a[t][h][r][c]),_.push(i[t][h][r][c]);if(1===p.length)m.push(p[0]),g.push(d[0]);else{var f=getAggregationOperatedData(p,this.m_aggroperation);if(""===f)for(var b=0;b<p.length;b++)if(0==p[b]){f=0;break}m.push(f),g.push(getAggregationOperatedData(d,this.m_aggroperation))}u.push(_[0])}e[t][h]=m,a[t][h]=g,i[t][h]=u}for(t in this.m_categoryData[0]=[],this.m_subCategoryData[0]=[],this.m_seriesData=[],this.m_seriesDataForDataLabel=[],this.m_seriesColorsArray=[],e)for(var h in e[t])for(r=0;r<e[t][h].length;r++)this.m_seriesData[r]=[],this.m_seriesDataForDataLabel[r]=[],this.m_seriesColorsArray[r]=[];for(t in e)for(var h in e[t]){this.m_categoryData[0].push(t),this.m_subCategoryData[0].push(h);for(r=0;r<e[t][h].length;r++)this.m_seriesData[r].push(e[t][h][r]),this.m_seriesDataForDataLabel[r].push(a[t][h][r]),this.m_seriesColorsArray[r].push(i[t][h][r])}},SankeyChart.prototype.updateSeriesDataWithCommaSeperators=function(){this.m_displaySeriesDataFlag=[];for(var t=0;t<this.m_seriesData.length;t++){this.m_displaySeriesDataFlag[t]=[];for(var e=0;e<this.m_seriesData[t].length;e++)this.m_displaySeriesDataFlag[t][e]=!0,isNaN(this.m_seriesData[t][e])&&(this.m_displaySeriesDataFlag[t][e]=!1,this.m_seriesData[t][e]=getNumericComparableValue(this.m_seriesData[t][e]))}},SankeyChart.prototype.drawChart=function(){this.drawChartFrame(),this.drawTitle(),this.drawSubTitle(),this.drawLegends();var t=this.IsDrawingPossible();$("#chart_container"+this.m_objectid).remove(),IsBoolean(t.permission)?IsBoolean(this.isEmptyCategory)&&IsBoolean(this.isEmptySubCategory)?this.drawSVGMessage("No Visible Category OR SubCategory Field Available"):IsBoolean(this.m_isEmptySeries)?this.drawSVGMessage(this.m_status.noData):IsBoolean(this.isVisibleSeries())?IsBoolean(this.m_nullValue)?this.drawSVGMessage("Invalid Sankey Data"):(this.drawConatiner(),this.setSVGDimension(),this.drawSankeyChart()):this.drawSVGMessage("No visible Series Available"):this.drawSVGMessage(t.message)},SankeyChart.prototype.drawConatiner=function(){var t=this,e=($("#chart_container"+t.m_objectid).remove(),document.createElement("div"));e.setAttribute("id","chart_container"+t.m_objectid),e.onclick=function(){t.getDataPointAndUpdateGlobalVariable()},$("#draggableDiv"+t.m_objectid).append(e)},SankeyChart.prototype.setSVGDimension=function(){var t=this.m_subTitle.m_titleMargin+(IsBoolean(this.m_subTitle.m_showsubtitle)?null!=this.m_subTitle.m_subtitleText?+this.m_subTitle.m_subtitleText.getBBox().height:+this.m_subTitle.m_subTitleBarHeight:0);$("#"+this.svgContainerId).css("height",this.m_height+"px"),$("#GradientRect"+this.m_objectid).css("height",this.m_height+"px"),$("#chart_container"+this.m_objectid).css("top",t+5+"px"),$("#chart_container"+this.m_objectid).css("height",this.m_height-t+"px"),$("#chart_container"+this.m_objectid).css("width",this.m_width+"px"),$("#chart_container"+this.m_objectid).css("position","absolute")},SankeyChart.prototype.initializeColor=function(){if(this.m_color=[],IsBoolean(this.m_showrandomnodecolor))for(t=this.m_cloudgradients.split(","),e=0;e<t.length;e++)null!=t[e]?this.m_color[e]=convertColorToHex(t[e]):this.m_color[e]=this.m_color[e-1];else for(var t=this.m_colors.split(","),e=0;e<t.length;e++)null!=t[e]?this.m_color[e]=convertColorToHex(t[e]):this.m_color[e]=this.m_color[e-1]},SankeyChart.prototype.checkSameNodeName=function(t){for(var e=0;e<t.links.length;e++){var a=t.links[e],i=a.source,a=a.target;if(i&&a&&i===a)return!0}return!1},SankeyChart.prototype.drawSankeyChart=function(){var a=this,t=document.getElementById("chart_container"+a.m_objectid),t=echarts.init(t,null,{renderer:"svg"}),e=a.m_sankeydata,i=[],r=a.calculateNumberOfLevels(a.m_sankeydata.links);if(!IsBoolean(a.m_showrandomnodecolor))for(var s=a.chartJson.Chart.Level.Colors.split(","),o=0;o<s.length;o++)""!=s[o]&&i.push({depth:o,itemStyle:{color:s[o]}});for(var o=0;o<r;o++)0<i.length&&null==i[o]&&i.push({depth:o,itemStyle:{color:a.m_defaultcolor}});switch(t.showLoading(),a.m_textalign){case"left":var n=a.highestFirstWidth+10+"px",l="0";break;case"top":case"bottom":n=a.highestFirstWidth/2+"px",l=a.highestLastWidth/2+"px";break;default:n="0",l=a.highestLastWidth+10+"px"}e={tooltip:{show:IsBoolean("None"!=a.m_customtextboxfortooltip.dataTipType),responsive:!0,trigger:"item",formatter:function(t){var e=a.getToolTipData(t,t.dataIndex);return null!=t.data.source?a.drawEdgeChartToolTip(e):a.drawNodeChartToolTip(e)},borderColor:a.m_tooltipbordercolor,borderWidth:2,padding:0,textStyle:{fontSize:a.m_tooltipfontsize,color:a.m_tooltipfontcolor,fontStyle:a.m_tooltipfontstyle,fontWeight:a.m_tooltipfontweight,fontFamily:a.m_tooltipfontfamily}},animation:a.m_enableanimation,textStyle:{fontFamily:a.m_labelfontfamily,fontSize:Number(a.m_labelfontsize),fontStyle:a.m_labelfontstyle,fontWeight:a.m_labelfontweight,color:a.m_labelfontcolor},series:[{type:"sankey",data:e.nodes,links:e.links,left:n,right:l,emphasis:{focus:a.m_highlightpathstyle},nodeGap:parseFloat(a.m_nodegap),levels:i,nodeAlign:"left",lineStyle:{color:a.m_linestyle,curveness:.5,opacity:parseFloat(a.m_lineopacity)},label:{formatter:function(t){return a.getPrecisonData(t)},position:a.m_textalign,textStyle:{fontFamily:a.m_labelfontfamily,fontSize:Number(a.m_labelfontsize),fontStyle:a.m_labelfontstyle,fontWeight:a.m_labelfontweight,color:a.m_labelfontcolor}}}]};try{t.setOption(e)}catch(t){}"object"==typeof e&&(t.setOption(e),t.hideLoading())},SankeyChart.prototype.drawLine=function(t,e,a,i){t=drawSVGLine(t,e,a,i,"0.5",hex2rgb(this.m_markercolor,this.m_markertransparency));$("#horizontallinegrp"+this.m_objectid).append(t)},SankeyChart.prototype.initCanvas=function(){$("#draggableDiv"+this.m_objectid).remove(),this.initializeDraggableDivAndCanvas()},SankeyChart.prototype.initializeDraggableDivAndCanvas=function(){this.setDashboardNameAndObjectId(),this.m_draggableDiv=this.createDraggableDiv(this.m_chartContainer,this.m_zIndex),this.createDraggableCanvas(this.m_draggableDiv),this.setCanvasContext(),this.createSVG(),$("#draggableCanvas"+this.m_objectid).hide(),this.initMouseMoveEvent(this.m_chartContainer),this.initMouseClickEventForSVG(this.svgContainerId)},SankeyChart.prototype.createSVG=function(){this.svgContainerId="svgContainer"+this.m_objectid,$("#"+this.svgContainerId).remove();var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("xlink","http://www.w3.org/1999/xlink"),t.setAttribute("width",this.m_width),t.setAttribute("height",this.m_height),t.setAttribute("id",this.svgContainerId),$("#draggableDiv"+this.m_objectid).append(t)},SankeyChart.prototype.initializeCalculation=function(){var t=this.updateSeriesData(this.visibleSeriesInfo.seriesData),e=this.updateSeriesData(this.m_categoryData),a=this.updateSeriesData(this.m_subCategoryData);if(this.calculateMinimumMaximum(t),this.setChartDrawingArea(),this.dataMap={},IsBoolean(this.isEmptyCategory)&&!IsBoolean(this.isEmptySubCategory))this.m_calculation.init(this,a,this.visibleSeriesInfo.seriesData,this.dataMap);else if(!IsBoolean(this.isEmptyCategory)&&IsBoolean(this.isEmptySubCategory))this.m_calculation.init(this,e,this.visibleSeriesInfo.seriesData,this.dataMap);else{for(var i=0;i<e.length;i++)null==this.dataMap[e[i][0]]&&(this.dataMap[e[i][0]]={}),this.dataMap[e[i][0]][a[i][0]]=t[i];this.m_calculation.init(this,a,this.visibleSeriesInfo.seriesData,this.dataMap)}this.m_xPositionArray=this.m_calculation.getXPositionArray(),this.m_yPositionArray=this.m_calculation.getYPositionArray(),this.m_barWidth=this.m_calculation.getbarWidth(),this.m_noofseries=this.m_calculation.xAxisData.length,this.m_barGap=this.m_calculation.getBarGap(),this.m_barWidthArray=this.m_calculation.getstackHeightArray(),IsBoolean(this.getCounterFlagForSeriesVisiblity())&&IsBoolean(this.m_showmarkingorpercentvalue)?(this.m_percentageArray=!IsBoolean(this.m_showpercentvalue)||IsBoolean(this.getCheckedAllPosContainigZero())?this.getPercentage():this.getRoundValue(this.getPercentage(),100),this.m_showPerCentageFlag=!0):(this.m_percentageArray=this.getArrayWhenPercentFlagIsFalse(),this.m_seriesInitializeFlag=!1),this.initializeBars(),this.initializeDataLabel()},SankeyChart.prototype.calculateMinimumMaximum=function(t){var t="clustered"==this.m_charttype.toLowerCase()||"stacked"==this.m_charttype.toLowerCase()&&1===t[0].length?this.calculateMinMaxValue(t):this.calculateFinalMinMaxValue(t),e=t.min,t=t.max,e=this.getCalculateNiceScale(e,t,this.m_basezero,this.m_autoaxissetup,this.m_minimumaxisvalue,this.m_maximumaxisvalue,this.m_height);this.min=e.min,this.max=e.max,this.m_numberOfMarkers=e.markerArray.length,this.m_yAxisText=e.step,this.m_yAxisMarkersArray=e.markerArray},SankeyChart.prototype.calculateFinalMinMaxValue=function(t){var e=isNaN(+t[0][0])?0:+t[0][0],a=isNaN(+t[0][0])?0:+t[0][0];if("100%"==this.m_charttype){for(var i=!1,r=0,s=t.length;r<s;r++)for(var o=0,n=t[r].length;o<n;o++)if(t[r][o]<0){i=!0;break}e=100,a=IsBoolean(i)?-100:0}else for(r=0,s=t.length;r<s;r++){for(var l=0,h=0,m=t[r].length,o=0;o<m;o++)isNaN(+t[r][o])||(0<+t[r][o]?l=+l+ +t[r][o]:h=+t[r][o]+ +h);e<=l&&(e=+l),+h<a&&(a=+h)}return{max:e,min:a}},SankeyChart.prototype.calculateCategoryBoxSize=function(){var t={},e=this.getEndX()-this.m_barGap/2,a=Object.keys(this.dataMap).length-1;for(Object.keys(this.dataMap)[a]in this.dataMap){var i,r=0;for(i in this.dataMap[Object.keys(this.dataMap)[a]])r++;IsBoolean(this.m_mergesubcategory)&&null!=this.m_categoryNames[0]?e=e-r*this.m_barWidth-this.m_barGap/2:e-=r*this.m_barWidth+this.m_barGap*r-this.m_barGap/2,t[Object.keys(this.dataMap)[a]]=e,e-=this.m_barGap/2,a--}return t},SankeyChart.prototype.getCheckedAllPosContainigZero=function(){for(var t=!0,e=0;e<this.m_seriesData[this.m_seriesVisiblityPosition].length;e++)0!=this.m_seriesData[this.m_seriesVisiblityPosition][e]&&(t=!1);return t},SankeyChart.prototype.getArrayWhenPercentFlagIsFalse=function(){for(var t=[],e=0;e<this.m_seriesData.length;e++)t[e]=0;return t},SankeyChart.prototype.getPercentage=function(){for(var t=[],e=this.getSumOfSeriesData(),a=0;a<this.m_seriesData[this.m_seriesVisiblityPosition].length;a++)IsBoolean(this.m_showpercentvalue)?(0<this.m_seriesData[this.m_seriesVisiblityPosition][a]?t[a]=this.m_seriesData[this.m_seriesVisiblityPosition][a]/e*100:t[a]=0,this.m_showPercentValueFlag=!0):t[a]=this.m_seriesData[this.m_seriesVisiblityPosition][a];return t},SankeyChart.prototype.getSumOfSeriesData=function(){for(var t=0,e=0;e<this.m_seriesData[this.m_seriesVisiblityPosition].length;e++)"NaN"==this.m_seriesData[this.m_seriesVisiblityPosition][e]&&(this.m_seriesData[this.m_seriesVisiblityPosition][e]=0),0<this.m_seriesData[this.m_seriesVisiblityPosition][e]&&(t=+t+ +this.m_seriesData[this.m_seriesVisiblityPosition][e]);return t},SankeyChart.prototype.initializeBars=function(){this.m_barSeriesArray={};for(var t=0;t<this.visibleSeriesInfo.seriesName.length;t++){this.m_barSeriesArray[this.visibleSeriesInfo.seriesName[t]]=new GroupColumnSeries;var e="clustered"==this.m_charttype?this.m_barWidth/this.visibleSeriesInfo.seriesName.length:this.m_barWidth;"clustered"==this.m_charttype&&(e*=this.clusteredbarpadding),this.m_barSeriesArray[this.visibleSeriesInfo.seriesName[t]].init(this.m_xPositionArray[t],this.m_yPositionArray[t],e,this.m_barWidthArray[t],this.m_percentageArray,this.getColorsForSeries()[t],this.m_strokecolor,this.m_showmarkingorpercentvalue,this.m_showPercentValueFlag,this.m_seriesInitializeFlag,this.m_plotTrasparencyArray[t],this)}},SankeyChart.prototype.initializeDataLabel=function(){this.m_valueTextSeries={},0!=this.getCategoryNames().length&&null!=this.getSubCategoryNames()[0]||(this.m_seriesDataForDataLabel=[]),void 0!==this.m_seriesDataForDataLabel.length&&!IsBoolean(this.isEmptySubCategory)&&0!==this.m_seriesDataForDataLabel.length||this.setSeriesDataLabel();for(var t,e,a=0,i=0;i<this.m_seriesNames.length;i++)IsBoolean(this.m_seriesVisibleArr[this.m_seriesNames[i]])&&(IsBoolean(this.m_seriesDataLabelProperty[i].showDataLabel)&&(t="100%"==this.m_charttype&&void 0!==this.m_seriesDataLabelProperty[a].showPercentValue&&IsBoolean(this.m_seriesDataLabelProperty[a].showPercentValue)?(this.m_seriesDataForDataLabel[a]=this.getPercentageForHundred()[a],a):i,e="clustered"==this.m_charttype?this.m_barWidth/this.visibleSeriesInfo.seriesName.length:this.m_barWidth,this.m_valueTextSeries[this.m_seriesNames[i]]=new SVGValueTextSeries,this.m_valueTextSeries[this.m_seriesNames[i]].init(this.m_xPositionArray[a],this.m_yPositionArray[a],this,this.m_seriesDataForDataLabel[t],this.m_seriesDataLabelProperty[i],this.m_seriesData[i],e,this.m_barWidthArray[a],"column")),a++)},SankeyChart.prototype.setSeriesDataLabel=function(){this.m_seriesDataForDataLabel=[];for(var t=0,e=this.getDataProvider().length;t<e;t++)for(var a=this.getDataProvider()[t],i=0,r=this.getSeriesNames().length;i<r;i++){this.m_seriesDataForDataLabel[i]||(this.m_seriesDataForDataLabel[i]=[]);var s=this.getValidFieldDataFromRecord(a,this.m_seriesDataLabelProperty[i].datalabelField);this.m_seriesDataForDataLabel[i][t]=s}},SankeyChart.prototype.getColorsForSeries=function(){return this.m_seriesColorsArray},SankeyChart.prototype.setColorsForSeries=function(){for(var t=!0,e=0;e<this.m_categoryData.length&&t;e++)t=Array.isArray(this.m_categoryData[e])&&0===this.m_categoryData[e].length;if(this.m_seriesColorsArray=[],IsBoolean(this.m_enablecolorfromdrill)&&IsBoolean(this.m_startDrill))for(e=0;e<this.visibleSeriesInfo.seriesData.length;e++){this.m_seriesColorsArray[e]=[];for(var a=0;a<this.visibleSeriesInfo.seriesData[e].length;a++)this.m_seriesColorsArray[e][a]=this.m_drillColor}else if(!IsBoolean(this.m_designMode)&&null!=this.getCategoryColors()&&""!=this.getCategoryColors()&&0<this.getCategoryColors().getCategoryColor().length&&IsBoolean(this.getCategoryColors().getshowColorsFromCategoryName())&&0<this.m_categoryJSON.length){var i=[];i=0<this.m_subCategoryNames.length&&0==this.m_categoryNames.length?this.getCategoryColors().getCategoryColorsForCategoryNames(this.getSubCategoryData()[0],this.m_categoryFieldColor):this.getCategoryColors().getCategoryColorsForCategoryNames(this.getCategoryData()[0],this.m_categoryFieldColor);for(e=0;e<this.visibleSeriesInfo.seriesData.length;e++){this.m_seriesColorsArray[e]=[];for(a=0;a<this.visibleSeriesInfo.seriesData[e].length;a++)this.m_seriesColorsArray[e][a]=i[a]}}else if(!IsBoolean(this.m_designMode)&&null!=this.getSubCategoryColors()&&""!=this.getSubCategoryColors()&&0<this.getSubCategoryColors().getSubCategoryColor().length&&IsBoolean(this.getSubCategoryColors().getshowColorsFromSubCategoryName())&&0<this.m_subCategoryJSON.length)for(i=this.getSubCategoryColors().getSubCategoryColorsForSubCategoryNames(this.getSubCategoryData()[0],this.m_categoryFieldColor),e=0;e<this.visibleSeriesInfo.seriesData.length;e++){this.m_seriesColorsArray[e]=[];for(a=0;a<this.visibleSeriesInfo.seriesData[e].length;a++)this.m_seriesColorsArray[e][a]=i[a]}else if(IsBoolean(this.m_designMode)||""==this.getCategoryColors()||IsBoolean(this.getCategoryColors().getshowColorsFromCategoryName())&&0!=this.getCategoryColors().getCategoryColor().length||""==this.getConditionalColors()||null==this.getConditionalColors()||!(0<this.getConditionalColors().getConditionalColor().length)||IsBoolean(t))for(var r=this.visibleSeriesInfo.seriesColor,e=0;e<this.visibleSeriesInfo.seriesData.length;e++){this.m_seriesColorsArray[e]=[];for(a=0;a<this.visibleSeriesInfo.seriesData[e].length;a++)this.m_seriesColorsArray[e][a]=r[e]}else for(var s=this.getConditionalColors().getConditionalColorsForConditions(this.visibleSeriesInfo.seriesName,this.visibleSeriesInfo.seriesColor,this.visibleSeriesInfo.seriesData,this),e=0;e<this.visibleSeriesInfo.seriesData.length;e++){this.m_seriesColorsArray[e]=[];for(var a=0;a<this.visibleSeriesInfo.seriesData[e].length;a++)this.m_seriesColorsArray[e][a]=s[e][a]}},SankeyChart.prototype.updateSeriesData=function(t){var e=[];if(null!=t&&null!==t&&""!==t&&0!=t.length)for(var a=0;a<t[0].length;a++){e[a]=[];for(var i=0;i<t.length;i++)e[a][i]=t[i][a]}return e},SankeyChart.prototype.drawTitle=function(){this.m_title.draw()},SankeyChart.prototype.drawSubTitle=function(){this.m_subTitle.draw()},SankeyChart.prototype.drawXAxis=function(){this.createHorizontalLineGroup("horizontallinegrp"),IsBoolean(this.m_showverticalmarkerline)&&this.drawPartitionLine(),IsBoolean(this.m_showcatpartitioner)&&this.drawCategoryPartitionLine(),this.createXAxisMarkerLabelGroup("xaxislabelgrp"),this.createXAxisCategoryMarkerLabelGroup("xaxiscategorylabelgrp"),this.createXAxisSubCategoryMarkerLabelGroup("xaxissubcategorylabelgrp"),this.drawHorizontalPartLine(),this.m_xAxis.markXaxis(),this.m_xAxis.drawXAxis(),this.m_xAxis.drawSubCategory(),this.m_xAxis.drawCategory()},SankeyChart.prototype.drawHorizontalPartLine=function(){var t=this.getStartY()+this.getSubCatTextMargin()+10;this.drawLine(this.getStartX(),t,this.getEndX(),t)},SankeyChart.prototype.createXAxisCategoryMarkerLabelGroup=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","g");e.setAttribute("id",t+this.m_objectid),e.setAttribute("class",t),$(e).css({"font-family":selectGlobalFont(this.m_xAxis.getLabelFontFamily()),"font-style":this.m_xAxis.getLabelFontStyle(),"font-size":this.fontScaling(this.m_xAxis.getLabelFontSize())+"px","font-weight":this.m_xAxis.getLabelFontWeight(),"text-decoration":this.m_xAxis.getLabelTextDecoration()}),$("#"+this.svgContainerId).append(e)},SankeyChart.prototype.createXAxisSubCategoryMarkerLabelGroup=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","g");e.setAttribute("id",t+this.m_objectid),e.setAttribute("class",t),$(e).css({"font-family":selectGlobalFont(this.m_xAxis.getLabelFontFamily()),"font-style":this.m_xAxis.getLabelFontStyle(),"font-size":this.fontScaling(this.m_xAxis.m_subcategoryfontsize)+"px","font-weight":this.m_xAxis.getLabelFontWeight(),"text-decoration":this.m_xAxis.getLabelTextDecoration()}),$("#"+this.svgContainerId).append(e)},SankeyChart.prototype.drawCategoryPartitionLine=function(){var t,e=this.getStartY()+this.getSubCatTextMargin()+this.m_yAxis.m_axislinetotextgap,e="left"==this.m_subcategoryorientation?this.getStartY()+this.getCatTextMargin()+this.getSubCatTextMargin()+this.m_yAxis.m_axislinetotextgap:this.getStartY()+this.getCatTextMargin()+this.m_yAxis.m_axislinetotextgap,a=this.calculateCategoryBoxSize();for(t in a)this.drawLine(a[t],+this.getStartY(),a[t],e)},SankeyChart.prototype.drawPartitionLine=function(){var t,e=this.getStartX(),a=(this.drawLine(e,+this.getStartY()+1,+this.getEndX()-1,+this.getStartY()+1),this.calculateCategoryBoxSize());for(t in a)this.drawLine(a[t],+this.getStartY(),a[t],+this.getEndY())},SankeyChart.prototype.drawYAxis=function(){IsBoolean(this.m_showhorizontalmarkerline)&&this.m_yAxis.horizontalMarkerLines(),IsBoolean(this.m_zeromarkerline)&&!IsBoolean(this.m_basezero)&&IsBoolean(this.m_yAxis.hasNegativeAxisMarker(this.m_yAxisMarkersArray))&&this.m_yAxis.zeroMarkerLine(),this.createYAxisMarkerLabelGroup("yaxislabelgrp"),this.m_yAxis.drawYAxis(),this.m_yAxis.markYaxis()},SankeyChart.prototype.drawVerticalPartLine=function(){var t=this.getStartX()-this.getSubCatTextMargin();this.drawLine(t,this.getStartY(),t,this.getEndY())},SankeyChart.prototype.drawChartFrame=function(){this.m_chartFrame.drawSVGFrame(),this.getBGGradientColorToContainer()},SankeyChart.prototype.getBGGradientColorToContainer=function(){var t=document.createElementNS("http://www.w3.org/2000/svg","defs"),e=document.createElementNS(NS,"filter"),a=(e.setAttribute("id","stackShadow"+this.m_objectid),document.createElementNS(NS,"feOffset")),i=(a.setAttribute("dx","0"),a.setAttribute("dy","0"),a.setAttribute("result","offOut"),a.setAttribute("in","SourceGraphic"),document.createElementNS(NS,"feGaussianBlur")),r=(i.setAttribute("result","blurOut"),i.setAttribute("in","offOut"),i.setAttribute("stdDeviation","1"),document.createElementNS(NS,"feColorMatrix")),s=(r.setAttribute("in","blurOut"),r.setAttribute("result","color-out"),r.setAttribute("type","matrix"),r.setAttribute("values",hex2Matrix(this.m_stackshadowcolor,this.m_stackshadowopacity)),document.createElementNS(NS,"feBlend"));s.setAttribute("in","SourceGraphic"),s.setAttribute("in2","color-out"),s.setAttribute("mode","normal"),e.appendChild(a),e.appendChild(i),e.appendChild(r),e.appendChild(s),t.appendChild(e),$("#"+this.svgContainerId).append(t)},SankeyChart.prototype.drawObject=function(){this.drawSVGObject()},SankeyChart.prototype.drawDataLabel=function(){this.m_overlappeddatalabelarrayX=[],this.m_overlappeddatalabelarrayY=[];for(var t,e=0,a=this.m_seriesNames.length;e<a;e++)IsBoolean(this.m_seriesVisibleArr[this.m_seriesNames[e]])&&(t=this.m_valueTextSeries[this.m_seriesNames[e]],IsBoolean(this.m_seriesDataLabelProperty[e].showDataLabel))&&(this.createDataLabelGroup(t,"datalabelgrp",e,this.m_seriesNames[e]),this.m_valueTextSeries[this.m_seriesNames[e]].drawSVGValueTextSeries())},SankeyChart.prototype.getArraySUM=function(t){for(var e=0,a=0;a<t.length;a++)t[a]<0&&(t[a]=-1*t[a]),isNaN(t[a])||(e=+e+ +t[a]);return e},SankeyChart.prototype.getUpdateSeriesDataWithCategory=function(t){for(var e=[],a=0;a<t[0].length;a++){e[a]=[];for(var i=0;i<t.length;i++)e[a][i]=t[i][a]}return e},SankeyChart.prototype.setPercentageForHundred=function(){for(var t=this.getUpdateSeriesDataWithCategory(this.visibleSeriesInfo.seriesData),e=(this.m_SeriesDataInPerForHundredChart,[]),a=0;a<t.length;a++){var i=this.getArraySUM(t[a]);e[a]=[];for(var r=0;r<t[a].length;r++)""===t[a][r]||isNaN(t[a][r])?e[a][r]=0:e[a][r]=t[a][r]/i*100}0<e.length&&(this.m_SeriesDataInPerForHundredChart=this.getUpdateSeriesDataForHundredPercentageChart(e))},SankeyChart.prototype.getPercentageForHundred=function(){return this.m_SeriesDataInPerForHundredChart},SankeyChart.prototype.getUpdateSeriesDataForHundredPercentageChart=function(t){for(var e=[],a=0,i=t[0].length;a<i;a++){e[a]=[];for(var r=0,s=t.length;r<s;r++)e[a][r]=t[r][a]}for(a=0,i=this.visibleSeriesInfo.seriesData.length;a<i;a++)for(r=0,s=this.visibleSeriesInfo.seriesData[a].length;r<s;r++)isNaN(this.visibleSeriesInfo.seriesData[a][r])||+this.visibleSeriesInfo.seriesData[a][r]<0&&(e[a][r]=-1*e[a][r]);return e},SankeyChart.prototype.getDrillColor=function(t,e){if(!IsBoolean(this.m_isEmptySeries)&&t>=this.getStartX()&&t<=this.getEndX()&&e<=this.getStartY()&&e>=this.getEndY())for(var a="stacked"==this.m_charttype?0:this.m_drillminstackheight,i=0;i<this.m_xPositionArray.length;i++)for(var r,s,o,n=0;n<=this.m_xPositionArray[i].length;n++)if(o=+this.m_barWidthArray[i][n]<0?(r=+this.m_barWidthArray[i][n]<-a?+this.m_barWidthArray[i][n]:-a,s=+this.m_yPositionArray[i][n],+this.m_yPositionArray[i][n]-r):(r=IsBoolean(this.m_basezero)&&+this.visibleSeriesInfo.seriesData[i][n]<0?0:+this.m_barWidthArray[i][n]>a?+this.m_barWidthArray[i][n]:a,s=+this.m_yPositionArray[i][n],+this.m_yPositionArray[i][n]+r),"clustered"==this.m_charttype){if(s<=e&&e<=o&&t>=+this.m_xPositionArray[i][n]&&t<=+this.m_xPositionArray[i][n]+ +this.m_barWidth/this.m_xPositionArray.length)return i}else if(s<=e&&e<=o&&t>=+this.m_xPositionArray[i][n]&&t<=+this.m_xPositionArray[i][n]+ +this.m_barWidth)return i},SankeyChart.prototype.drawTooltip=function(t,e){var a;IsBoolean(this.m_isEmptySeries)||this.m_designMode||(a=this.getToolTipData(t,e),this.m_hovercallback&&""!=this.m_hovercallback?this.drawCallBackContent(t,e,a):this.drawTooltipContent(a))},SankeyChart.prototype.drawTooltipContent=function(t){this.m_tooltip.draw(t,this.m_componenttype)},SankeyChart.prototype.getDrillDataPoints=function(t,e){if(!IsBoolean(this.m_isEmptySeries)&&IsBoolean(this.isVisibleSeries())&&t>=this.getStartX()&&t<=this.getEndX()&&e<=this.getStartY()&&e>=this.getEndY()){for(var a=!1,i="stacked"==this.m_charttype?0:this.m_drillminstackheight,r=0;r<this.m_xPositionArray.length;r++)for(var s,o,n,l=0;l<this.m_xPositionArray[r].length;l++)if(n=+this.m_barWidthArray[r][l]<0?(s=+this.m_barWidthArray[r][l]<-i?+this.m_barWidthArray[r][l]:-i,o=+this.m_yPositionArray[r][l]+s,+this.m_yPositionArray[r][l]):(s=IsBoolean(this.m_basezero)&&+this.visibleSeriesInfo.seriesData[r][l]<0?0:+this.m_barWidthArray[r][l]>i?+this.m_barWidthArray[r][l]:i,o=+this.m_yPositionArray[r][l],+this.m_yPositionArray[r][l]+s),o<=e&&e<=n&&t>=+this.m_xPositionArray[r][l]&&t<=+this.m_xPositionArray[r][l]+ +this.m_barWidth)return g=this.getFieldNameValueMap(l),u=this.getColorsForSeries()[r][l],c=this.visibleSeriesInfo.seriesName[r],y=this.visibleSeriesInfo.seriesDisplayName[r],p=g[c],g.drillField=c,g.drillDisplayField=y,g.drillValue=p,a=!0,g.drillIndex=l,{drillRecord:g,drillColor:u};if("stacked"==this.m_charttype&&!a)for(var h=0,m=this.xPositions.length;h<m;h++)if(e<=+this.xPositions[h]+ +this.m_barWidth&&e>=+this.xPositions[h])for(var g,u,c,y,p,d=0,_=this.m_xPositionArray.length;d<_;d++)if(t>=this.m_xPositionArray[d][h]&&t<=this.m_xPositionArray[d][h]+this.m_drillminstackheight||t<=this.m_xPositionArray[d][h]+this.m_barWidthArray[d][h]&&t>=this.m_xPositionArray[d][h]-this.m_drillminstackheight)return g=this.getFieldNameValueMap(h),u=this.m_drillColor,p=y=c="",g.drillField=c,g.drillDisplayField=y,g.drillValue=p,a=!0,g.drillIndex=l,{drillRecord:g,drillColor:u}}},SankeyChart.prototype.getDataPointAndUpdateGlobalVariable=function(){var t={};t[""===this.m_fieldname||void 0===this.m_fieldname?"Value":this.m_fieldname]=this.m_fieldvalue,this.updateDataPoints(t)};
//# sourceMappingURL=SankeyChart.min.js.map