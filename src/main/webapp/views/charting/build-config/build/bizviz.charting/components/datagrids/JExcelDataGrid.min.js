/*! BDB Charting Library V10.0.0 (2025-08-14 11:37:12) 
 Copyright 2015-2024 BDB (BizViz Technologies Pvt Ltd). All Rights Reserved */
function JExcelDataGrid(e,t){this.base=DataGrid,this.base(),this.m_x=10,this.m_y=600,this.m_width=500,this.m_height=285,this.m_columnHeaderDataMap=new Object,this.m_objectID=[],this.m_componentid="",this.ctx="",this.m_chartContainer=e,this.m_zIndex=t,this.m_maxrow=10,this.m_aggregatedRow=[],this.m_iseditable=!0,this.m_enablecellupdatesave=!1,this.m_allowinsertrow=!1,this.m_enablelazyloading=!1,this.m_freezecolumn=!1,this.m_pagination=!1}JExcelDataGrid.prototype=new DataGrid,JExcelDataGrid.prototype.setProperty=function(e){this.ParseJsonAttributes(e.Object,this),this.initCanvas()},JExcelDataGrid.prototype.ParseJsonAttributes=function(e,t){for(var i in this.chartJson=e)if("DataGrid"==i)for(var o in e[i])switch(o){case"Title":for(var a in e[i][o]){var r=this.getNodeAttributeName(a);t.m_title[r]=e[i][o][a]}break;case"SubTitle":for(var s in e[i][o]){var r=this.getNodeAttributeName(s);t.m_subTitle[r]=e[i][o][s]}break;case"LinkButton":for(var n in e[i][o]){var r=this.getNodeAttributeName(n);t.m_linkbutton[r]=e[i][o][n]}break;case"Column":for(var l in e[i][o]){r=this.getNodeAttributeName(l);t.m_column[r]=e[i][o][l]}break;case"DatagridStyles":for(var m in e[i][o]){r=this.getNodeAttributeName(m);t.m_datagridstyles[r]=e[i][o][m]}break;case"RowData":for(var d in e[i][o]){r=this.getNodeAttributeName(d);t.m_rowdata[r]=e[i][o][d]}break;case"LinkBar":for(var h in e[i][o]){r=this.getNodeAttributeName(h);t.m_linkbar[r]=e[i][o][h]}break;case"Alerts":for(var c in e[i][o])if("AlertColumn"==c)for(var c=e[i][o],p=this.getArrayOfSingleLengthJson(c.AlertColumn),u=0;u<p.length;u++){var g,_=new AlertColumn,f=(t.m_alerts.setAlertColumns(_),this.getProperAttributeNameValue(p[u],"name"));for(g in this.m_alertObj[f]=_,p[u])this.setAttributeValueToNode(g,p[u],_)}break;default:"m_title"!=(r=this.getNodeAttributeName(o))&&(t[r]=e[i][o])}else t[r=this.getNodeAttributeName(i)]=e[i]},JExcelDataGrid.prototype.getDataProvider=function(){return this.m_dataProvider},JExcelDataGrid.prototype.setFields=function(e){this.m_fieldsJson=e,this.setSeries(e)},JExcelDataGrid.prototype.setSeries=function(e){this.fieldsData=e,this.m_seriesVisibleArr={},this.m_fieldName=[],this.m_colHeadersFieldName=[],this.m_gridheaderDisplayNames=[],this.m_visibleArr=[],this.m_widthArr=[],this.m_textAlignArr=[],this.m_frozenColumnsArr=[],this.m_sortingColumnsArr=[],this.m_numberFormatColumnsArr=[],this.m_cellTypeArr=[],this.m_tooltipColumnsArr=[],this.m_isNumericArr=[],this.m_isFixedLabelArr=[],this.m_formatterArr=[],this.m_unitNameArr=[],this.m_signPositioneArr=[],this.m_precisionArr={},this.m_secondFormatterArr=[],this.m_secondUnitNameArr=[],this.m_plotShapeArray=[],this.m_fieldColors=[],this.visibleFieldsData=[],this.m_isNumericArrMap={},this.m_isNumericArrMapForSorting={},this.legendMap={},this.m_TooltipFieldsArr={},this.m_rowaggrgationArr={},this.m_freezeColumnsArr=[];for(var t=0,i=0,o=e.length;i<o;i++){var a,r,s=this.getProperAttributeNameValue(e[i],"fieldname"),n=this.getProperAttributeNameValue(e[i],"visible");this.m_fieldName[t]=s,this.m_seriesVisibleArr[this.m_fieldName[t]]=n,IsBoolean(n)&&(this.m_colHeadersFieldName[t]=s,r=this.formattedDescription(this,this.getProperAttributeNameValue(e[i],"displayname")),this.m_gridheaderDisplayNames[t]=r,this.m_visibleArr[t]=n,this.m_widthArr[t]=this.getProperAttributeNameValue(e[i],"width"),this.m_textAlignArr[t]=this.getProperAttributeNameValue(e[i],"textAlign"),this.m_frozenColumnsArr[t]=this.getProperAttributeNameValue(e[i],"frozencolumn"),this.m_freezeColumnsArr[t]=this.getProperAttributeNameValue(e[i],"freezecolumn"),this.m_tooltipColumnsArr[t]=this.getProperAttributeNameValue(e[i],"showTooltip"),r=this.getProperAttributeNameValue(e[i],"cellType"),n=this.getProperAttributeNameValue(e[i],"sorting"),a=this.getProperAttributeNameValue(e[i],"numberFormatter"),null==r&&(r=IsBoolean(e[i].isNumeric)?"Numeric":"none"),this.m_cellTypeArr[t]=r,this.m_isNumericArr[t]=r,this.m_isNumericArrMap[s]=r,this.m_isNumericArrMapForSorting[this.getStringARSC(s)]=r,this.m_sortingColumnsArr[t]=null==n||IsBoolean(n),this.m_numberFormatColumnsArr[t]=null==a?"none":a,this.m_rowaggrgationArr[s]=this.getProperAttributeNameValue(e[i],"rowAggregation"),this.m_isFixedLabelArr[t]=this.getProperAttributeNameValue(e[i],"isfixedlabel"),this.m_formatterArr[t]=this.getProperAttributeNameValue(e[i],"formatter"),this.m_unitNameArr[t]=this.getProperAttributeNameValue(e[i],"unitname"),this.m_signPositioneArr[t]=this.getProperAttributeNameValue(e[i],"signposition"),this.m_precisionArr[this.m_colHeadersFieldName[t]]=this.getProperAttributeNameValue(e[i],"precision"),this.m_secondFormatterArr[t]=this.getProperAttributeNameValue(e[i],"secondformatter"),this.m_secondUnitNameArr[t]=this.getProperAttributeNameValue(e[i],"secondunitname"),this.m_plotShapeArray[t]="cube",this.m_fieldColors[t]=this.getProperAttributeNameValue(e[i],"Color"),this.visibleFieldsData[t]=e[i],r=void 0!==this.getProperAttributeNameValue(e[i],"tooltipField")&&""!==this.getProperAttributeNameValue(e[i],"tooltipField")?this.getProperAttributeNameValue(e[i],"tooltipField"):this.m_colHeadersFieldName[t],this.m_TooltipFieldsArr[this.m_colHeadersFieldName[t]]=r.split(","),n={seriesName:this.m_colHeadersFieldName[t],displayName:this.m_gridheaderDisplayNames[t],color:this.m_fieldColors[t],shape:this.m_plotShapeArray[t],width:this.m_widthArr[t],textAlign:this.m_textAlignArr[t],frozenColumn:this.m_frozenColumnsArr[t],freezeColumn:this.m_freezeColumnsArr[t],sorting:this.m_sortingColumnsArr[t],cellType:this.m_cellTypeArr[t],numberFormatter:this.m_numberFormatColumnsArr[t],toolTipColumn:this.m_tooltipColumnsArr[t],numeric:this.m_isNumericArr[t],fixedLabel:this.m_isFixedLabelArr[t],formatter:this.m_formatterArr[t],unitName:this.m_unitNameArr[t],signPosition:this.m_signPositioneArr[t],precision:this.m_precisionArr[this.m_colHeadersFieldName[t]],secondFormatter:this.m_secondFormatterArr[t],secondUnitName:this.m_secondUnitNameArr[t],index:t},this.legendMap[this.m_colHeadersFieldName[t]]=n,t++)}this.setLegendsIntialLoad(this.m_defaultlegendfields)},JExcelDataGrid.prototype.getLegendInfo=function(){return this.legendMap},JExcelDataGrid.prototype.initCanvas=function(){$("#draggableDiv"+this.m_objectid).remove(),this.initializeDraggableDivAndCanvas()},JExcelDataGrid.prototype.initializeDraggableDivAndCanvas=function(){this.setDashboardNameAndObjectId(),this.m_draggableDiv=this.createDraggableDiv(this.m_chartContainer,this.m_zIndex),this.createDraggableCanvas(this.m_draggableDiv),this.setCanvasContext(),this.initMouseMoveEvent(this.m_chartContainer),this.initMouseClickEvent()},JExcelDataGrid.prototype.setDashboardNameAndObjectId=function(){this.m_objectId=this.m_objectid,2==this.m_objectid.split(".").length&&(this.m_objectid=this.m_objectid.split(".")[1]),this.m_componentid="dataGridDiv"+this.m_objectid},JExcelDataGrid.prototype.createDatagrid=function(){var e=this,t=(this.m_titleHeight=IsBoolean(this.m_title.m_showtitle)||IsBoolean(this.m_showgradient)||IsBoolean(this.m_showmaximizebutton)?this.m_title.m_titleBarHeight:0,this.m_subTitleHeight=IsBoolean(this.m_subTitle.m_showsubtitle)&&""!=this.m_subTitle.getDescription()?IsBoolean(this.m_enablehtmlformate.subtitle)?((this.m_subTitle.getDescription().match(/<br\s*\/?>/g)||[]).length+1)*this.m_subTitle.getFontSize()*1.5:this.m_subTitle.m_formattedDescription.length*this.m_subTitle.getFontSize()*1.5:0,this.m_designModeDrawingFlag&&($("#"+e.m_componentid).remove(),(t=document.createElement("div")).setAttribute("id",this.m_componentid),$("#draggableDiv"+e.m_objectid).append(t),(i=document.createElement("table")).setAttribute("id","datagridTable"+this.m_objectid),$("#draggableDiv"+e.m_objectid).append(i),t.appendChild(i)),IsBoolean(this.m_showborder)?this.m_borderthickness:0),i=IsBoolean(this.m_subTitle.m_showsubtitle)&&""!=this.m_subTitle.getDescription()?4:0;$("#"+e.m_componentid).css({top:+this.m_y+ +this.m_titleHeight+ +this.m_subTitleHeight+i+"px",left:+this.m_x+ +t+"px",position:"absolute"}),$("#datagridTable"+e.m_objectid).css({width:this.m_width-2*t+"px",height:+this.m_height-+this.m_titleHeight-+this.m_subTitleHeight-+this.m_DGFilterHeight-2*t-i+"px"}),this.m_gridFilterCondition="",$("#excelDiv"+e.m_objectid).remove(),$("#excelActionDiv"+e.m_objectid).remove()},JExcelDataGrid.prototype.init=function(){this.m_chartFrame.init(this),this.m_title.init(this),this.m_subTitle.init(this),this.m_seriesData=this.getDataFromJSON(),this.setVisibleFieldData(),this.isSeriesDataEmpty(),this.isEmptyField(),this.isVisibleField(),IsBoolean(this.m_isEmptyField)?($("#"+this.m_componentid).remove(),$("#excelDiv"+this.m_objectid).remove()):this.createDatagrid()},JExcelDataGrid.prototype.setVisibleFieldData=function(){this.m_gridheaderDisplayNames=[],this.m_colHeadersFieldName=[],this.m_widthArr=[],this.m_textAlignArr=[],this.m_isNumericArr=[],this.m_frozenColumnsArr=[],this.m_sortingColumnsArr=[],this.m_tooltipColumnsArr=[],this.m_numberFormatColumnsArr=[],this.m_isFixedLabelArr=[],this.m_formatterArr=[],this.m_unitNameArr=[],this.m_signPositioneArr=[],this.m_precisionArr={},this.m_secondFormatterArr=[],this.m_secondUnitNameArr=[],this.m_fieldColors=[];for(var e=0,t=this.m_fieldName.length;e<t;e++)IsBoolean(this.m_seriesVisibleArr[this.m_fieldName[e]])&&(this.m_colHeadersFieldName.push(this.legendMap[this.m_fieldName[e]].seriesName),this.m_gridheaderDisplayNames.push(this.legendMap[this.m_fieldName[e]].displayName),this.m_fieldColors.push(this.legendMap[this.m_fieldName[e]].color),this.m_widthArr.push(this.legendMap[this.m_fieldName[e]].width),this.m_textAlignArr.push(this.legendMap[this.m_fieldName[e]].textAlign),this.m_frozenColumnsArr.push(this.legendMap[this.m_fieldName[e]].frozenColumn),this.m_sortingColumnsArr.push(this.legendMap[this.m_fieldName[e]].sorting),this.m_tooltipColumnsArr.push(this.legendMap[this.m_fieldName[e]].toolTipColumn),this.m_numberFormatColumnsArr.push(this.legendMap[this.m_fieldName[e]].numberFormatter),this.m_isNumericArr.push(this.legendMap[this.m_fieldName[e]].numeric),this.m_isFixedLabelArr.push(this.legendMap[this.m_fieldName[e]].fixedLabel),this.m_formatterArr.push(this.legendMap[this.m_fieldName[e]].formatter),this.m_unitNameArr.push(this.legendMap[this.m_fieldName[e]].unitName),this.m_signPositioneArr.push(this.legendMap[this.m_fieldName[e]].signPosition),this.m_precisionArr[this.legendMap[this.m_fieldName[e]].seriesName]=this.legendMap[this.m_fieldName[e]].precision,this.m_secondFormatterArr.push(this.legendMap[this.m_fieldName[e]].secondFormatter),this.m_secondUnitNameArr.push(this.legendMap[this.m_fieldName[e]].secondUnitName))},JExcelDataGrid.prototype.getAllFieldsDisplayName=function(){return this.m_gridheaderDisplayNames},JExcelDataGrid.prototype.getAllFieldsName=function(){return this.m_colHeadersFieldName},JExcelDataGrid.prototype.drawChart=function(){this.drawChartFrame(),this.drawTitle(),this.drawSubTitle(),this.drawLegends();var e=this.IsDrawingPossible();IsBoolean(e.permission)?(this.setRowAltColors(),this.setColumnWidth(),this.drawJExcelGrid()):this.drawMessage(e.message)},JExcelDataGrid.prototype.drawChartFrame=function(){this.m_chartFrame.drawFrame()},JExcelDataGrid.prototype.drawTitle=function(){this.m_title.draw()},JExcelDataGrid.prototype.drawSubTitle=function(){this.m_subTitle.draw()},JExcelDataGrid.prototype.getDatasheetId=function(){return this.m_dashboard.m_DataProviders.m_dataUrlIdObjMap[this.m_datasource].m_selectedserviceid},JExcelDataGrid.prototype.drawActionIcons=function(t,e,i,o,a,r,s){var n=this,l=($("#"+t+n.m_objectid).remove(),document.createElement("span"));l.setAttribute("id",t+""+n.m_objectid),l.setAttribute("class",t+" "+a),l.style.position="absolute",l.style.cursor="pointer",l.style.fontSize=(r||16)+"px",l.style.color="#000000";return l.style.top=o+"px",l.style.left=i+"px",l.style.zIndex=this.m_zIndex,l.style.width=20*this.minWHRatio()+"px",l.style.height=20*heightRatio+"px",$("#excelActionDiv"+n.m_objectid).append(l),IsBoolean(isTouchEnabled)||$("#"+t+n.m_objectid).hover(function(){var e;n.m_designMode||((e=document.createElement("div")).innerHTML=s,e.setAttribute("id",t+"TooltipDiv"),$(e).css({"font-family":selectGlobalFont(n.getTitle().m_fontfamily),"font-size":"12px",top:o-5+"px",left:i+30+"px","z-index":1e4,border:"1px solid #e0dfdf",padding:"5px",position:"absolute","background-color":"#ffffff"}),$("#excelActionDiv"+n.m_objectid).append(e))},function(){$("#"+t+"TooltipDiv").remove()}),l},JExcelDataGrid.prototype.drawPaginationIcons=function(t,e,i,o,a,r,s){var n=this,l=($("#"+t+n.m_objectid).remove(),document.createElement("span"));l.setAttribute("id",t+""+n.m_objectid),l.setAttribute("class",t+" "+a),l.style.cursor="pointer",l.style.fontSize=(r||16)+"px",l.style.color="#000000",l.style.position="relative";return l.style.margin="10px",l.style.zIndex=this.m_zIndex,l.style.width=20*this.minWHRatio()+"px",l.style.height=20*heightRatio+"px",$("#paginationdiv"+n.m_objectid).append(l),IsBoolean(isTouchEnabled)||$("#"+t+n.m_objectid).hover(function(){var e;n.m_designMode||((e=document.createElement("div")).innerHTML=s,e.setAttribute("id",t+"TooltipDiv"),$(e).css({"font-family":selectGlobalFont(n.getTitle().m_fontfamily),"font-size":"12px",top:$(this)[0].offsetTop-5+"px",left:$(this)[0].offsetLeft+30+"px","z-index":1e4,border:"1px solid #e0dfdf",padding:"5px",position:"absolute","background-color":"#ffffff"}),$("#paginationdiv"+n.m_objectid).append(e))},function(){$("#"+t+"TooltipDiv").remove()}),l},JExcelDataGrid.prototype.getDatasheetColumnsDef=function(){return this.m_dashboard.m_DataProviders.m_dataUrlIdObjMap[this.m_datasource].m_datasheetjsondef.columns},JExcelDataGrid.prototype.isDatasheetDataProvider=function(){return!this.m_designMode&&"datasheet"==this.m_dashboard.m_DataProviders.m_dataUrlIdObjMap[this.m_datasource].m_type},JExcelDataGrid.prototype.createjExcelContainer=function(){var o=this,e=($("#excelDiv"+o.m_objectid).remove(),document.createElement("div")),e=(e.setAttribute("id","excelDiv"+o.m_objectid),$("#draggableDiv"+o.m_objectid).append(e),document.createElement("div")),e=(e.setAttribute("id","excelActionDiv"+o.m_objectid),$("#draggableDiv"+o.m_objectid).append(e),IsBoolean(this.m_iseditable)?30:0),t=IsBoolean(this.m_subTitle.m_showsubtitle)&&""!=this.m_subTitle.getDescription()?4:0,t=+this.m_y+ +this.m_titleHeight+ +this.m_subTitleHeight+t,i=($("#excelActionDiv"+o.m_objectid).css({width:this.m_width+"px",height:e+"px",top:t+"px",overflow:"hidden",position:"absolute",background:"#ffffff99","align-items":"center"}),this.drawActionIcons("saveDatasheetRecords","",10,5,"bd-save",14,"Save Changes")),i=(o.m_designMode||(i.onclick=function(){var e,t="#excelDiv"+o.m_objectid,i=[];for(e in o.changedRows)i.push(o.changedRows[e]);0<i.length&&o.updateDataSheetData(t,i,"2",function(){o.changedRows={},o.updateTableStyle(t),sdk.reload([o.m_datasource])}),document.getElementById("saveDatasheetRecords"+o.m_objectid).style.color="#000000",alertPopUpModal({type:"success",message:"Table has been saved",timeout:"3000"})}),!o.m_designMode&&o.m_allowinsertrow&&(this.drawActionIcons("addDatasheetRecords","",40,5,"bd-plus-circle",14,"Add Row").onclick=function(){var e;o.insertSelectedRow(),IsBoolean(o.m_pagination)&&(e=Math.floor(o.m_seriesData.length/o.m_maxrow),document.getElementById("excelDiv"+o.m_objectid).jexcel.page(e)),document.getElementById("saveDatasheetRecords"+o.m_objectid).style.color="red"}),this.drawActionIcons("deleteDatasheetRecords","",IsBoolean(o.m_allowinsertrow)?70:40,5,"bd-cross",14,"Delete Selected Row")),i=(o.m_designMode||(i.onclick=function(){0<o.selectedRows.length?(o.createPopupForRowDeletion(o),$("#getyes").click(function(){o.deleteSelectedRows(function(){}),$("#dialogdiv").dialog("destroy")}),$("#getno").click(function(){$("#dialogdiv").dialog("destroy")})):alert("Select a row")}),t+e);return $("#excelDiv"+o.m_objectid).css({"margin-top":i+"px",width:this.m_width-2+"px",height:this.m_height-i-2+"px",overflow:"hidden",position:"absolute"}),$("#draggableCanvas"+o.m_objectid).css("position","absolute"),{W:this.m_width-2,H:this.m_height-i-2-30*(IsBoolean(this.m_pagination)?2:1)}},JExcelDataGrid.prototype.createTextDiv=function(){var t=this,e=0==(e=Math.floor(t.m_seriesData.length/t.m_maxrow))?e+1:e,i=document.createElement("span"),o=(document.createElement("span").innerHTML="Page ",document.createElement("input")),e=(o.setAttribute("id","paginationinput"+t.m_objectid),o.setAttribute("value",+t.m_pagenumber+1),$(o).css({height:"20px",width:"20px",background:"transparent","-webkit-appearance":"none"}),document.createElement("span").innerHTML=" Of ",document.createElement("span").innerHTML=e);$(i).append("Page ",o," Of ",e),o.onchange=function(){var e=Math.floor(t.m_seriesData.length/t.m_maxrow),e=(o.value>e?o.value=e:(o.value<1||isNaN(o.value))&&(o.value=1),t.m_pagenumber=+o.value-1,"#excelDiv"+t.m_objectid),e=$(e)[0].jexcel;e.getConfig().pagination=t.m_maxrow,e.page(t.m_pagenumber),t.updatepageiconStyle()},$(i).css({position:"relative",margin:"10px","font-family":selectGlobalFont(t.m_labelfontfamily)}),$("#paginationdiv"+t.m_objectid).append(i)},JExcelDataGrid.prototype.updatepageiconStyle=function(){var e=this,t=(t=Math.floor(e.m_seriesData.length/e.m_maxrow)-1)<0?0:t,i={opacity:"0.3","pointer-events":"none",cursor:"default"},o={opacity:"1","pointer-events":"auto",cursor:"pointer"};$("#previouspage"+e.m_objectid).css(o),$("#Gotofirst"+e.m_objectid).css(o),$("#nextpage"+e.m_objectid).css(o),$("#Gotolast"+e.m_objectid).css(o),0==e.m_pagenumber&&($("#previouspage"+e.m_objectid).css(i),$("#Gotofirst"+e.m_objectid).css(i)),e.m_pagenumber==t&&($("#nextpage"+e.m_objectid).css(i),$("#Gotolast"+e.m_objectid).css(i))},JExcelDataGrid.prototype.mainDiv=function(){var e=document.createElement("div"),t=(e.id="dialogdiv",IsBoolean(this.m_designMode)||"MobileLayout"!=this.m_dashboard.m_AbsoluteLayout.m_layouttype?"600px":"90%");return $(e).css({width:t,height:"auto",padding:"0px","border-radius":"8px",background:"#FFFFFF"}),e},JExcelDataGrid.prototype.createPopupForRowDeletion=function(e){var t=document.createElement("div"),i=($(t).css("height","10%"),document.createElement("div")),o=($(i).css({margin:"0px 5px 5px 25px","text-align":"left","font-weight":"600",color:"#434344"}),document.createTextNode("Are you sure you want to delete the Row ?")),o=($(o).css({"font-style":this.m_fontstyle,"font-weight":this.m_fontweight,"font-size":this.fontScaling(this.m_fontsize)+"px","font-family":selectGlobalFont(this.m_fontfamily)}),i.appendChild(o),t.appendChild(i),this.mainDiv()),i=(o.appendChild(t),this.createBtnDiv());$(i).css("margin-left","10%"),o.appendChild(i),$(o).dialog({title:"Delete Row Window",closed:!1,cache:!1,modal:!0,draggable:!1,position:{my:"center",at:"center",of:window},onClose:function(){$("#dialogdiv").dialog("destroy")}}),$(".window").css({background:"#FFFFFF","border-radius":"8px 8px 8px 8px"}),$(".window-header").css({padding:"20px"}),$(".panel-title").css({background:"transparent","text-align":"left",color:"#434344",padding:"5px","font-weight":"bolder","font-size":this.fontScaling(25)+"px","font-style":this.m_fontstyle,"font-family":selectGlobalFont(this.m_fontfamily)}),$(".panel-tool").css({height:"21px",width:"26px",margin:"-14px 3px 0px 0px"}),$(".panel-tool a").css("display","none"),$("dialogdiv .panel-header, .panel-body").css({"font-style":this.m_fontstyle,"font-weight":this.m_fontweight,"font-size":this.fontScaling(this.m_fontsize)+"px","font-family":selectGlobalFont(this.m_fontfamily),"border-style":"none"})},JExcelDataGrid.prototype.createBtnDiv=function(){var e=document.createElement("div");return $(e).css({background:"#ffffff",float:"right",height:"20%","margin-right":"10%"}),this.yesbutton=this.createYesButton("getyes","Yes"),this.nobutton=this.createNoButton("getno","No"),e.appendChild(this.yesbutton),e.appendChild(this.nobutton),e},JExcelDataGrid.prototype.createYesButton=function(e,t){var i=document.createElement("input");return i.type="submit",i.setAttribute("id",e),i.value=t,$(i).css({font:"normal normal "+16*this.minWHRatio()+"px "+selectGlobalFont(this.m_fontfamily),padding:"7px","box-shadow":"0 2px 2px 0 rgba(0,0,0,0.14), 0 1px 5px 0 rgba(0,0,0,0.12), 0 3px 1px -2px rgba(0,0,0,0.2)",cursor:this.m_cursortype,border:"hidden",width:"106px",display:"inline-block","text-align":"center",background:"#0D78BF",color:"#fff","margin-left":"2px","margin-right":"6px","margin-top":"35px","margin-bottom":"20px","border-radius":"4px 4px 4px 4px"}),i},JExcelDataGrid.prototype.createNoButton=function(e,t){var i=document.createElement("input");return i.type="submit",i.setAttribute("id",e),i.value=t,$(i).css({font:"normal normal "+16*this.minWHRatio()+"px "+selectGlobalFont(this.m_fontfamily),padding:"7px","box-shadow":"0 2px 2px 0 rgba(0,0,0,0.14), 0 1px 5px 0 rgba(0,0,0,0.12), 0 3px 1px -2px rgba(0,0,0,0.2)",cursor:this.m_cursortype,border:"hidden",width:"106px",display:"inline-block","text-align":"center",background:"#ffffff",color:"#000000","margin-left":"2px","margin-top":"35px","margin-bottom":"20px","border-radius":"4px 4px 4px 4px"}),i},JExcelDataGrid.prototype.drawJExcelGrid=function(){var t=this,e=($("#paginationContainerDiv"+t.m_objectid).remove(),t.isDatasheetDataProvider()||(this.m_iseditable=!1),this.createjExcelContainer()),i=this.getAllFieldsName(),o=this.getAllFieldsDisplayName();if(this.jexcelColumns=[],t.m_designMode||!t.isDatasheetDataProvider())for(var a=0;a<i.length;a++){var r={type:"text"};r.title=o[a],r.width=t.m_widthArr[a],r.readOnly=t.m_freezeColumnsArr[a],this.jexcelColumns.push(r)}else{var s=this.getDatasheetColumnsDef();this.jexcelColumns=[{filter:!1,lookUp:"",width:"255",formula:"",title:"BDB_DS_ID",type:"hidden"}];for(a=0;a<i.length;a++)for(var n=0;n<s.length;n++)null==s[n].source||"dropdown"!=s[n].type&&"autocomplete"!=s[n].type||(s[n].source=[]),null!=s[n].type&&"calendar"==s[n].type&&(s[n].options.fullscreen=!0),"BDB_DS_ID"!==s[n].title&&s[n].title==i[a]&&(s[n].width=t.m_widthArr[a],s[n].readOnly=t.m_freezeColumnsArr[a],this.jexcelColumns.push(s[n]))}for(var l=[],m=0;m<this.m_seriesData.length;m++){l[m]=[];for(var d,h=0;h<this.jexcelColumns.length;h++)"calendar"==this.jexcelColumns[h].type?(d=this.m_seriesData[m][this.jexcelColumns[h].title],d=this.changeDateFormat(d),l[m].push(d)):l[m].push(this.m_seriesData[m][this.jexcelColumns[h].title])}this.changedRows=this.changedRows||{},this.selectedRows=[];e={data:l,columns:this.jexcelColumns,tableOverflow:!0,tableWidth:e.W+"px",tableHeight:e.H+"px",fullscreen:!1,lazyLoading:IsBoolean(t.m_enablelazyloading),loadingSpin:!0,editable:IsBoolean(t.m_iseditable),allowInsertRow:IsBoolean(t.m_allowinsertrow),allowDeleteRow:!0,allowManualInsertColumn:!1,contextMenu:function(){return!1},onload:function(e){t.setDatasheet($(e)[0].jexcel),t.getDatasheet(e).hideIndex(),t.updateTableStyle(e),IsBoolean(t.m_pagination)&&($(".jexcel_pagination").remove(),t.createPagination())},ondeleterow:function(e){t.updateTableStyle(e)},onchangepage:function(e){t.updateTableStyle(e)},onselection:t.RowSelectEvent.bind(t),onchange:t.RowChangeEvent.bind(t),onpaste:t.RowPasteEvent.bind(t),oninsertrow:t.RowInsertEvent.bind(t),onsort:t.ColumnSortEvent.bind(t)},e=this.setDatasheetConfig(e);jexcel(document.getElementById("excelDiv"+t.m_objectid),e)},JExcelDataGrid.prototype.changeDateFormat=function(e){var t;return/^(0[1-9]|[12][0-9]|3[01])-(0[1-9]|1[0-2])-\d{4}$/.test(e)?(t=e.split("-"))[2]+"-"+t[1]+"-"+t[0]:e},JExcelDataGrid.prototype.getFormattedCellValue=function(e,t,i){var o,a,r,s,n,l,m,d,h;return isNaN(getNumericComparableValue(e))?e:(o=0<(""+e).indexOf(","),a=""!=this.m_signPositioneArr[i]?this.m_signPositioneArr[i]:"suffix",t=this.m_precisionArr[t],r=this.m_formatterArr[i],s=this.m_secondFormatterArr[i],d=this.m_unitNameArr[i],l=this.m_secondUnitNameArr[i],h="default"===t?+getNumericComparableValue(e):(+getNumericComparableValue(e)).toFixed(t),""!=d?(n=this.m_util.getFormatterSymbol(r,d),"auto"==(l="none"==s||""==s?"":this.m_util.getFormatterSymbol(s,l))?(e=getNumericComparableValue(e),m=getNumberFormattedSymbol(+e,d),d=getNumberFormattedNumericValue(+e,t,d),d=this.m_util.updateTextWithFormatter(d,"",t),h=this.m_util.addFormatter(d,m,"suffix")):("Number"!=r&&"Number"!=s||(h=this.m_util.updateTextWithFormatter(h,"Number"==r?n:l,t)),"none"!=this.m_secondFormatterArr[i]&&""!=this.m_secondFormatterArr[i]&&""!=this.m_secondUnitNameArr[i]&&(h=this.m_util.addFormatter(h,l,"suffix"))),"NaN"==(h=getFormattedNumberWithCommas(h,this.m_numberFormatColumnsArr[i]))||""==h?"":this.m_util.addFormatter(IsBoolean(o)?getNumberWithCommas(h):h,n,a)):"NaN"==h?e:h)},JExcelDataGrid.prototype.setDatasheetConfig=function(e){return e.minSpareRows=0,e.allowManualInsertRow=1,e.wordWrap=IsBoolean(this.m_textwrap),IsBoolean(this.m_pagination)&&(e.pagination=this.m_maxrow),e.columnSorting=!0,e},JExcelDataGrid.prototype.createPagination=function(){var e=this,t=($("#paginationContainerDiv"+e.m_objectid).remove(),document.createElement("div")),t=(t.setAttribute("id","paginationContainerDiv"+e.m_objectid),$("#draggableDiv"+e.m_objectid).append(t),$("#paginationContainerDiv"+e.m_objectid).css({width:e.m_width+"px",height:"30px",bottom:"0px",overflow:"hidden",position:"absolute",background:"#ffffff99",display:"flex","justify-content":"center",margin:"10px 0px","align-items":"center"}),document.createElement("div")),t=(t.setAttribute("id","paginationdiv"+e.m_objectid),$("#paginationContainerDiv"+e.m_objectid).append(t),$("#paginationdiv"+e.m_objectid).css({display:"inline-block"}),e.m_pagenumber=0,this.drawPaginationIcons("Gotofirst","",0,0,"bd-backward",14,"Go to first Page")),i=this.drawPaginationIcons("previouspage","",0,0,"bd-arrow-left",14,"Previous Page"),o=(this.createTextDiv(),this.drawPaginationIcons("nextpage","",0,0,"bd-arrow-right",14,"Next Page")),a=this.drawPaginationIcons("Gotolast","",0,0,"bd-forward",14,"Go to last Page"),r=(e.updatepageiconStyle(),"#excelDiv"+e.m_objectid),s=$(r)[0].jexcel;s.getConfig().pagination=e.m_maxrow,o.onclick=function(){e.m_pagenumber=+e.m_pagenumber+1,s.page(e.m_pagenumber),$("#paginationinput"+e.m_objectid)[0].value=+e.m_pagenumber+1,e.updatepageiconStyle()},i.onclick=function(){e.m_pagenumber=e.m_pagenumber-1,s.page(e.m_pagenumber),$("#paginationinput"+e.m_objectid)[0].value=+e.m_pagenumber+1,e.updatepageiconStyle()},t.onclick=function(){e.m_pagenumber=0,s.page(e.m_pagenumber),$("#paginationinput"+e.m_objectid)[0].value=+e.m_pagenumber+1,e.updatepageiconStyle()},a.onclick=function(){e.m_pagenumber=Math.floor(e.m_seriesData.length/e.m_maxrow)-1,s.page(e.m_pagenumber),$("#paginationinput"+e.m_objectid)[0].value=+e.m_pagenumber+1,e.updatepageiconStyle()}},JExcelDataGrid.prototype.setDatasheet=function(e){this.m_datasheet=e},JExcelDataGrid.prototype.getDatasheet=function(e){return this.m_datasheet||$(e)[0].jexcel},JExcelDataGrid.prototype.RowSelectEvent=function(e,t,i,o,a){for(var r=this,s=(r.selectedRows=[],r.selectedRows=r.getDatasheet(e).getSelectedRows(),r.getDatasheet(e).getRowData(i)),n=r.getDatasheet(e).getHeaders().split(","),l=(this.changedRows=this.changedRows||{},{}),m=0;m<n.length;m++)"0"==s[m]?l[n[m]]=0:l[n[m]]=s[m];e=l;e.drillDisplayField=n[i],e.drillField=n[i],e.drillValue=s[t];r.updateDataPoints(e,"")},JExcelDataGrid.prototype.RowChangeEvent=function(e,t,i,o,a){for(var r=this,s=r.getDatasheet(e).getRowData(o),n=r.getDatasheet(e).getHeaders().split(","),l=(this.changedRows=this.changedRows||{},{}),m=0;m<n.length;m++)"0"==s[m]?l[n[m]]=0:l[n[m]]=s[m];if(this.changedRows[o]=l,IsBoolean(r.m_enablecellupdatesave)){var d,h=[];for(d in r.changedRows)h.push(r.changedRows[d]);0<h.length&&r.updateDataSheetData(e,h,"2",function(){r.changedRows={},sdk.reload([r.m_datasource])})}document.getElementById("saveDatasheetRecords"+r.m_objectid).style.color="red"},JExcelDataGrid.prototype.deleteSelectedRows=function(){for(var e=this,t="#excelDiv"+e.m_objectid,i=$(t)[0].jexcel,o=[],a=0;a<this.selectedRows.length;a++){r=IsBoolean(this.m_pagination)?parseInt(this.selectedRows[a].dataset.y):this.selectedRows[a].rowIndex-1;var r,s=i.getHeaders().split(","),n=i.getRowData(r);if(""!=n&&null!=n){for(var l={},m=0;m<s.length;m++)"0"==n[m]?l[s[m]]=0:l[s[m]]=n[m];o.push(l)}i.deleteRow(r,1)}alertPopUpModal({type:"success",message:"Row has been deleted",timeout:"3000"}),this.updateDataSheetData(i,o,"3",function(){sdk.reload([e.m_datasource])})},JExcelDataGrid.prototype.insertSelectedRow=function(){var e="#excelDiv"+this.m_objectid,t=$(e)[0].jexcel,e=[],i=0,o=t.rows.length,a=o+1,r=t.getHeaders().split(","),s=t.getRowData(a);if(""!=s&&null!=s){for(var n={},l=0;l<r.length;l++)"0"==s[l]?n[r[l]]=0:n[r[l]]=s[l];e.push(n)}for(t.insertRow(e,a,!1),i=1;i<=this.m_fieldName.length;i++)t.records[o][i].className="";alertPopUpModal({type:"success",message:"A row has been added",timeout:"3000"}),this.updateDataSheetData(t,e,"3",function(){})},JExcelDataGrid.prototype.updateDataSheetData=function(e,t,i,o){i={bizvizdatasheetId:this.getDatasheetId(),type:""+i,data:JSON.stringify(t)};JSON.stringify(i),parent.BIZVIZ.SDK.getAuthInfo().user.spaceKey,makeSecureRequest({url:base_url+req_url.designer.pluginService,method:"POST",formData:{isSecure:!0,consumerName:"BDBDATASHEET",serviceName:"saveOrUpdateSheetRecords",data:JSON.stringify(i),spacekey:parent.BIZVIZ.SDK.getAuthInfo().user.spaceKey},params:{headers:{authtoken:parent.BIZVIZ.SDK.getAuthInfo().authToken,spacekey:encryptText(parent.BIZVIZ.SDK.getAuthInfo().user.spaceKey),userid:encryptText(parent.BIZVIZ.SDK.getAuthInfo().user.id)}}},function(e,t,i){o&&o(e)})},JExcelDataGrid.prototype.RowPasteEvent=function(e,t,i,o,a){},JExcelDataGrid.prototype.RowInsertEvent=function(e,t){this.updateTableStyle(e)},JExcelDataGrid.prototype.ColumnSortEvent=function(e){this.updateTableStyle(e)},JExcelDataGrid.prototype.updateTableStyle=function(e){var i=this,o=i.getRowAltColors();$(e)[0].jexcel.rows.map(function(e){var t="",t=e.dataset.y%2?hex2rgb(convertColorToHex(o[1]),i.m_rowopacity):hex2rgb(convertColorToHex(o[2]),i.m_rowopacity);e.style.backgroundColor=t}),IsBoolean(i.m_fitcolumns)&&$("#excelDiv"+i.m_objectid+" .jexcel_content").css({"overflow-x":"hidden"}),$("#excelDiv"+i.m_objectid+" .jexcel").css({"font-family":selectGlobalFont(i.m_labelfontfamily)}),$("#excelDiv"+i.m_objectid+" .jexcel > thead > tr > td").css({color:convertColorToHex(i.m_headerfontcolor),"font-weight":i.m_headerfontweight,"font-size":i.fontScaling(i.m_headerfontsize)+"px","font-family":selectGlobalFont(i.m_headerfontfamily),"font-style":i.m_headerfontstyle,"text-decoration":i.m_headertextdecoration,height:+i.m_rowheight+5+"px","line-height":"1.5",background:hex2rgb(convertColorToHex(i.m_headerchromecolor),i.m_headerrowopacity)}),$("#excelDiv"+i.m_objectid+" .jexcel > tbody > tr > td").css({"font-weight":i.m_labelfontweight,"font-size":i.fontScaling(i.m_labelfontsize)+"px","font-family":selectGlobalFont(i.m_labelfontfamily),"font-style":i.m_labelfontstyle,"text-decoration":i.m_labeltextdecoration,color:convertColorToHex(i.m_labelfontcolor),height:i.m_rowheight+"px","line-height":"1.5"}),$(".jexcel_pagination").css({bottom:"0px",position:"absolute",width:"100%"})},JExcelDataGrid.prototype.setColumnWidth=function(){for(var e=0,t=0,i=(this.m_fitRemainingColumns=!1,0),o=this.m_colHeadersFieldName.length;i<o;i++)null!=this.m_widthArr[i]&&""!=this.m_widthArr[i]&&(e=+e+ +parseInt(this.m_widthArr[i])+2,t++);var a=this.m_width-e-2,r=a/(this.m_colHeadersFieldName.length-t!=0?this.m_colHeadersFieldName.length-t:1),s=[];if(_.contains(this.m_frozenColumnsArr,!0))if(_.contains(this.m_frozenColumnsArr,!0)&&IsBoolean(this.m_fitcolumns)){for(var n=0,l=this.m_width,m=0,d=this.m_colHeadersFieldName.length;m<d;m++)IsBoolean(this.m_frozenColumnsArr[m])&&(s[m]=parseInt(+this.m_widthArr[m]),l-=s[m],n++);for(var i=0,h=this.m_colHeadersFieldName.length;i<h;i++)IsBoolean(this.m_frozenColumnsArr[i])?null!=this.m_widthArr[i]&&""!=this.m_widthArr[i]?s[i]=parseInt(+this.m_widthArr[i]):s[i]=parseInt(r):s[i]=l/(this.m_colHeadersFieldName.length-n);this.m_fitRemainingColumns=!0}else{for(i=0,d=this.m_colHeadersFieldName.length;i<d;i++)null!=this.m_widthArr[i]&&""!=this.m_widthArr[i]?this.isMaximized&&0<a?s[i]=this.m_width*(this.m_widthArr[i]/e):s[i]=parseInt(+this.m_widthArr[i]):s[i]=parseInt(r);this.m_fitRemainingColumns=!!(this.isMaximized&&0<a)}else if(IsBoolean(this.m_fitcolumns)){for(var i=0,d=this.m_colHeadersFieldName.length;i<d;i++)null!=this.m_widthArr[i]&&""!=this.m_widthArr[i]?s[i]=this.m_width*(this.m_widthArr[i]/e):s[i]=parseInt(r);this.m_fitRemainingColumns=!0}else{for(o=this.m_colHeadersFieldName.length,i=0;i<o;i++)null!=this.m_widthArr[i]&&""!=this.m_widthArr[i]?this.isMaximized&&0<a?s[i]=this.m_width*(this.m_widthArr[i]/e):s[i]=parseInt(+this.m_widthArr[i]):s[i]=parseInt(r);this.m_fitRemainingColumns=!!(this.isMaximized&&0<a)}this.m_widthArr=s},JExcelDataGrid.prototype.getRowAltColors=function(){return this.m_alternaterowcolors},JExcelDataGrid.prototype.setRowAltColors=function(){this.m_alternaterowcolors=[];var e=this.getDatagridStyles().getAlternateRowsColor(),t=this.getDatagridStyles().getHeaderColors();if(null!=e){1==(a=e.split(",")).length&&a.push(a[0]);for(var i=["#ffffff"],o=0;o<a.length;o++)i.push(convertColorToHex(a[o]));a=i}else{for(var a=t.split(","),r=[],s=0;s<a.length;s++)r.push(convertColorToHex(a[s]));1==(a=r).length?(a.push("#ffffff"),a.push("#ffffff")):2==a.length&&a.push(a[1])}this.m_alternaterowcolors=a},JExcelDataGrid.prototype.getToolTipData=function(e,t){var i=[];return i[0]="",i};
//# sourceMappingURL=JExcelDataGrid.min.js.map