/*! BDB Charting Library V10.0.0 (2025-08-14 11:37:12) 
 Copyright 2015-2024 BDB (BizViz Technologies Pvt Ltd). All Rights Reserved */
function TreeMapChart(t,e){this.base=Chart,this.base(),this.m_x=20,this.m_y=320,this.m_width=300,this.m_height=260,this.m_radius=1,this.m_seriesNames=[],this.m_categoryData=[],this.m_seriesData=[],this.m_max=[],this.m_range1=[],this.m_range2=[],this.m_color=[],this.m_CategoryDataSum=[],this.m_displayname=[],this.m_rangeForLegend=[],this.m_range=[],this.m_ranges="",this.m_colorArray=[],this.m_seriesColorArray=[],this.m_color=[],this.m_displayname="ES,MS",this.m_ranges="0-20,20-100",this.m_colors="#cccccc,26265",this.m_legendDisplayNames="",this.m_showcelltext=!1,this.m_celltextcolor="#000000",this.m_celltextfontstyle="normal",this.m_celltextfontweight="normal",this.m_celltextfontsize="12",this.m_celltextfontfamily="Roboto",this.m_highervaluesaregood="true",this.m_titleBarHeight=25,this.m_subTitleBarHeight=25,this.m_xAxis=new Xaxis,this.m_yAxis=new Yaxis,this.m_colorMap=new Object,this.m_chartContainer=t,this.m_zIndex=e,this.m_objectid="",this.m_textUtil=new TextUtil,this.m_headerbgcolor="#CCCCCC",this.m_bodystrokecolor="#FFFFFF",this.m_showdynamicrange=!0,this.m_minrangecolor="#eeeeee",this.m_maxrangecolor="#443554",this.m_leafNodeSeriesDataFlag=!1,this.m_parentNodeSeriesDataFlag=!1,this.m_childNodeSeriesDataFlag=!1,this.m_defaultfillcolor="#e0dfdf",this.m_leftpadding=7,this.m_rightpadding=7,this.m_toppadding=7,this.m_bottompadding=7,this.m_showparentdatalabel=!0,this.m_showparenttextformatter=!0}TreeMapChart.prototype=new Chart,TreeMapChart.prototype.setProperty=function(t){this.ParseJsonAttributes(t.Object,this),this.initCanvas()},TreeMapChart.prototype.ParseJsonAttributes=function(t,e){for(var i in this.chartJson=t)if("Chart"==i)for(var a in t[i])switch(a){case"xAxis":for(var r in t[i][a]){var o=this.getNodeAttributeName(r);e.m_xAxis[o]=t[i][a][r]}break;case"yAxis":for(var s in t[i][a]){var o=this.getNodeAttributeName(s);e.m_yAxis[o]=t[i][a][s]}break;case"Title":for(var n in t[i][a]){var o=this.getNodeAttributeName(n);e.m_title[o]=t[i][a][n]}break;case"SubTitle":for(var l in t[i][a]){var o=this.getNodeAttributeName(l);e.m_subTitle[o]=t[i][a][l]}break;case"Legend":for(var m in t[i][a])e[o=this.getNodeAttributeName(m)]=t[i][a][m];break;default:e[o=this.getNodeAttributeName(a)]=t[i][a]}else e[o=this.getNodeAttributeName(i)]=t[i]},TreeMapChart.prototype.initCanvas=function(){$("#draggableDiv"+this.m_objectid).remove(),this.initializeDraggableDivAndCanvas()},TreeMapChart.prototype.initializeDraggableDivAndCanvas=function(){this.setDashboardNameAndObjectId(),this.m_draggableDiv=this.createDraggableDiv(this.m_chartContainer,this.m_zIndex),this.createDraggableCanvas(this.m_draggableDiv),this.setCanvasContext(),this.initMouseMoveEvent(this.m_chartContainer),this.initMouseClickEvent()},TreeMapChart.prototype.setDraggableCanvasSize=function(){var t=IsBoolean(this.m_isEmptySeries)?this.m_height:+this.getMarginForTitle()+this.getMarginForSubTitle(),e=document.getElementById("draggableCanvas"+this.m_objectid);""!=e&&null!=e&&(e.width=this.m_width,e.height=t)},TreeMapChart.prototype.setFields=function(t){this.m_fieldsJson=t,this.setSeries(t)},TreeMapChart.prototype.setSeries=function(t){this.fieldsData=t,this.m_visibleArr={},this.m_allSeriesDisplayNames=[],this.m_allSeriesNames=[],this.m_hierarchyTypeArr={},this.m_seriesName=[],this.m_displayNames=[],this.m_colorField={},this.m_leafNodeName=[],this.m_seriesNameWithColorField={},this.m_AdditionalDataField={};for(var e=0,i=0,a=t.length;i<a;i++){var r,o=this.formattedDescription(this,this.getProperAttributeNameValue(t[i],"DisplayName"));this.m_allSeriesDisplayNames[i]=o,this.m_allSeriesNames[i]=this.getProperAttributeNameValue(t[i],"Name"),this.m_visibleArr[this.m_allSeriesNames[i]]=this.getProperAttributeNameValue(t[i],"visible"),this.m_hierarchyTypeArr[this.m_allSeriesNames[i]]=this.getProperAttributeNameValue(t[i],"hierarchyType"),IsBoolean(this.m_visibleArr[this.m_allSeriesNames[i]])&&(this.m_seriesName[e]=this.getProperAttributeNameValue(t[i],"Name"),this.m_displayNames[e]=o,o=this.getProperAttributeNameValue(t[i],"ColorField"),this.m_seriesNameWithColorField[this.m_seriesName[e]]=this.getProperAttributeNameValue(t[i],"ColorField"),r=void 0!==this.getProperAttributeNameValue(t[i],"AdditionalField")?this.getProperAttributeNameValue(t[i],"AdditionalField"):this.m_seriesName[e],this.m_AdditionalDataField[this.m_seriesName[e]]=r.split(","),"parent"!=this.m_hierarchyTypeArr[o]&&"child"!=this.m_hierarchyTypeArr[o]?(this.m_colorField[this.m_seriesName[e]]=null!=o&&null!==o&&""!==o?o:"",this.m_leafNodeName[0]=this.m_seriesName[e]):this.m_colorField[this.m_seriesName[e]]="",e++)}this.setCategoryNames(t),this.setSeriesNames(t),this.setFieldsByNames(t)},TreeMapChart.prototype.setCategoryNames=function(t){this.cat=[];for(var e=0,i=t.length;e<i;e++)""==this.getProperAttributeNameValue(t[e],"Name")?this.cat[e]=this.getProperAttributeNameValue(t[e],"Value"):this.cat[e]=this.getProperAttributeNameValue(t[e],"Name")},TreeMapChart.prototype.setSeriesNames=function(t){this.ser=[];for(var e=0,i=t.length;e<i;e++)""==this.getProperAttributeNameValue(t[e],"Name")?this.ser[e]=this.getProperAttributeNameValue(t[e],"Value"):this.ser[e]=this.getProperAttributeNameValue(t[e],"Name")},TreeMapChart.prototype.setFieldsByNames=function(t){this.m_fieldByName=[];for(var e=0,i=t.length;e<i;e++){var a=this.getProperAttributeNameValue(t[e],"hierarchyType");"parent"!=a&&"child"!=a||this.m_fieldByName.push(this.getProperAttributeNameValue(t[e],"Name"))}},TreeMapChart.prototype.getDataProvider=function(){return this.m_dataProvider},TreeMapChart.prototype.getSeriesNames=function(){return this.ser},TreeMapChart.prototype.getCategoryNames=function(){return this.cat},TreeMapChart.prototype.getFieldsByNames=function(){return this.m_fieldByName},TreeMapChart.prototype.init=function(){this.setCategoryData(),this.setSeriesData(),this.isSeriesDataEmpty(),this.setAllFieldsName(),this.m_seriesDataForToolTip=this.getSeriesDataForToolTipData(this.getDataProvider()),this.setColorFieldArr(),this.m_chartFrame.init(this),this.m_title.init(this),this.m_subTitle.init(this),IsBoolean(this.m_isEmptySeries)||(this.getRanges(),this.initializeColor(),this.createColorRange(),this.setUnitSymbol(),this.setSecondaryUnitSymbol()),this.initializeToolTipProperty(),this.m_tooltip.init(this)},TreeMapChart.prototype.setAllFieldsName=function(){this.m_allfieldsName=[];for(var t=0,e=this.getCategoryNames().length;t<e;t++)this.m_allfieldsName.push(this.getCategoryNames()[t]);for(var i=0,a=this.getSeriesNames().length;i<a;i++)this.m_allfieldsName.push(this.getSeriesNames()[i])},TreeMapChart.prototype.getAllFieldsName=function(){return this.m_allfieldsName},TreeMapChart.prototype.setColorFieldArr=function(){for(var t=0,e=this.m_seriesColorNameArr.length;t<e;t++){var i=""!=this.m_colorField[this.m_seriesColorNameArr[t]]?this.m_colorField[this.m_seriesColorNameArr[t]]:this.m_seriesColorNameArr[t];this.m_seriesColorValueArr[t]=this.getDataFromJSON(i)}},TreeMapChart.prototype.isColorField=function(t){var e=0,i=this.m_leafNodeName.length;if(e<i)return t==this.m_leafNodeName[e]},TreeMapChart.prototype.setMinMaxValueFromSeriesData=function(){for(var t=!(this.serMaxVal=this.serMinVal=0),e=0,i=this.m_seriesColorValueArr.length;e<i;e++)for(var a=0,r=this.m_seriesColorValueArr[e].length;a<r;a++){var o=getNumericComparableValue(this.m_seriesColorValueArr[e][a]);void 0===o||isNaN(o)||null===o||""===o||(t&&(this.serMaxVal=this.serMinVal=o,t=!1),this.serMaxVal<=+o&&(this.serMaxVal=o),this.serMinVal>=+o&&(this.serMinVal=o))}},TreeMapChart.prototype.getSeriesDataForToolTipData=function(t){var e,i,a=[],r=0;for(e in t)for(var o in t[e])"none"==this.m_hierarchyTypeArr[o]&&(!isNaN(t[e][o])||(i=getNumericComparableValue(t[e][o]),isNaN(i))?a[r]={name:o,value:t[e][o],flag:"false"}:a[r]={name:o,value:t[e][o],flag:"true"},r++);return a},TreeMapChart.prototype.getSeriesDataForCommaSperator=function(t){var e,i,a=getCopyOfJsonObject(t);for(e in a)for(var r in a[e])"none"==this.m_hierarchyTypeArr[r]&&(+a[e][r]<0||""==a[e][r]?a[e][r]=0:isNaN(a[e][r])&&(i=a[e][r],a[e][r]=i));return a},TreeMapChart.prototype.initializeColor=function(){for(var t=this.m_colors.split(","),e=0,i=this.m_range.length;e<i;e++)null!=t[e]?this.m_color[e]=convertColorToHex(t[e]):this.m_color[e]=this.m_color[e-1]},TreeMapChart.prototype.createColorRange=function(){this.m_width;if(this.m_minRange=[this.m_range1.min(),this.m_range2.min()].min(),this.m_maxRange=[this.m_range1.max(),this.m_range2.max()].max(),this.m_treeMapColorValue=[{val:1,color:"#FFFFFF",min:0,max:0}],IsBoolean(this.m_showdynamicrange)){this.setMinMaxValueFromSeriesData();var t=[];t[0]=this.m_minrangecolor,t[1]=this.m_maxrangecolor;for(e=0,i=t.length;e<i;e++)this.m_treeMapColorValue[e]={val:r=0==e?0:e==t.length-1?1:e/(t.length-1),color:t[e],min:this.serMinVal,max:this.serMaxVal}}else if(0<this.m_range.length)if(1==this.m_range.length)for(var e=0,i=this.m_range.length;e<i;e++){o=Math.abs(this.m_range1[e]),s=Math.abs(this.m_range2[e]);this.m_treeMapColorValue[0]={val:0,color:IsBoolean(this.m_highervaluesaregood)?ColorLuminance(this.m_color[e],.75):this.m_color[e],min:o,max:s}}else for(var e=0,i=this.m_range.length;e<i;e++){var a,r,o=Math.abs(this.m_range1[e]),s=Math.abs(this.m_range2[e]);r=0==e?0:e!=this.m_range.length-1&&(a=o+Math.abs(s-o)/2,(r=0<this.m_maxRange?a/this.m_maxRange:e/(this.m_range.length-1))<=1)?r:1,this.m_treeMapColorValue[e]={val:r,color:this.m_color[e],min:o,max:s}}},TreeMapChart.prototype.getRanges=function(){this.m_range=""!=this.m_ranges?this.m_ranges.split(","):[];for(var t=0,e=this.m_range.length;t<e;t++){var i=-1<this.m_range[t].indexOf("~")?"~":"-",i=this.m_range[t].split(i);this.m_range1[t]=+i[0],this.m_range2[t]=+i[1]}Array.prototype.max=function(){return 0!=this.length?Math.max.apply(null,this):0},Array.prototype.min=function(){return 0!=this.length?Math.min.apply(null,this):0},this.m_minRangeValue=[this.m_range1.min(),this.m_range2.min()].min(),this.m_maxRangeValue=[this.m_range1.max(),this.m_range2.max()].max()},TreeMapChart.prototype.setSeriesData=function(){this.m_seriesData=[],this.m_seriesColorValueArr=[],this.m_seriesColorNameArr=[];for(var t=0,e=0,i=this.getSeriesNames().length;e<i;e++)this.m_seriesData[e]=this.getDataFromJSON(this.getSeriesNames()[e]),"none"==this.m_hierarchyTypeArr[this.getSeriesNames()[e]]&&(this.m_seriesColorValueArr[t]=this.getDataFromJSON(this.getSeriesNames()[e]),this.m_seriesColorNameArr[t]=this.getSeriesNames()[e],this.m_leafNodeSeriesDataFlag=!0,t++),"parent"==this.m_hierarchyTypeArr[this.getSeriesNames()[e]]&&(this.m_parentNodeSeriesDataFlag=!0),"child"==this.m_hierarchyTypeArr[this.getSeriesNames()[e]]&&(this.m_childNodeSeriesDataFlag=!0)},TreeMapChart.prototype.setCategoryData=function(){this.m_categoryData=[];for(var t=0,e=this.getCategoryNames().length;t<e;t++)this.m_categoryData[t]=this.getDataFromJSON(this.getCategoryNames()[t])},TreeMapChart.prototype.drawChart=function(){this.ctx.clearRect(this.m_x,this.m_y,this.m_width,this.m_height),this.drawChartFrame(),this.drawTitle(),this.drawSubTitle();var t=this.IsDrawingPossible();IsBoolean(t.permission)?($("#treemapDiv"+this.m_objectid).remove(),this.drawTreeMap()):($("#treemapDiv"+this.m_objectid).remove(),$("#draggableCanvas"+this.m_objectid).css("display","block"),this.drawMessage(t.message))},TreeMapChart.prototype.IsDrawingPossible=function(){return IsBoolean(this.m_isEmptySeries)?{permission:"false",message:this.m_status.noData}:!IsBoolean(this.m_leafNodeSeriesDataFlag)||IsBoolean(this.m_parentNodeSeriesDataFlag)||IsBoolean(this.m_childNodeSeriesDataFlag)?!IsBoolean(this.m_leafNodeSeriesDataFlag)&&IsBoolean(this.m_parentNodeSeriesDataFlag)&&IsBoolean(this.m_childNodeSeriesDataFlag)?{permission:"false",message:this.m_status.noLeafNodeData}:{permission:"true",message:this.m_status.success}:{permission:"false",message:this.m_status.noParentChildData}},TreeMapChart.prototype.convertDataIntoJson=function(t,r,o){var e={};if(t){var e={name:"root",id:"node",size:[1],color:[1],value:0,children:[]},c=[],f=[],y=[],b=[],N=[],T=[];this.levels=[],this.leafNodeDetails=[],this.colorNodeDetails=[];for(var i=0,a=this.m_seriesName.length;i<a;i++)"parent"==this.m_hierarchyTypeArr[this.m_seriesName[i]]||"child"==this.m_hierarchyTypeArr[this.m_seriesName[i]]?(c.push(this.m_seriesName[i]),f.push(this.m_displayNames[i])):(y.push(this.m_seriesName[i]),b.push(this.m_displayNames[i]),""!=this.m_colorField[this.m_seriesName[i]]&&N.push(this.m_colorField[this.m_seriesName[i]]),T.push(this.m_AdditionalDataField[this.m_seriesName[i]]));this.levels=c,this.leafNodeDetails=y,this.colorNodeDetails=N;t.forEach(function(_){var g,u=e.children;c.forEach(function(i,t){var a,e;if(u.forEach(function(t,e){_[i]==t.name&&(a=e)}),isNaN(a)&&(e=g&&g.id?g.id+"_"+u.length:"node_"+u.length,u.push({name:null!=_[i]?_[i]:"",fieldname:c[t],fielddisplayname:f[t],id:e,size:[0],color:[0],value:0,leafnode:!1,children:[],drillData:_}),a=u.length-1),g=u[a],u=u[a].children,t===c.length-1){var r=0;y.forEach(function(t){r=+r+getNumericComparableValue(_[t])});for(var o=0,s=y.length;o<s;o++){for(var n=[],l=isNaN(_[y[o]])?removeCommaFromSrting(_[y[o]]):_[y[o]],m=getNumericComparableValue(l),l=(m=isNaN(m)?"":getNumericComparableValue(l),_[y[o]]),h=0;T[o].length>h;h++){var p=T[o][h];n.push(_[p])}var d=getNumericComparableValue(_[N[o]]),m={id:g.id+"_"+u.length+"_"+o,size:[m/r],value:m,colorfield:N[o],colorvalue:d,color:[0],name:l,leafnode:!0,fieldname:y[o],fielddisplayname:b[o],AdditionalDataLabel:n,drillData:_};u.push(m)}}})})}var s,t=function t(e,i){if(0<i){for(var a=0,r=0;r<e.length;r++){var o=t(e[r].children,i-1);a+=+(e[r].value=o)}return a}for(o=0,r=0;r<e.length;r++)o+=+e[r].value;return isNaN(o)||null==o||""==o?0:o}(e.children,c.length),n=(e.value=t,0!=this.m_maxRangeValue&&this.m_maxRangeValue,this.m_minrangecolor),l=this.m_maxrangecolor;this.m_colorField;function m(t){if(t.children)for(var e=t.value,i=0;i<t.children.length;i++){var a=t.children[i];a.size=[0!=e?a.value/e:0],a.color=[function(t){for(var e,i=null!=t.colorvalue?getNumericComparableValue(t.colorvalue):getNumericComparableValue(t.value),a=0;a<r.length;a++)if(i>=+r[a].min&&i<+r[a].max)return IsBoolean(o.m_showdynamicrange)?1<(e=(i-r[a].min)/(r[r.length-1].max-r[a].min))?1:e:r[a].val;return i<+r[0].min?IsBoolean(o.m_showdynamicrange)?r[0].val:n:i>=+r[r.length-1].max?IsBoolean(o.m_showdynamicrange)?r[r.length-1].val:l:void 0}(a)],m(a)}else s=+t.value>=+s?+t.value:+s}return 1<=c.length&&1<y.length?m(e):1==y.length&&(parentVal=e.value,s=1,m(e),parentVal=s,m(e)),e},TreeMapChart.prototype.drawChartFrame=function(){this.m_chartFrame.drawFrame()},TreeMapChart.prototype.drawTitle=function(){this.m_title.draw()},TreeMapChart.prototype.drawSubTitle=function(){this.m_subTitle.draw()},TreeMapChart.prototype.setUnitSymbol=function(){this.m_unitSymbol=this.m_util.getFormatterSymbol(this.m_formater,this.m_unit),""==this.m_signposition&&(this.m_signposition="suffix"),this.m_isFormatter=!1,"none"!=this.m_formater&&""!=this.m_formater&&"none"!=this.m_unit&&""!=this.m_unit&&(this.m_isFormatter=!0)},TreeMapChart.prototype.setSecondaryUnitSymbol=function(){this.m_secondaryUnitSymbol=this.m_util.getFormatterSymbol(this.m_secondaryformater,this.m_secondaryunit),this.m_secondaryFormatterPosition="suffix",this.m_isSecondaryFormatter=!1,"none"!=this.m_secondaryformater&&""!=this.m_secondaryformater&&""!=this.m_secondaryunit&&"none"!=this.m_secondaryunit&&(this.m_isSecondaryFormatter=!0)},TreeMapChart.prototype.addSecondaryFormater=function(text,secondaryUnitSymbol){var textValue=text;0!=this.m_precision&&null!=this.m_precision?textValue=this.setPrecision(textValue,this.m_precision):textValue<1&&textValue%1!=0&&(textValue=this.setPrecision(textValue,2));try{eval("var formattedText = this.m_util.addUnitAs"+this.m_secondaryFormatterPosition+"(textValue,secondaryUnitSymbol);")}catch(e){}return formattedText.toString()},TreeMapChart.prototype.getFormattedText=function(t){var e,i,a=0<(""+t).indexOf(","),t=+getNumericComparableValue(t);return IsBoolean(this.getFixedLabel())||("none"!=this.m_formater&&""!=this.m_formater||"none"!=this.m_secondaryformater&&""!=this.m_secondaryformater||IsBoolean(this.m_fixedlabel)||(t=this.setPrecision(t,this.m_precision)),IsBoolean(this.m_isFormatter)||IsBoolean(this.m_isSecondaryFormatter)||(t=this.setPrecision(t,this.m_precision)),IsBoolean(this.m_isSecondaryFormatter)&&(t=this.m_util.updateTextWithFormatter(t,this.m_secondaryUnitSymbol,this.m_precision)),IsBoolean(this.m_isSecondaryFormatter)&&(t="auto"!=this.m_secondaryUnitSymbol?this.addSecondaryFormater(t,this.m_secondaryUnitSymbol):(e=getNumberFormattedSymbol(+t,this.m_unit),i=getNumberFormattedNumericValue(+t,this.m_precision,this.m_unit),t=this.setPrecision(i,this.m_precision),this.addSecondaryFormater(t,e))),IsBoolean(this.m_isSecondaryFormatter))||(t=this.setPrecision(t,this.m_precision)),t=a||"number"===this.m_numberformatter?getFormattedNumberWithCommas(t,"number"):getFormattedNumberWithCommas(t,this.m_numberformatter),t=IsBoolean(this.m_isFormatter)&&null!=this.m_unitSymbol?this.m_util.addFormatter(t,this.m_unitSymbol,this.m_signposition):t},TreeMapChart.prototype.setPrecision=function(t,e){return 0!==t&&"default"!==e?(+t).toFixed(e):+t},TreeMapChart.prototype.getCommaSeperator=function(t,e){for(var i=0,a=this.m_seriesDataForToolTip.length;i<a;i++)for(var r in this.m_seriesDataForToolTip)for(var o in this.m_seriesDataForToolTip[r])this.m_seriesDataForToolTip[r][o]==e&&IsBoolean(this.m_seriesDataForToolTip[r].flag)&&(t=this.getNumberWithCommas(t));return t},TreeMapChart.prototype.getFormatterForToolTip=function(data){if(data=getNumericComparableValue(data),isNaN(data)||""==data||null==data)return data;var m_precision,m_precision="default"!==this.m_tooltipprecision?this.m_tooltipprecision:(m_precision=(data+"").split("."),void 0!==m_precision[1]?m_precision[1].length:0);if(m_precision=this.m_tooltipprecision,IsBoolean(this.m_isSecondaryFormatter)&&!IsBoolean(this.m_showcelltext))if("auto"!=this.m_secondaryUnitSymbol)try{data=this.m_util.updateTextWithFormatter(data,this.m_secondaryUnitSymbol,m_precision),eval("data = this.m_util.addUnitAs"+this.m_secondaryFormatterPosition+"(data,this.m_secondaryUnitSymbol);")}catch(e){}else{var symbol=getNumberFormattedSymbol(+data,this.m_unit);data=getNumberFormattedNumericValue(+data,m_precision,this.m_unit),eval("data = this.m_util.addUnitAs"+this.m_secondaryFormatterPosition+"(data,symbol);")}else if("auto"!=this.m_secondaryUnitSymbol)try{data=this.m_util.updateTextWithFormatter(data,this.m_secondaryUnitSymbol,m_precision),eval("data = this.m_util.addUnitAs"+this.m_secondaryFormatterPosition+"(data,this.m_secondaryUnitSymbol);")}catch(e){}else{var symbol=getNumberFormattedSymbol(+data,this.m_unit);data=getNumberFormattedNumericValue(+data,m_precision,this.m_unit),eval("data = this.m_util.addUnitAs"+this.m_secondaryFormatterPosition+"(data,symbol);")}return IsBoolean(this.m_isFormatter)&&null!=this.m_unitSymbol?this.m_util.addFormatter(data,this.m_unitSymbol,this.m_signposition,m_precision):data},TreeMapChart.prototype.drawTreeMap=function(){var N=this,t=+this.m_width,e=+this.getMarginForTitle()+ +this.getMarginForSubTitle(),i=this.m_height-e,a=(IsBoolean(this.getShowGradient())||IsBoolean(this.m_showmaximizebutton)||IsBoolean(this.getTitle().m_showtitle)||IsBoolean(this.m_subTitle.m_showsubtitle)?$("#draggableCanvas"+N.m_objectid).css("display","block"):$("#draggableCanvas"+N.m_objectid).css("display","none"),$("#treemapDiv"+N.m_objectid).remove(),IsBoolean(this.m_updateddesign)?32:0),r=document.createElement("div"),e=(r.id="treemapDiv"+this.m_objectid,r.style.width=t+"px",r.style.height=i+"px",r.style.top=e+"px",r.style.left=a+"px",IsBoolean(this.m_bootstrap)||(r.style.position="absolute"),$("#draggableDiv"+N.m_objectid).append(r),this.m_treeMapColorValue),a=this.convertDataIntoJson(this.getSeriesDataForCommaSperator(this.getDataProvider()),e,N),r=!detectDevice.mobile()&&!detectDevice.tablet(),t=IsBoolean(this.m_updateddesign)?t-64:t,i=IsBoolean(this.m_updateddesign)?i-32:i;$("#treemapDiv"+this.m_objectid).treemap({dimensions:[t,i],desktopView:r,singleClickTimer:null,doubletapTimeout:N.m_doubletaptimeout,colorStops:e,leafNodeBodyStrokeLineWidth:N.m_bodystrokecolorlinewidth,innerNodeHeaderHeightPx:N.getShowTextOnHeader()?0:N.fontScaling(1.8*N.getLabelFontSize()),innerNodeHeaderGradient:function(t,e,i){return N.m_headerbgcolor},leafNodeBodyGradient:function(t,e,i){null==i[0]&&null==i[1]&&null==i[2]&&(r=(r=hex2rgb(N.m_defaultfillcolor)).substring(r.indexOf("(")+1,r.length-1).split(", "),i[0]=r[0],i[1]=r[1],i[2]=r[2]);var a,r=TreemapUtils.rgb2hex(i);try{isNaN(e[0])||isNaN(e[1])||isNaN(e[2])||isNaN(e[3])||(r=t.createLinearGradient(e[0],e[1],+e[0]+ +e[2],e[3]),a=hex2rgb(TreemapUtils.rgb2hex(i),N.m_coloropacity),r.addColorStop(0,a),r.addColorStop(1,a))}catch(t){}return r},leafNodeBodyStroke:function(t,e,i){return N.m_bodystrokecolor},innerNodeHeaderLabeller:function(t,e,i,a){var r="";N.headerNodeName=a,IsBoolean(N.m_showparenttext)&&""!==(r=a)&&!isNaN(a)&&0<N.m_fieldByName.length&&IsBoolean(N.m_showparenttextformatter)&&N.getFormattedText(a),t.rect(e[0],e[1],e[2],e[3]),t.clip(),t.fillStyle=N.m_celltextcolor,t.font=N.getLabelFontProperties(),t.textBaseline="middle",t.measureText(r).width<=e[2]&&t.fillText(r,e[0]+5,+e[1]+e[3]/2)},leafNodeBodyLabeller:function(t,e,i,a,r){var o=[];N.m_copytext="",a=IsBoolean(N.m_showcelltext)?a:"",o=IsBoolean(N.m_showcelltext)&&void 0!==r?r:[],r=IsBoolean(N.getShowTextOnHeader())?N.headerNodeName:a,t.textBaseline="top",t.rect(e[0],e[1],e[2]+5,e[3]),t.clip();try{t.fillStyle=N.m_celltextcolor,t.font=N.getLabelFontProperties();var s=""!==r&&!isNaN(r)&&0<N.m_fieldByName.length&&IsBoolean(N.m_showparenttextformatter)?N.getFormattedText(r):r,n="center"==N.m_position?3*e[2]/4:e[2],l=N.getUpdateText(s,n,t.font),m=l.Text.length,h=l.isSentenceCase,p=IsBoolean(h)?m<6:m<4,d="bottomleft"==N.m_position||"bottomright"==N.m_position?m+o.length:0;if(IsBoolean(N.m_showparentdatalabel)&&p)for(var _=0;_<m;_++){""!==N.m_copytext&&(l.Text.pop(),l.Text.unshift(N.m_copytext));var g=t.measureText(l.Text[_]).width,u="bottomleft"==N.m_position||"bottomright"==N.m_position?d-_:_;N.labelPosition(N,t,e,l.Text[_],g,u)}}catch(t){}for(var c=0;o.length>c;c++){""!==N.m_copytext&&(o.pop(),o.unshift(N.m_copytext)),o[c]=""===o[c]||isNaN(getNumericComparableValue(o[c]))?o[c]:N.getFormattedText(o[c]);var f,y=N.getUpdateText(o[c],n,t.font),b=(y.Text[0]=1<y.Text.length?y.Text[0].slice(0,-1)+"..":y.Text[0],t.measureText(o[c]).width),n="center"==N.m_position?3*e[2]/4:e[2];N.getShowTextOnHeader()&&e[2]>15+N.m_leftpadding+N.m_rightpadding&&m<4&&2*N.getLabelFontSize()+e[3]/2<=e[3]-N.m_toppadding&&(f="bottomleft"==N.m_position||"bottomright"==N.m_position?o.length-c:0!==m?m+c:c,b=(""==N.m_copytext?t.measureText(y.Text[0]):t.measureText(N.m_copytext)).width,N.labelPosition(N,t,e,y.Text[0],b,f))}},sizeOption:0,colorOption:0,labelsEnabled:!0,animationEnabled:!0,animationDurationMs:2e3,nodeData:a}).bind("treemapmousemove",function(t,e){var i=this;IsBoolean("None"!==i.m_customtextboxfortooltip.dataTipType)&&!i.m_designMode&&(e=i.getToolTipData(e,t),i.m_hovercallback&&""!=i.m_hovercallback?i.drawCallBackContent(mouseX,mouseY,e):i.drawTooltipContent(e))}.bind(N)).bind("treemapclick",function(t,e){this.getDrillData(t,e)}.bind(N)).bind("treemaptouchstart",function(t,e){"ontouchstart"in document.documentElement&&void 0!==e&&this.getDrillData(t,e)}.bind(N)).bind("touchend",function(){}).mouseleave(function(){$("#toolTipDiv").remove()})},TreeMapChart.prototype.getDrillData=function(t,e){for(var i,a=this,r=e.nodes,o={},s=r.length-1;0<=s;s--)if(0==s&&IsBoolean(r[s].leafnode)){for(var n=0;a.m_seriesName.length>n;n++)o[a.m_allSeriesNames[n]]=r[s].drillData[a.m_allSeriesNames[n]];i=rgb2hex("rgb("+r[s].computedColor[0]+","+r[s].computedColor[1]+","+r[s].computedColor[2]+")")}else for(n=0;a.m_allSeriesNames.length>n;n++)o[a.m_allSeriesNames[n]]=r[s].drillData[a.m_allSeriesNames[n]];a.updateDataPointsToGV({drillRecord:o,drillColor:null!=i?i:""})},TreeMapChart.prototype.labelPosition=function(t,e,i,a,r,o){switch(t.m_position){case"topleft":l=i[0]+t.m_leftpadding,(n=i[1]+(+t.getLabelFontSize()+t.m_toppadding)*o+t.m_toppadding)<i[1]+i[3]-this.m_bottompadding-+t.getLabelFontSize()&&e.fillText(a,l,n);break;case"topright":l=i[0]+i[2]-r-t.m_leftpadding,(n=i[1]+(+t.getLabelFontSize()+t.m_toppadding)*o+t.m_toppadding)<i[1]+i[3]-this.m_bottompadding-+t.getLabelFontSize()&&e.fillText(a,l,n);break;case"bottomleft":var s,n,l=i[0]+t.m_leftpadding;(n=i[1]+i[3]-(+t.getLabelFontSize()+t.m_toppadding)*o-t.m_toppadding-t.m_toppadding)>i[1]+this.m_toppadding+ +t.getLabelFontSize()?(s=""===t.m_copytext?a:t.m_copytext,e.fillText(s,l,n),t.m_copytext=""):t.m_copytext=a;break;case"bottomright":l=i[0]+i[2]-r-t.m_leftpadding,(n=i[1]+i[3]-(+t.getLabelFontSize()+t.m_toppadding)*o-t.m_toppadding-t.m_toppadding)>i[1]+this.m_toppadding+ +t.getLabelFontSize()?(s=""===t.m_copytext?a:t.m_copytext,e.textAlign="left",e.fillText(s,l,n),t.m_copytext=""):t.m_copytext=a;break;default:l=i[0]+i[2]/2,(n=i[1]+i[3]/2-+t.getLabelFontSize()+(+t.getLabelFontSize()+t.m_toppadding)*o)<i[1]+i[3]-this.m_bottompadding-+t.getLabelFontSize()&&n>i[1]+this.m_toppadding+ +t.getLabelFontSize()?(s=""===t.m_copytext?a:t.m_copytext,e.textAlign="center",e.fillText(s,l,n),t.m_copytext=""):t.m_copytext=a}},TreeMapChart.prototype.getUpdateText=function(t,e,i){for(var a=""+t,r="",o=[],s=(this.ctx.font=i,0),i=this.ctx.measureText(a).width,n=0<a.length?i/a.length:0,i=a.split(" "),l=0,m=a.length;l<m;l++){if(!(this.ctx.measureText(r).width<e-n-(this.m_leftpadding+this.m_rightpadding))){o.push(r=""!==r?r+"..":r);break}r+=a[l],this.ctx.measureText(r).width>=e-n-(this.m_leftpadding+this.m_rightpadding)&&isNaN(t)&&(o.push(l==m-1?r:r+"-"),r=""),l+1==m&&""!==r&&o.push(r),s++}return{Text:o=0==o.length&&0<t.length?o.push(t):o,noOfWord:s,isSentenceCase:1<i.length}},TreeMapChart.prototype.getwidthForTextLen=function(t,e){var i=t/2;return t-2*(i-(i-e/2))},TreeMapChart.prototype.getToolTipData=function(t,e){var i=t.nodes,a=(t.ids,{});if(IsBoolean("Default"==this.m_customtextboxfortooltip.dataTipType)){a.cat="",a.data=new Array;for(var r=i.length-1;0<=r;r--){var o,t=[];0==r?(t=[],void 0===i[r].colorfield&&i[r].leafnode&&t.push("rgb("+i[r].computedColor[0]+","+i[r].computedColor[1]+","+i[r].computedColor[2]+")"),t.push(i[r].fielddisplayname),t.push(i[r].leafnode?this.getUpdatedFormatterForToolTip(i[r].value,i[r].fielddisplayname):i[r].name),a.data.push(t),i[r].leafnode&&i[r].colorfield&&(o=null!=i[r].colorfield?i[r].colorfield:i[r].fielddisplayname,(t=[]).push("rgb("+i[r].computedColor[0]+","+i[r].computedColor[1]+","+i[r].computedColor[2]+")"),t.push(o),t.push(this.getFormatterForToolTip(null!=i[r].colorvalue?i[r].colorvalue:i[r].value)),a.data.push(t))):(t.push(i[r].fielddisplayname),t.push(i[r].name),a.data.push(t))}}else a=i[0].drillData;return a},TreeMapChart.prototype.drawTooltipContent=function(t){this.m_tooltip.draw(t,this.m_componenttype)},TreeMapChart.prototype.getShowTextOnHeader=function(){if(1==this.levels.length)return!0},TreeMapChart.prototype.getLabelFontProperties=function(){return this.m_textUtil.getFontProperties(this.getLabelFontStyle(),this.getLabelFontWeight(),this.fontScaling(this.getLabelFontSize()),this.getLabelFontFamily())},TreeMapChart.prototype.getLabelFontStyle=function(){return this.m_celltextfontstyle},TreeMapChart.prototype.getLabelFontWeight=function(){return this.m_celltextfontweight},TreeMapChart.prototype.getLabelFontSize=function(){return this.m_celltextfontsize},TreeMapChart.prototype.getLabelFontFamily=function(){return this.m_celltextfontfamily},TreeMapChart.prototype.getStartY=function(){return+this.m_y+ +this.m_height},TreeMapChart.prototype.getEndX=function(){return+this.m_x+ +this.m_width},TreeMapChart.prototype.getStartX=function(){return this.m_x},TreeMapChart.prototype.getEndY=function(){return this.m_y+ +this.getMarginForTitle()+ +this.getMarginForSubTitle()},TreeMapChart.prototype.getMarginForTitle=function(){return IsBoolean(this.getShowGradient())||IsBoolean(this.m_showmaximizebutton)||IsBoolean(this.getTitle().m_showtitle)?+this.getTitleBarHeight()+ +this.getTitleToSubtitleMargin():0},TreeMapChart.prototype.getMarginForSubTitle=function(){return IsBoolean(this.m_subTitle.m_showsubtitle)&&IsBoolean(this.m_enablehtmlformate.subtitle)?$("#subTitle"+this.m_objectid).height():IsBoolean(this.m_subTitle.m_showsubtitle)&&3==this.m_subTitle.m_formattedDescription.length?margin=""!=this.m_subTitle.getDescription()?3*this.m_subTitle.getFontSize()+ +this.m_chartpaddings.bottomBorderToDescription:10:IsBoolean(this.m_subTitle.m_showsubtitle)&&""!=this.m_subTitle.getDescription()?1.5*this.m_subTitle.getFontSize():0},TreeMapChart.prototype.getDataPointAndUpdateGlobalVariable=function(t,e){},TreeMapChart.prototype.drawTooltip=function(t,e){};
//# sourceMappingURL=TreeMapChart.min.js.map