/*! BDB Charting Library V10.0.0 (2025-08-14 11:37:12) 
 Copyright 2015-2024 BDB (BizViz Technologies Pvt Ltd). All Rights Reserved */
function DecompositionChart(t,e){this.base=Chart,this.base(),this.m_x=680,this.m_y=320,this.m_width=300,this.m_height=260,this.m_barWidth=10,this.m_categoryData=[],this.m_seriesData=[],this.m_categoryNames=[],this.m_seriesNames=[],this.m_barSeriesArray=[],this.m_xPositionArray=[],this.m_yPositionArray=[],this.m_barWidth="",this.m_barHeightArray=[],this.m_seriesVisiblityPosition,this.m_showpercentvalue=!1,this.m_showmarkingorpercentvalue=!1,this.m_showPercentValueFlag=!0,this.m_seriesInitializeFlag=!0,this.noOfRows=1,this.borderToChartMargin=50,this.m_title=new svgTitle(this),this.m_subTitle=new svgSubTitle,this.m_showcontextlevels="false",this.m_showpercentage="true",this.m_aggregationtype="sum",this.m_maxnodes="10",this.m_nodecolor="#f5f5f5",this.m_fillcolor="#0d78bf",this.m_strokecolor="#000000",this.m_nodeheight=30,this.m_labelfontcolor="#000000",this.m_labelfontsize="12",this.m_labelfontstyle="normal",this.m_labelfontweight="normal",this.m_labelfontfamily="BizvizFont",this.m_labelvaluefontcolor="#000000",this.m_labelvaluefontsize="12",this.m_labelvaluefontstyle="normal",this.m_labelvaluefontweight="normal",this.m_labelvaluefontfamily="BizvizFont",this.m_arrowstrokewidth="1",this.m_arrowstrokecolor="",this.m_arrowsize="10",this.m_isvalidconfiguration=!1,this.m_contextseriesfields=[],this.m_updatedhierarchylevel={},this.uparrow={},this.lastLevel={},this.m_drawnode={},this.m_chartContainer=t,this.m_zIndex=e,this.m_showhorizontalmarkerline=!1,this.m_maxbarwidth=40,this.m_enableanimation="true",this.m_baranimationduration=.5,this.m_stackborderwidth="0",this.m_stackbordercolor="#ffffff",this.m_enablestackshadow="false",this.m_stackshadowcolor="#000000",this.m_stackshadowopacity="0.3",this.m_canvastype="svg",this.m_stacksvgtype="rect",this.m_showpercentage="false",this.m_controlbarwidth="auto",this.m_stackborderradius="0",this.m_yaxislabellines="2",this.enableDrillHighlighter="false",this.m_drilltoggle=!0,this.m_lineform="curve",this.m_type="Line",this.leftAxisInfo={max:350,min:0}}function DSLineSeries(){this.color,this.width,this.xPositionArray=[],this.yPositionArray=[],this.line=[],this.ctx="",this.m_chart="",this.seriesName="",this.basePoint=""}DecompositionChart.prototype=new Chart,DecompositionChart.prototype.setProperty=function(t){this.ParseJsonAttributes(t.Object,this),this.initCanvas()},DecompositionChart.prototype.ParseJsonAttributes=function(t,e){for(var i in this.chartJson=t)if("Chart"==i)for(var r in t[i])switch(r){case"xAxis":for(var s in t[i][r]){var a=this.getNodeAttributeName(s);e.m_xAxis[a]=t[i][r][s]}break;case"yAxis":for(var o in t[i][r]){var a=this.getNodeAttributeName(o);e.m_yAxis[a]=t[i][r][o]}break;case"Title":for(var n in t[i][r]){var a=this.getNodeAttributeName(n);e.m_title[a]=t[i][r][n]}break;case"SubTitle":for(var h in t[i][r]){a=this.getNodeAttributeName(h);e.m_subTitle[a]=t[i][r][h]}break;case"CategoryColors":var l,m=new CategoryColors;for(l in this.setCategoryColors(m),t[i][r])if("CategoryColor"===l){var d=this.getArrayOfSingleLengthJson(t[i][r][l]);m.cateogryNameColorMap=new Object;for(var c=0;c<d.length;c++){var p,_=new CategoryColor;for(p in m.setCategoryColor(_),d[c])_[a=this.getNodeAttributeName(p)]=d[c][p];m.cateogryNameColorMap[_.getCategoryName()]=_.getColor()}}else{a=this.getNodeAttributeName(l);e.m_categoryColors[a]=t[i][r][l]}m.setCategoryDefaultColorSet();break;case"ConditionalColors":if(""!=t[i][r])for(var g=new ConditionalColors,u=(this.setConditionalColors(g),this.getArrayOfSingleLengthJson(t[i][r].ConditionalColor)),c=0;c<u.length;c++){var y,f=new ConditionalColor;for(y in g.setConditionalColor(f),u[c])f[a=this.getNodeAttributeName(y)]=u[c][y]}break;default:e[a=this.getNodeAttributeName(r)]=t[i][r]}else e[a=this.getNodeAttributeName(i)]=t[i]},DecompositionChart.prototype.getDataProvider=function(){return this.m_dataProvider},DecompositionChart.prototype.getCategoryNames=function(){return this.m_categoryNames},DecompositionChart.prototype.getCategoryDisplayNames=function(){return this.m_categoryDisplayNames},DecompositionChart.prototype.setStartX=function(){this.m_startX=+this.m_x+ +this.borderToChartMargin},DecompositionChart.prototype.getLeftSpace=function(){var t=this.getUnitValue(),t=this.getCalculatedSpace(t);return(+this.getPrecisionSpace()+ +t)/2},DecompositionChart.prototype.getLeftLabelSpace=function(){var t=0;return this.setLabelWidth(),t=IsBoolean(this.m_xAxis.getLabelTilted())&&-70<+this.m_xAxis.m_labelrotation&&this.m_xAxis.m_labelrotation<0?this.getLabelWidth()/2+this.getLabelPrecisionMargin()/2+this.getLabelSecondFormatterMargin()/2:t},DecompositionChart.prototype.getYAxisLabelMargin=function(){var t=0;if(this.ctx.font=this.m_yAxis.m_labelfontstyle+" "+this.m_yAxis.m_labelfontweight+" "+this.fontScaling(this.m_yAxis.m_labelfontsize)+"px "+selectGlobalFont(this.m_yAxis.m_labelfontfamily),!IsBoolean(this.isEmptyCategory)){for(var t=this.ctx.measureText(this.m_categoryData[0][0]).width,e=1,i=this.m_categoryData[0].length;e<i;e++)t<this.ctx.measureText(this.m_categoryData[0][e]).width&&(t=this.ctx.measureText(this.m_categoryData[0][e]).width);t>this.m_width/4&&(t=this.m_width/4)}return t},DecompositionChart.prototype.setStartY=function(){var t=this.getChartMargin();this.m_startY=+this.m_y+ +this.m_height-+t},DecompositionChart.prototype.getXAxisLabelMarginForBar=function(){var t,e,i,r,s,a;return this.noOfRows=1,a=(s=IsBoolean(this.m_xAxis.getLabelTilted())?(t=this.getLabelFormatterMargin(),e=this.getLabelWidth(),i=this.getLabelSignMargin(),r=this.getLabelPrecisionMargin(),this.getLabelSecondFormatterMargin()):(this.noOfRows=this.setNumberOfRows(),t=0,e=1.5*this.fontScaling(this.m_xAxis.getLabelFontSize())*this.noOfRows,r=i=0),this.getXAxisDescriptionMargin()),+t+ +e+ +i+ +r+ +s+ +a},DecompositionChart.prototype.setNumberOfRows=function(){this.ctx.font=this.m_xAxis.m_labelfontstyle+" "+this.m_xAxis.m_labelfontweight+" "+this.fontScaling(this.m_xAxis.m_labelfontsize)+"px "+selectGlobalFont(this.m_xAxis.m_labelfontfamily);var t,e,i,r=1,s=(""+this.min).length<=(""+this.max).length?this.max:this.min;return IsBoolean(this.isEmptySeries)||(s="100%"==this.m_charttype?100:s,t=this.m_xAxisMarkersArray.length,t=(this.getEndX()-this.getStartX())/t,s=this.m_util.updateTextWithFormatter(s,"",this.m_precision),e=this.getUnitValue(),i=this.getSecondUnitValue(),this.ctx.measureText(s=s+""+e+(i="auto"==i?"K":i)).width>t&&(r="auto"==this.m_skipxaxislabels?2:1)),r},DecompositionChart.prototype.getSecondUnitValue=function(){var t="";return IsBoolean(this.m_fixedlabel)||IsBoolean(this.m_xAxis.getLeftaxisFormater())&&"none"!=this.getSecondaryFormater()&&""!=this.getSecondaryFormater()&&"none"!=this.getSecondaryUnit()&&""!=this.getSecondaryUnit()&&(t=this.m_util.getFormatterSymbol(this.getSecondaryFormater(),this.getSecondaryUnit())),t},DecompositionChart.prototype.getUnitValue=function(){var t="";return IsBoolean(this.m_fixedlabel)||IsBoolean(this.m_xAxis.getLeftaxisFormater())&&"none"!=this.m_formater&&""!=this.m_formater&&"none"!=this.m_unit&&""!=this.m_unit&&(t=this.m_util.getFormatterSymbol(this.m_formater,this.m_unit)),t},DecompositionChart.prototype.getLabelFormatterMargin=function(){var t,e=0;return IsBoolean(this.m_fixedlabel)||IsBoolean(this.m_xAxis.getLeftaxisFormater())&&"none"!=this.m_formater&&""!=this.m_formater&&"none"!=this.m_unit&&""!=this.m_unit&&(t=this.m_util.getFormatterSymbol(this.m_formater,this.m_unit),this.ctx.beginPath(),this.ctx.font=this.m_xAxis.getLabelFontWeight()+" "+this.m_xAxis.getLabelFontSize()+"px "+this.m_xAxis.getLabelFontFamily(),e=this.ctx.measureText(t).width,this.ctx.closePath()),e},DecompositionChart.prototype.getLabelWidth=function(){return this.m_labelwidth},DecompositionChart.prototype.setLabelWidth=function(){for(var t=[],e=this.m_labelwidth=0;e<this.m_xAxisMarkersArray.length;e++){var i,r="100%"==this.m_charttype?100:this.m_xAxisMarkersArray[e];IsBoolean(this.m_fixedlabel)||(IsBoolean(this.m_xAxis.getLeftaxisFormater())&&("none"!=this.getSecondaryFormater()&&""!=this.getSecondaryFormater()&&"none"!=this.getSecondaryUnit()&&""!=this.getSecondaryUnit()&&(i=this.m_util.getFormatterSymbol(this.getSecondaryFormater(),this.getSecondaryUnit()),"auto"==this.getSecondaryUnit()&&"Rupees"==this.m_unit?r=getNumberFormattedNumericValue(+r,this.m_precision,this.m_unit):"auto"==this.getSecondaryUnit()?r=getNumberFormattedNumericValue(+r):"none"!==this.getSecondaryUnit()&&(r=this.m_util.updateTextWithFormatter(r,i,this.m_precision))),0!==r)&&"default"!==this.m_precision&&(r=this.m_xAxis.setPrecision(r,this.m_precision)),r=getFormattedNumberWithCommas(r,this.m_numberformatter),this.ctx.beginPath(),this.ctx.font=this.m_xAxis.m_labelfontstyle+" "+this.m_xAxis.m_labelfontweight+" "+this.fontScaling(this.m_xAxis.m_labelfontsize)+"px "+selectGlobalFont(this.m_xAxis.m_labelfontfamily),t[e]=this.ctx.measureText(r).width,this.ctx.closePath())}this.m_labelwidth=getMaxValueFromArray(t)},DecompositionChart.prototype.getLabelSignMargin=function(){var t=0,e=0,i=this.min;return i<0&&(this.ctx.beginPath(),this.ctx.font=this.m_xAxis.getLabelFontWeight()+" "+this.fontScaling(this.m_xAxis.getLabelFontSize())+"px "+this.m_xAxis.getLabelFontFamily(),e=this.ctx.measureText(i).width,this.ctx.closePath()),t=this.getLabelWidth()<e?this.ctx.measureText("-").width:t},DecompositionChart.prototype.getLabelPrecisionMargin=function(){var t=5;if(!IsBoolean(this.m_fixedlabel)&&IsBoolean(this.m_xAxis.getLeftaxisFormater())&&"none"!=this.m_precision&&""!=this.m_precision&&0!=this.m_precision){this.ctx.beginPath(),this.ctx.font=this.m_xAxis.getLabelFontWeight()+" "+this.fontScaling(this.m_xAxis.getLabelFontSize())+"px "+this.m_xAxis.getLabelFontFamily();for(var e=".",i=0;i<this.m_precision;i++)e+="0";t=this.ctx.measureText(e).width,this.ctx.closePath()}return t},DecompositionChart.prototype.getLabelSecondFormatterMargin=function(){var t,e=0;return IsBoolean(this.m_fixedlabel)||IsBoolean(this.m_xAxis.getLeftaxisFormater())&&"none"!=this.getSecondaryFormater()&&""!=this.getSecondaryFormater()&&"none"!=this.getSecondaryUnit()&&""!=this.getSecondaryUnit()&&(t="auto"!=this.getSecondaryUnit()?this.m_util.getFormatterSymbol(this.getSecondaryFormater(),this.getSecondaryUnit()):"auto"==this.getSecondaryUnit()&&"Rupees"==this.m_unit?getNumberFormattedSymbol(+this.max,this.m_unit):"K",this.ctx.font=this.m_yAxis.m_fontstyle+" "+this.m_yAxis.m_fontweight+" "+this.fontScaling(this.m_yAxis.m_fontsize)+"px "+selectGlobalFont(this.m_yAxis.m_fontfamily),e=this.ctx.measureText(t).width),e},DecompositionChart.prototype.setEndX=function(){var t=this.getBorderToLegendMargin(),e=this.getVerticalLegendMargin(),i=this.getVerticalLegendToXAxisMargin();this.m_endX=+this.m_x+ +this.m_width-(+t+ +e+ +i)},DecompositionChart.prototype.getRightSpace=function(){var t=this.getPrecisionSpace(),e=this.getUnitValue(),i=this.getSecondUnitValue();return(+t+ +this.getCalculatedSpace(e)+ +this.getCalculatedSpace(i))/2},DecompositionChart.prototype.getCalculatedSpace=function(t){return this.ctx.measureText(t).width},DecompositionChart.prototype.getPrecisionSpace=function(){for(var t="",e=0;e<this.m_precision;e++)t+=0;return this.ctx.measureText(t).width},DecompositionChart.prototype.getRightLabelTextSpace=function(){var t=0;return t=IsBoolean(this.m_xAxis.getLabelTilted())&&0<+this.m_xAxis.m_labelrotation&&this.m_xAxis.m_labelrotation<80?+this.getLabelWidth()+ +this.getLabelPrecisionMargin()+this.getLabelSecondFormatterMargin()/2:t},DecompositionChart.prototype.setEndY=function(){this.m_endY=this.m_y+ +this.getMarginForTitle()+ +this.getMarginForSubTitle()+this.getMarginForTooltip()},DecompositionChart.prototype.getCounterFlagForSeriesVisiblity=function(){for(var t=0,e=0,i=this.m_seriesData.length;e<i;e++)IsBoolean(this.m_seriesVisibleArr[this.m_seriesNames[e]])&&(t++,this.m_seriesVisiblityPosition=e);return 1==t},DecompositionChart.prototype.setFields=function(t){for(var e=[],i=[],r=0,s=(this.m_fieldsJson=t).length;r<s;r++)switch(this.getProperAttributeNameValue(t[r],"Type")){case"Category":e.push(t[r]);break;case"Series":case"CalculatedField":i.push(t[r])}this.setCategory(e),this.setSeries(i)},DecompositionChart.prototype.setCategory=function(t){this.m_categoryNames=[],this.m_categoryFieldColor=[],this.m_categoryDisplayNames=[],this.m_allCategoryNames=[],this.m_allCategoryDisplayNames=[],this.m_categoryVisibleArr={};for(var e=0,i=0,r=t.length;i<r;i++){this.m_allCategoryNames[i]=this.getProperAttributeNameValue(t[i],"Name");var s=this.formattedDescription(this,this.getProperAttributeNameValue(t[i],"DisplayName"));this.m_allCategoryDisplayNames[i]=s,this.m_categoryVisibleArr[this.m_allCategoryDisplayNames[i]]=this.getProperAttributeNameValue(t[i],"visible"),IsBoolean(this.m_categoryVisibleArr[this.m_allCategoryDisplayNames[i]])&&0==this.m_categoryNames.length&&(this.m_categoryNames[e]=this.getProperAttributeNameValue(t[i],"Name"),this.m_categoryDisplayNames[e]=s,this.m_categoryFieldColor[e]=this.getProperAttributeNameValue(t[i],"Color"),e++)}},DecompositionChart.prototype.setSeries=function(t){this.m_seriesNames=[],this.m_seriesDisplayNames=[],this.m_seriesColors=[],this.m_legendNames=[],this.m_seriesVisibleArr={},this.m_allSeriesDisplayNames=[],this.m_allSeriesNames=[],this.m_plotTrasparencyArray=[],this.m_seriesDataLabelProperty=[];var e=0;this.legendMap={};for(var i=0,r=t.length;i<r;i++){var s=this.formattedDescription(this,this.getProperAttributeNameValue(t[i],"DisplayName"));this.m_allSeriesDisplayNames[i]=s,this.m_allSeriesNames[i]=this.getProperAttributeNameValue(t[i],"Name"),this.m_seriesVisibleArr[this.m_allSeriesNames[i]]=this.getProperAttributeNameValue(t[i],"visible"),IsBoolean(this.m_seriesVisibleArr[this.m_allSeriesNames[i]])&&(this.m_seriesDisplayNames[e]=s,this.m_seriesNames[e]=this.getProperAttributeNameValue(t[i],"Name"),this.m_legendNames[e]=s,this.m_seriesColors[e]=convertColorToHex(this.getProperAttributeNameValue(t[i],"Color")),s={seriesName:this.m_seriesNames[e],displayName:this.m_seriesDisplayNames[e],color:this.m_seriesColors[e],shape:"cube",index:e},this.legendMap[this.m_seriesNames[e]]=s,e++)}this.setLegendsIntialLoad(this.m_defaultlegendfields),this.m_seriesfields=[this.m_allSeriesNames[0]]},DecompositionChart.prototype.getLegendInfo=function(){return this.legendMap},DecompositionChart.prototype.getAllSeriesNames=function(){return this.m_allSeriesNames},DecompositionChart.prototype.getAllCategoryNames=function(){return this.m_allCategoryNames},DecompositionChart.prototype.getSeriesNames=function(){return this.m_seriesNames},DecompositionChart.prototype.getSeriesDisplayNames=function(){return this.m_seriesDisplayNames},DecompositionChart.prototype.getSeriesColors=function(){return this.m_seriesColors},DecompositionChart.prototype.setLegendNames=function(t){this.m_legendNames=t},DecompositionChart.prototype.getLegendNames=function(){return this.m_legendNames},DecompositionChart.prototype.getCategoryColorsForAction=function(){return this.m_categoryFieldColor},DecompositionChart.prototype.getSeriesColorsForAction=function(){return this.m_seriesColors},DecompositionChart.prototype.setAllFieldsName=function(){this.m_allfieldsName=[];for(var t=0,e=this.getAllCategoryNames().length;t<e;t++)this.m_allfieldsName.push(this.getAllCategoryNames()[t]);for(var i=0,r=this.getAllSeriesNames().length;i<r;i++)this.m_allfieldsName.push(this.getAllSeriesNames()[i])},DecompositionChart.prototype.getAllFieldsName=function(){return this.m_allfieldsName},DecompositionChart.prototype.setAllFieldsDisplayName=function(){this.m_allfieldsDisplayName=[];for(var t=0,e=this.getCategoryDisplayNames().length;t<e;t++)this.m_allfieldsDisplayName.push(this.getCategoryDisplayNames()[t]);for(var i=0,r=this.getSeriesDisplayNames().length;i<r;i++)this.m_allfieldsDisplayName.push(this.getSeriesDisplayNames()[i])},DecompositionChart.prototype.getAllFieldsDisplayName=function(){return this.m_allfieldsDisplayName},DecompositionChart.prototype.setCategorySeriesData=function(){this.m_categoryData=[],this.m_seriesData=[],this.m_seriesDataForToolTip=[],this.m_displaySeriesDataFlag=[],this.m_seriesDataForDataLabel=[],this.m_seriesDataLabelPropertyOverlaid=[];for(var t=0,e=this.getDataProvider().length;t<e;t++){var i=this.getDataProvider()[t];if(this.isEmptyCategory=!0,0<this.getCategoryNames().length){this.isEmptyCategory=!1;for(var r=0,s=this.getCategoryNames().length;r<s;r++){this.m_categoryData[r]||(this.m_categoryData[r]=[]);var a=this.getValidFieldDataFromRecord(i,this.getCategoryNames()[r]);this.m_categoryData[r][t]=a}}this.m_displaySeriesDataFlag[t]=[];for(var o=0,n=0,h=this.getSeriesNames().length;o<h;o++){this.m_seriesData[o]||(this.m_seriesData[o]=[],this.m_seriesDataForToolTip[o]=[]);var l,a=this.getValidFieldDataFromRecord(i,this.getSeriesNames()[o]);this.m_displaySeriesDataFlag[t][o]=!0,isNaN(a)&&(this.m_displaySeriesDataFlag[t][o]=!1,a=getNumericComparableValue(a)),IsBoolean(this.m_seriesVisibleArr[this.m_seriesNames[o]])&&(this.m_seriesDataForDataLabel[n]||(this.m_seriesDataForDataLabel[n]=[]),this.m_seriesDataLabelPropertyOverlaid[n]=this.m_seriesDataLabelProperty[o],l=this.getValidFieldDataFromRecord(i,this.m_seriesDataLabelProperty[o].datalabelField),this.m_seriesDataForDataLabel[n][t]=l,n++),this.m_seriesData[o][t]=a,this.m_seriesDataForToolTip[o][t]=a}}},DecompositionChart.prototype.setCategoryData=function(){if(this.m_categoryData=[],this.isEmptyCategory=!0,0<this.getCategoryNames().length){this.isEmptyCategory=!1;for(var t=0,e=this.getCategoryNames().length;t<e;t++)this.m_categoryData[t]=this.getDataFromJSON(this.getCategoryNames()[t])}},DecompositionChart.prototype.getCategoryData=function(){return this.m_categoryData},DecompositionChart.prototype.setSeriesData=function(){this.m_seriesData=[];for(var t=0,e=this.getSeriesNames().length;t<e;t++)this.m_seriesData.push(this.getDataFromJSON(this.getSeriesNames()[t]))},DecompositionChart.prototype.getSeriesData=function(){return this.m_seriesData},DecompositionChart.prototype.setSeriesColor=function(t){this.m_seriesColor=t},DecompositionChart.prototype.getSeriesColor=function(){return this.m_seriesColor},DecompositionChart.prototype.setSeriesdata=function(){this.m_seriesData=this.getDataProvider()},DecompositionChart.prototype.IsDrawingPossible=function(){return IsBoolean(this.isEmptyCategory)?{permission:"false",message:this.m_status.noCategory}:IsBoolean(this.m_isEmptySeries)?{permission:"false",message:this.m_status.noData}:IsBoolean(this.isVisibleSeries())?IsBoolean(this.m_isvalidconfiguration)?{permission:"true",message:this.m_status.success}:{permission:"false",message:this.m_status.invalidConfig}:{permission:"false",message:this.m_status.noSeries}},DecompositionChart.prototype.init=function(){this.setAllFieldsName(),this.setCategoryData(),this.getAggregatedMeasureValue(),this.manageNodeData(),this.createSVG(),this.m_chartFrame.init(this),this.m_title.init(this),this.m_subTitle.init(this),this.setChartDrawingArea(),this.setPosition(),this.setSeriesdata(),this.isSeriesDataEmpty(),this.m_tooltip.init(this)},DecompositionChart.prototype.getAggregatedMeasureValue=function(){var g=this,t=this.m_dataProvider.filter(function(t){return!isNaN(t[g.m_categoryNames[0]])&&"undefined"!=t[g.m_categoryNames[0]]&&""!=t[g.m_categoryNames[0]].toString().trim()&&"null"!=t[g.m_categoryNames[0]]});if(0<t.length)if(isNaN(t[0][g.m_categoryNames[0]]))this.m_isvalidconfiguration=!1;else{this.m_isvalidconfiguration=!0;var a=JSON.parse(JSON.stringify(t)),i=[],u=0,e=[],y=this.m_categoryNames[0],f={},b=(this.m_seriesNames=this.m_allSeriesNames.slice(0,7),this.m_seriesNames),x=(this.m_seriesDNames=this.m_seriesDisplayNames.slice(0,7),this.m_seriesDNames),s=(IsBoolean(this.m_showcontextlevels)&&(b=this.m_seriesfields,x=[],b.map(function(t){x.push(g.m_seriesDNames[g.m_seriesNames.indexOf(t)])})),JSON.parse(JSON.stringify(b))),o=(a.map(function(r,t,e){s.map(function(t,e,i){r[t]=void 0===r[t]?"":r[t]})}),s.splice(s.length-1,1),{}),v=[],r={},A=(r.nodeName=y,r.fieldName=y,r.fieldDisplayName=g.m_categoryDisplayNames[0],r.children=[],r.childrenObjArr=[],r.parent="null",r.parentid="null",r.showChildren="false",r.nodeValue=[],r.value=1,r.percentage=[],r.childid=[],r.id=u++,a.map(function(r,t,e){isNaN(r[y])&&null===r[y]&&""===r[y]||r[y],s.map(function(t,e,i){null==o[t]&&(o[t]=[]),o[t].indexOf(r[t])<0&&o[t].push(r[t])}),i.push(r[y])}),{});s.map(function(i,r,t){objdata=0==r?a:A[r-1],A[r]={};for(var s=0,e=0==r?1:Object.keys(A[r-1]).length,t=0;t<e;t++)mapdata=0==r?a:A[r-1][t],o[i].map(function(e,t){0<(arrset=mapdata.filter(function(t){return t[i]===e})).length&&(A[r][s]=arrset,s++)})});for(var n,D=0;D<b.length;D++){var C=1==D?"root":b[D-2];if(0==D){r.childfieldname=b[0],r.displayname=x[0],a.map(function(t,e,i){r.children.indexOf(t[b[0]])<0&&r.children.push(t[b[0]])});for(var h=[],l=0;l<r.children.length;l++)h[l]=[],a.map(function(t,e,i){t[b[0]]===r.children[l]&&h[l].push(t[y])});for(var m=[],d=[],c=0;c<r.children.length;c++)r.nodeValue[c]=[],m[c]=h[c].reduce(function(t,e){return+t+ +e},0),d=m.reduce(function(t,e){return+t+ +e},0),"mean"==g.m_aggregationtype?r.nodeValue[c]=m[c]/h[c].length:"count"==g.m_aggregationtype?(r.nodeValue[c]=a.filter(function(t){return t[r.childfieldname]===r.children[c]}).length,r.value=a.length):"min"==g.m_aggregationtype?(r.nodeValue[c]=Math.min.apply(null,h[c]),r.value=Math.min.apply(null,r.nodeValue)):"max"==g.m_aggregationtype?(r.nodeValue[c]=Math.max.apply(null,h[c]),r.value=Math.max.apply(null,r.nodeValue)):"perc"!=g.m_aggregationtype&&"sum"!=g.m_aggregationtype||(r.nodeValue=m,r.value=d);for(c=0;c<r.children.length;c++)r.percentage[c]=m[c]/Math.abs(d)*100;"mean"==g.m_aggregationtype&&(_=r.nodeValue.reduce(function(t,e){return+t+ +e},0),r.value=_/r.nodeValue.length),f.root=0,v.push(r)}else for(var p=Object.keys(A[D-1]).length,S=0;S<p;S++)o[b[D-1]].map(function(e){var t=v.length,r=(v[t]={},v[t].nodeName=e,v[t].children=[],v[t].childrenObjArr=[],v[t].parent=C,v[t].fieldName=b[D-1],v[t].fieldDisplayName=x[D-1],v[t].id=u,v[t].showChildren="false",v[t].nodeValue=[],v[t].value=1,v[t].percentage=[],v[t].childid=[],v[t].childfieldname=b[D],v[t].displayname=x[D],v[t]),i=A[D-1][S];if(void 0!==i&&0<i.length){i.map(function(t){t[b[D-1]]===e&&r.children.indexOf(t[b[D]])<0&&r.children.push(t[b[D]])});for(var s="root",a="root",o=0;o<D;o++){var n=""==i[0][b[o]].toString().trim()?i[0][b[o]].split(" ").length-1+"&":i[0][b[o]],a=a+"_"+n;o<D-1&&(s=s+"_"+n)}for(var h=[],l=0;l<r.children.length;l++)h[l]=[],i.map(function(t,e,i){t[b[D]]===r.children[l]&&h[l].push(t[y])});for(var m=[],d=[],c=0;c<r.children.length;c++)r.nodeValue[c]=[],m[c]=h[c].reduce(function(t,e){return+t+ +e},0),d=m.reduce(function(t,e){return+t+ +e},0),"mean"==g.m_aggregationtype?r.nodeValue[c]=m[c]/h[c].length:"count"==g.m_aggregationtype?(r.nodeValue[c]=h[c].length,r.value=i.length):"min"==g.m_aggregationtype?(r.nodeValue[c]=Math.min.apply(null,h[c]),r.value=Math.min.apply(null,r.nodeValue)):"max"==g.m_aggregationtype?(r.nodeValue[c]=Math.max.apply(null,h[c]),r.value=Math.max.apply(null,r.nodeValue)):"perc"!=g.m_aggregationtype&&"sum"!=g.m_aggregationtype||(r.nodeValue=m,r.value=d);for(var p,c=0;c<r.children.length;c++){var _=Number(m[c]/Math.abs(d)*100);r.percentage[c]=isNaN(_)?"0":_}"mean"==g.m_aggregationtype&&(p=r.nodeValue.reduce(function(t,e){return+t+ +e},0),r.value=p/r.nodeValue.length),0<r.children.length?(v[t].parentid=f[s],f[a]=u,v[f[s]].childid.push(u),u++):v.splice(v.length-1,1)}else v.splice(v.length-1,1)})}for(u in v)v.hasOwnProperty(u)&&("null"!=(n=v[u]).parentid?v[n.parentid].childrenObjArr:e).push(n);if(this.m_childnodesobj=o,this.m_childdata=v,"mean"==g.m_aggregationtype){for(var _=0,D=0;D<this.m_childdata[0].childrenObjArr.length;D++)_+=this.m_childdata[0].childrenObjArr[D].value;this.m_childdata[0].value=_/this.m_childdata[0].childrenObjArr.length}this.m_decompositiontree=e}},DecompositionChart.prototype.manageNodeData=function(){if(this.m_limitedslicesdisable=!0,""!=this.m_maxnodes&&null!=this.m_childdata)for(var t=0;t<this.m_childdata.length;t++){var e=this.sortDataInDescOrder(this.m_childdata[t].nodeValue,this.m_childdata[t].children,this.m_childdata[t].childrenObjArr,this.m_childdata[t].percentage,this.m_maxnodes,this.m_childdata[t].childid,t);if(this.m_maxnodes<this.m_childdata[t].children.length)if(this.m_sorteddataarr=[],this.m_limitedslicesdisable=!1,this.m_seriesDataLabel=[],this.remainingData={},this.remainingPerc={},1==this.m_maxnodes)e=this.sortDataInDescOrder(this.m_childdata[t].nodeValue,this.m_childdata[t].children,this.m_maxnodes),this.m_childdata[t].nodeValue=[e.seriesDataSum],this.m_childdata[t].children=["Sum"];else{var i="Others("+Object.keys(e.remainingData).length+")",r=(this.m_sorteddataarr=e.DataMapArray,this.remainingData=e.remainingData,this.remainingPerc=e.remainingPerc,[]),s=[],a=[],o=[],n=[],h=null==this.uparrow[t]||0==this.uparrow[t]?0:this.uparrow[t]*this.m_maxnodes-1,l=0<this.uparrow[t]?+this.m_maxnodes+h:+this.m_maxnodes+h-1;this.lastLevel[t]=l>this.m_childdata[t].children.length-1;for(var m=h,d=l;m<d;m++)null!=this.m_childdata[t].children[m]&&(r.push(this.m_childdata[t].children[m]),s.push(this.m_childdata[t].nodeValue[m]),a.push(this.m_childdata[t].percentage[m]),n.push(this.m_childdata[t].childid[m]),null!=this.m_childdata[t].childrenObjArr[m])&&o.push(this.m_childdata[t].childrenObjArr[m]);null!=this.uparrow[t]&&0!=this.uparrow[t]||(r.push(i),s.push(e.seriesDataSum),a.push(e.seriesPercSum)),this.m_childdata[t].nodeValue=s,this.m_childdata[t].children=r,this.m_childdata[t].percentage=a,this.m_childdata[t].childid=n,this.m_childdata[t].childrenObjArr=o}}},DecompositionChart.prototype.sortDataInDescOrder=function(t,e,i,r,s,a,o){var n=t,h=e,l=i,m=r,d="",c=[],p={},_=[],g={},u={},y=0,f=0;if(this.m_maxnodes<e.length){for(var b=0,x=n.length;b<x;b++)d=+getNumericComparableValue(n[b]),(isNaN(d)||""===n[b]?(p={childrenData:h[b],index:b,id:a[b],nodeValueData:n[b],childrenObjArrData:l[b],percentageData:m[b],value:n[b]},_):(p={childrenData:h[b],index:b,id:a[b],nodeValueData:n[b],childrenObjArrData:l[b],percentageData:m[b],value:n},l=null==l[b]?[]:l,c)).push(p);c.sort(function(t,e){return e.nodeValueData-t.nodeValueData});for(var v=0,x=_.length;v<x;v++)c.push(_[v]);for(var A=s-1,x=c.length;A<x;A++)g[c[A].childrenData+"-"+c[A].index]=c[A].nodeValueData,u[c[A].childrenData+"-"+c[A].index]=c[A].percentageData,y+=d=isNaN(c[A].nodeValueData)?0:c[A].nodeValueData,f+=+(currentPerc=isNaN(c[A].percentageData)?0:c[A].percentageData);if(0<i.length){var D=c.reduce(function(t,e,i){return t[e.childrenData]=i,t},{});i.sort(function(t,e){return D[t.nodeName]-D[e.nodeName]}),i.sort(function(t,e){return e.value-t.value});for(b=0,x=i.length;b<x;b++)this.m_childdata[o].children[b]=i[b].nodeName,this.m_childdata[o].nodeValue[b]=i[b].value,this.m_childdata[o].childid[b]=i[b].id;this.m_childdata[o].childrenObjArr=i,this.m_childdata[o].percentage.sort(function(t,e){return e-t})}else for(b=0,x=c.length;b<x;b++)this.m_childdata[o].children[b]=c[b].childrenData,this.m_childdata[o].nodeValue[b]=c[b].nodeValueData,this.m_childdata[o].percentage[b]=c[b].percentageData;return{DataMapArray:c,seriesDataSum:y,remainingData:g,seriesPercSum:f,remainingPerc:u}}for(b=0,x=n.length;b<x;b++)d=+getNumericComparableValue(n[b]),(isNaN(d)||""===n[b]?(p={childrenData:h[b],index:b,id:a[b],nodeValueData:n[b],childrenObjArrData:l[b],percentageData:m[b],value:n[b]},_):(p={childrenData:h[b],index:b,id:a[b],nodeValueData:n[b],childrenObjArrData:l[b],percentageData:m[b],value:n},l=null==l[b]?[]:l,c)).push(p);if(c.sort(function(t,e){return e.nodeValueData-t.nodeValueData}),0<i.length){i.sort(function(t,e){return e.value-t.value});for(b=0,x=i.length;b<x;b++)this.m_childdata[o].children[b]=i[b].nodeName,this.m_childdata[o].nodeValue[b]=i[b].value,this.m_childdata[o].childid[b]=i[b].id;this.m_childdata[o].childrenObjArr=i,this.m_childdata[o].percentage.sort(function(t,e){return e-t})}else for(b=0,x=c.length;b<x;b++)this.m_childdata[o].children[b]=c[b].childrenData,this.m_childdata[o].nodeValue[b]=c[b].nodeValueData,this.m_childdata[o].percentage[b]=c[b].percentageData},DecompositionChart.prototype.setPosition=function(){var t=this.getStartX(),e=+this.m_height/2;this.m_startx=t,this.m_starty=e,this.m_nodewidth=100},DecompositionChart.prototype.updateSeriesDataWithCommaSeperators=function(){this.m_displaySeriesDataFlag=[];for(var t=0,e=this.m_seriesData.length;t<e;t++){this.m_displaySeriesDataFlag[t]=[];for(var i=0,r=this.m_seriesData[t].length;i<r;i++)this.m_displaySeriesDataFlag[t][i]=!0,isNaN(this.m_seriesData[t][i])&&(this.m_displaySeriesDataFlag[t][i]=!1,this.m_seriesData[t][i]=getNumericComparableValue(this.m_seriesData[t][i]))}},DecompositionChart.prototype.drawChart=function(){this.drawChartFrame(),this.drawTitle(),this.drawSubTitle();var t=this.IsDrawingPossible();IsBoolean(t.permission)?(this.setSVGDimension(),this.createStackGroup("","nodegrp","","Node"),this.createStackGroup("","linkgrp","","link"),this.drawNode()):this.drawSVGMessage(t.message)},DecompositionChart.prototype.isAnimation=function(t){var e=this;if(IsBoolean(e.m_showcontextlevels)){if(IsBoolean(e.contextclick)){if(t==e.m_contextseriesfields[e.m_contextseriesfields.length-1])return!0}else if(!IsBoolean(e.contextclick)&&!IsBoolean(e.arrowclicked))return!0}else if(!IsBoolean(e.arrowclicked))return!0},DecompositionChart.prototype.drawNode=function(){var i=this,e=[],t=(this.m_rstarty=+$("#chartSvgContainer"+this.m_objectId).height()/2,this.m_decompositiontree[0].starty=this.m_rstarty,this.m_decompositiontree[0].startx=this.m_startx,drawSVGRect(this.m_startx,this.m_rstarty,this.m_nodewidth,this.m_nodeheight,this.m_fillcolor)),r=($(t).attr("id","rectMeasure"+i.m_objectid),this.m_rvalue="perc"==i.m_aggregationtype?"100":this.m_decompositiontree[0].value,this.getFormattedText(this.m_rvalue,this.m_precision)),s=this.drawSVGText(this.trimText(this.m_decompositiontree[0].fieldDisplayName,this.m_nodewidth,this.m_labelfontsize,this.m_labelfontfamily),this.m_startx+50,this.m_rstarty+20+ +this.m_nodeheight,this.m_startx,this.m_rstarty,"30","x","y",this.m_labelfontcolor,"middle",this.m_labelfontweight,this.m_labelfontsize,this.m_labelfontfamily,this.m_labelfontstyle),r=this.drawSVGText(this.trimText(r,this.m_nodewidth,this.m_labelvaluefontsize,this.m_labelvaluefontfamily),this.m_startx+50,this.m_rstarty+25+ +this.m_nodeheight+ +this.m_labelvaluefontsize,this.m_startx,this.m_rstarty,"30","x","y",this.m_labelvaluefontcolor,"middle",this.m_labelvaluefontweight,this.m_labelvaluefontsize,this.m_labelvaluefontfamily,this.m_labelvaluefontstyle),a=($("#nodegrp"+this.m_objectid).append(t,s,r),this.m_startx),o=[];IsBoolean(this.m_designMode)||$(t).on("click",function(t){t.detail&&1!=t.detail||(t.preventDefault(),t.stopPropagation(),IsBoolean(i.m_decompositiontree[0].showChildren)?IsBoolean(i.m_decompositiontree[0].showChildren)&&(IsBoolean(i.m_enableanimation)?(i.closex=i.m_decompositiontree[0].startx,i.closey=i.m_decompositiontree[0].starty,i.setNodeAnimation(i.m_decompositiontree[0])):i.clickEvents(i.m_childdata[0].childfieldname,i.m_childdata),i.m_childdata[0].showChildren="false"):(!IsBoolean(i.m_showcontextlevels)||IsBoolean(i.m_showcontextlevels)&&0<i.m_contextseriesfields.length)&&i.childRendering(i.m_decompositiontree[0],e,0,o,a))}).on("contextmenu",function(t){IsBoolean(i.m_showcontextlevels)&&(t.preventDefault(),t.stopPropagation(),t={left:t.pageX,top:t.pageY},i.contextclick="true",this.id,i.m_contexthierarchy=Array.from(i.m_seriesDNames),i.createContexLevels(t,i.m_decompositiontree[0]))}).on("mouseover",function(t){var e=i.getFormattedText(i.m_rvalue,i.m_tooltipprecision),e={data:[[{shape:"cube",color:i.m_fillcolor},i.m_categoryDisplayNames[0],e]],highlightIndex:0};i.m_tooltip.drawDecompositionToolTip(e)}).on("mouseout",function(t){i.hideToolTip()}),(!IsBoolean(i.m_showcontextlevels)||0<i.m_contextseriesfields.length)&&this.childRendering(this.m_decompositiontree[0],e,0,o,a)},DecompositionChart.prototype.childRendering=function(e,o,t,n,h){var i,r,s,a,l,m,d=this,c=(e.showChildren="true",this.parentyvalue=e.starty,0==t?this.m_startx+100:h+100),p=h+=200,_=(n.push(e),e.id.toString().replace(/[^a-zA-Z0-9]/g,""),0==t?this.m_rstarty+this.m_nodeheight/2:+this.parentyvalue+this.m_nodeheight/2),g=e.childfieldname.toString().replace(/[^a-zA-Z0-9]/g,""),t=(this.createStackGroup("","group"+g,"","Group"),"headergroup"+d.m_seriesNames.indexOf(e.childfieldname)),u=(this.createStackGroup("",t,"","Group"),i=e.displayname!=d.trimText(e.displayname,this.m_nodewidth-20,this.m_labelfontsize,this.m_labelfontfamily)?this.drawSVGText(this.trimText(e.displayname,this.m_nodewidth-20,this.m_labelfontsize,this.m_labelfontfamily),h,"35",0,0,"30","x","y",this.m_labelfontcolor,"","600",this.m_labelfontsize,this.m_labelfontfamily,this.m_labelfontstyle):this.drawSVGText(this.trimText(e.displayname,this.m_nodewidth-20,this.m_labelfontsize,this.m_labelfontfamily),h+50,"35",0,0,"30","x","y",this.m_labelfontcolor,"middle","600",this.m_labelfontsize,this.m_labelfontfamily,this.m_labelfontstyle),this.drawSVGLine(h,"45",h+100,"45","x","y","1","2",this.m_fillcolor,"1")),y=this.drawSVGText("",h+50,"35",0,0,"30","x","y",this.m_labelfontcolor,"middle","600",+this.m_labelfontsize+2,this.m_labelfontfamily,this.m_labelfontstyle),f=(IsBoolean(d.m_showcontextlevels)&&(this.drawSVGCross(h+(this.m_nodewidth-10),25,10,"x","y","1","2",this.m_fillcolor,e.childfieldname),$("#"+t+d.m_objectid).append($("#crossgroup"+e.childfieldname+d.m_objectid))),$("#"+t+d.m_objectid).append(i,u,y),$("#group"+g+this.m_objectid).append($("#"+t+d.m_objectid)),IsBoolean(this.m_designMode)||($(i).hover(function(t){$(this).hide(),$(y).show(),$(y)[0].children[0].innerHTML=e.displayname,$("#crossgroup"+e.childfieldname+d.m_objectid).hide()},function(){$(y).hide(),$(this).show(),$("#crossgroup"+e.childfieldname+d.m_objectid).show(),$(y)[0].children[0].innerHTML=""}),$(y).hover(function(t){$(i).hide(),$(this).show(),$(this)[0].children[0].innerHTML=e.displayname,$("#crossgroup"+e.childfieldname+d.m_objectid).hide()},function(){$(i).show(),$(this).hide(),$("#crossgroup"+e.childfieldname+d.m_objectid).show(),$(this)[0].children[0].innerHTML=""})),"null"!=e.parentid&&(r=e.nodeName!=d.trimText(e.nodeName,this.m_nodewidth,+this.m_labelfontsize-2,this.m_labelfontfamily)?this.drawSVGText(this.trimText(e.nodeName,this.m_nodewidth,+this.m_labelfontsize-2,this.m_labelfontfamily),e.startx,"60",0,0,"30","x","y",this.m_labelfontcolor,"","600",+this.m_labelfontsize-2,this.m_labelfontfamily,this.m_labelfontstyle):this.drawSVGText(this.trimText(e.nodeName,this.m_nodewidth,+this.m_labelfontsize-2,this.m_labelfontfamily),e.startx+50,"60",0,0,"30","x","y",this.m_labelfontcolor,"middle","600",+this.m_labelfontsize-2,this.m_labelfontfamily,this.m_labelfontstyle),s=this.drawSVGText("",e.startx+50,"60",0,0,"30","x","y",this.m_labelfontcolor,"middle","600",+this.m_labelfontsize,this.m_labelfontfamily,this.m_labelfontstyle),$("#group"+g+this.m_objectid).append(r,s),$(r).hover(function(t){$(this).hide(),$(s).show(),$(s)[0].children[0].innerHTML=e.nodeName},function(){$(s).hide(),$(this).show(),$(s)[0].children[0].innerHTML=""}),$(s).hover(function(t){$(r).hide(),$(this).show(),$(this)[0].children[0].innerHTML=e.nodeName},function(){$(r).show(),$(this).hide(),$(this)[0].children[0].innerHTML=""})),$("#line"+e.id+d.m_objectid).attr("stroke",e.alertcolor),$("#rect"+e.id+d.m_objectid).attr("stroke",e.alertcolor),_-this.m_nodeheight/2),b=(e.children.length-1)/2*(+this.m_nodeheight+40);if(step=+this.m_nodeheight+40,this.arrowmargin=f-(b=f-b<100?-(100-f):b)-20,0<e.children.length){for(var x=0;x<e.children.length;x++){var v=this.getRangeColorNode(e,x),A=((null==e.childid[x]&&isNaN(e.childid[x])||e.childid.length<1||-1<e.children[x].toString().indexOf("Others("))&&(D=this.m_childdata.length,this.m_childdata[D]={},this.m_childdata[D].nodeName=e.children[x],this.m_childdata[D].children=[],this.m_childdata[D].childrenObjArr=[],this.m_childdata[D].parent=e.fieldName,this.m_childdata[D].fieldName=e.childfieldname,this.m_childdata[D].fieldDisplayName=e.displayname,this.m_childdata[D].id=this.m_childdata.length-1,this.m_childdata[D].showChildren="false",this.m_childdata[D].nodeValue=[],this.m_childdata[D].value=e.nodeValue[x],this.m_childdata[D].percentage=[],this.m_childdata[D].childid=[],this.m_childdata[D].childfieldname="",this.m_childdata[D].parentid=e.id,this.m_childdata[D].alertcolor=v,e.childid[x]=this.m_childdata[D].id),e.childid[x].toString().replace(/[^a-zA-Z0-9]/g,"")),D=(this.createStackGroup("",A,"","Group"),this.fontsize=0===x?-this.fontScaling(+this.m_labelfontsize)*x:this.fontScaling(+this.m_labelfontsize)*x,(starty=-b+x*step+f+this.fontsize)+this.m_nodeheight/2),C=(0<e.childrenObjArr.length&&null!=e.childrenObjArr[x]&&(e.childrenObjArr[x].alertcolor=v,e.childrenObjArr[x].starty=starty,e.childrenObjArr[x].startx=h),IsBoolean(this.m_enableanimation)?h-200:h),S=IsBoolean(this.m_enableanimation)?this.parentyvalue:starty,w=IsBoolean(this.m_enableanimation)?h-150:h+50,N=IsBoolean(this.m_enableanimation)?this.parentyvalue:starty,P=new DSLineSeries;$(P).attr("id","line"+A+d.m_objectid);var I=d.generateControlPoints([c,p],[_,D]),I=(P.init([this.m_nodecolor,this.m_nodecolor],[c,p],[_,D],void 0,this,1,"Population","1","straight","1"),d.drawLinespath(0,P,I,g),IsBoolean(this.m_showpercentage)&&"perc"!=d.m_aggregationtype&&(P=this.drawSVGText(Number(e.percentage[x]).toFixed(0)+"%",C-20,S+(+this.m_nodeheight/2-7),c,p,"30","x","y",v,"middle",this.m_labelfontweight,"12",this.m_labelfontfamily,this.m_labelfontstyle),$("#"+A+this.m_objectid).append(P)),drawSVGRect(C,S,this.m_nodewidth,this.m_nodeheight,this.m_nodecolor)),P=(P=+e.percentage[x]/100)<0?0:1<P?1:P,C=drawSVGRect(C,S,this.m_nodewidth*P,this.m_nodeheight,v),S=($(I).attr("id","rect"+A+this.m_objectid),"perc"==d.m_aggregationtype?this.getFormattedText(e.percentage[x],this.m_precision):this.getFormattedText(e.nodeValue[x],this.m_precision)),P=this.drawSVGText(this.trimText(e.children[x],this.m_nodewidth,this.m_labelfontsize,this.m_labelfontfamily),w,N+20+ +this.m_nodeheight,c,p,"30","x","y",this.m_labelfontcolor,"middle",this.m_labelfontweight,this.m_labelfontsize,this.m_labelfontfamily,this.m_labelfontstyle),v=this.drawSVGText(this.trimText(S,this.m_nodewidth,this.m_labelvaluefontsize,this.m_labelvaluefontfamily),w,N+25+ +this.m_nodeheight+ +this.m_labelvaluefontsize,c,p,"30","x","y",this.m_labelvaluefontcolor,"middle",this.m_labelvaluefontweight,this.m_labelvaluefontsize,this.m_labelvaluefontfamily,this.m_labelvaluefontstyle,S);$("#"+A+this.m_objectid).append(I,C,P,v),$("#group"+g+this.m_objectid).append($("#"+A+this.m_objectid)),IsBoolean(this.m_enableanimation)&&(w=starty-this.parentyvalue,d.isAnimation(e.childfieldname)&&(this.setLineAnimation(this.m_path),$("#"+A+this.m_objectid).css("transition","transform 0.5s")),$("#"+A+this.m_objectid).css("transform","translate(200px, "+w+"px)")),IsBoolean(this.m_designMode)||$("#"+A+this.m_objectid).on("click",function(t){if(!t.detail||1==t.detail){event.preventDefault(),event.stopPropagation();var e=this.id.replace("rect","").replace(d.m_objectid,""),t=d.m_childdata.find(function(t){return t.id.toString().replace(/[^a-zA-Z0-9]/g,"")===e});if(t.nodeName.toString().indexOf("Others(")<0)if(0<t.children.length){var i=Object.keys(d.m_drawnode).slice(0,Object.keys(d.m_drawnode).indexOf(t.fieldName)).reduce(function(t,e){return t[e]=d.m_drawnode[e],t},{});if(d.m_drawnode=i,d.m_drawnode[t.fieldName]=t.nodeName,IsBoolean(d.m_showcontextlevels)&&!function t(e){d.m_updatedhierarchylevel[e.fieldName].id=e.nodeName,d.m_updatedhierarchylevel[e.fieldName].nodeid=e.id,null!=d.m_updatedhierarchylevel[e.childfieldname]&&0<e.childrenObjArr.length&&t(e.childrenObjArr[0])}(t),d.contextclick="false",d.arrowclicked="false",IsBoolean(t.showChildren)||null==t)IsBoolean(t.showChildren)&&($("#line"+t.id+d.m_objectid).attr("stroke",d.m_nodecolor),$("#rect"+t.id+d.m_objectid).attr("stroke","none"),IsBoolean(d.m_enableanimation)?(d.closex=t.startx,d.closey=t.starty,d.setNodeAnimation(t)):d.clickEvents(t.childfieldname,d.m_childdata),t.showChildren="false");else{for(var r=t.parentid,s=d.m_childdata.find(function(t){return t.id===r}),a=0;a<s.children.length;a++)if(s.children[a]!=e&&null!=s.childrenObjArr[a]&&IsBoolean(s.childrenObjArr[a].showChildren)){$("#line"+s.childrenObjArr[a].id+d.m_objectid).attr("stroke",d.m_nodecolor),$("#rect"+s.childrenObjArr[a].id+d.m_objectid).attr("stroke","none"),s.childrenObjArr[a].showChildren="false",d.clickEvents(s.childrenObjArr[a].childfieldname,s.childrenObjArr);break}d.childRendering(t,o,1,n,h)}d.updateDataPoints(t)}else IsBoolean(t.showChildren)?($("#line"+t.id+d.m_objectid).attr("stroke",d.m_nodecolor),$("#rect"+t.id+d.m_objectid).attr("stroke","none"),t.showChildren="false",d.m_childdata.map(function(t){IsBoolean(t.showChildren)||$("#"+t.id+d.m_objectid).css({opacity:"1","pointer-events":"all"})})):($("#line"+t.id+d.m_objectid).attr("stroke",t.alertcolor),$("#rect"+t.id+d.m_objectid).attr("stroke",t.alertcolor),t.showChildren="true",d.m_childdata.map(function(t){IsBoolean(t.showChildren)||$("#"+t.id+d.m_objectid).css({opacity:"0.4","pointer-events":"none"})}))}}).on("mouseover",function(t){var e,i=this.id.replace("rect","").replace(d.m_objectid,""),r=d.m_childdata.find(function(t){return t.id.toString().replace(/[^a-zA-Z0-9]/g,"")===i}),r=(e="perc"==d.m_aggregationtype?(e=d.m_childdata[r.parentid].percentage[d.m_childdata[r.parentid].childid.indexOf(r.id)],d.getFormattedText(e,d.m_tooltipprecision)):d.getFormattedText(r.value,d.m_tooltipprecision),{cat:r.nodeName,data:[[{shape:"cube",color:r.alertcolor},d.m_categoryDisplayNames[0],e]],highlightIndex:0});d.m_tooltip.drawDecompositionToolTip(r)}).on("mouseout",function(t){d.hideToolTip()}).on("contextmenu",function(t){var e,i;IsBoolean(d.m_showcontextlevels)&&($("#contexleveldiv").remove(),t.preventDefault(),t.stopPropagation(),i=this.id,t={left:t.pageX,top:t.pageY},d.contextclick="true",e=i.replace(d.m_objectid,""),(i=d.m_childdata.find(function(t){return t.id.toString().replace(/[^a-zA-Z0-9]/g,"")===e})).nodeName.toString().indexOf("Others(")<0)&&(0==Object.keys(d.m_updatedhierarchylevel).length?(d.m_contexthierarchy=Array.from(d.m_seriesDNames),0<=d.m_contexthierarchy.indexOf(i.fieldDisplayName)&&d.m_contexthierarchy.splice(d.m_contexthierarchy.indexOf(i.fieldDisplayName),1)):0<Object.keys(d.m_updatedhierarchylevel).length&&null==d.m_updatedhierarchylevel[i.fieldName]?(d.m_contexthierarchy=Array.from(d.m_updatedhierarchylevel[d.m_contextseriesfields[d.m_contextseriesfields.indexOf(i.fieldName)-1]].levels),0<=d.m_contexthierarchy.indexOf(i.fieldDisplayName)&&d.m_contexthierarchy.splice(d.m_contexthierarchy.indexOf(i.fieldDisplayName),1)):d.m_contexthierarchy=d.m_updatedhierarchylevel[i.fieldName].levels,0<d.m_contexthierarchy.length)&&d.createContexLevels(t,i)})}setTimeout(function(){$("#nodegrp"+d.m_objectid).append($("#group"+g+d.m_objectid))},400),o.indexOf(e.childfieldname)<0&&o.push(e.childfieldname)}0!=e.children[e.children.length-1].toString().indexOf("Others(")&&null==d.uparrow[e.id]||(u=starty+ +this.m_nodeheight+ +this.m_labelfontsize+ +this.m_labelvaluefontsize+25,this.drawSVGArrow(h+this.m_nodewidth/2*1,u,5,"x","y","1","2",this.m_arrowstrokecolor,A,this.m_arrowstrokewidth,this.m_arrowsize),$("#group"+g+this.m_objectid).append($("#arrowgroup"+A+d.m_objectid))),0<e.childrenObjArr.length&&(IsBoolean(d.m_showcontextlevels)&&null!=d.m_updatedhierarchylevel[e.childfieldname]?(a=e.childrenObjArr,l=e.childfieldname,a.map(function(t){t.nodeName===d.m_updatedhierarchylevel[l].id&&(m=t)}),d.m_obj=null!=m?m:e.childrenObjArr[0]):null!=d.m_drawnode[e.childfieldname]?(a=e.childrenObjArr,l=e.childfieldname,a.map(function(t){t.nodeName===d.m_drawnode[l]&&(m=t)}),d.m_obj=null!=m?m:e.childrenObjArr[0]):d.m_obj=d.m_childdata[e.childid[0]],null!=d.m_updatedhierarchylevel&&null!=d.m_updatedhierarchylevel[d.m_obj.fieldDisplayName]&&(d.m_updatedhierarchylevel[d.m_obj.fieldDisplayName].id=d.m_obj.nodeName,d.m_updatedhierarchylevel[d.m_obj.fieldDisplayName].nodeid=d.m_obj.id),d.m_drawnode[d.m_obj.fieldName]=d.m_obj.nodeName,this.childRendering(d.m_obj,o,1,n,h)),d.contextclick="false",d.arrowclicked="false",$("#dcloaderImage"+d.m_objectid).hide(),setTimeout(function(){var t=$("#nodegrp"+d.m_objectid)[0].getBBox();$("#chartSvg"+d.m_objectid).css("width",t.width+d.m_startx),$("#chartSvg"+d.m_objectid).css("height",t.height)},500)},DecompositionChart.prototype.getRangeColorNode=function(node,c){if(IsBoolean(this.m_designMode))return this.m_fillcolor;var rangeColor,series=this.m_seriesData,seriesName=this.m_seriesNames,seriesColor=this.m_conditionalColors.m_ConditionalColor;if(null!=seriesColor&&null!==seriesColor&&""!==seriesColor){for(var i=0;i<seriesColor.length;i++){var operator="="==seriesColor[i].m_operator?"==":""+seriesColor[i].m_operator;!0===seriesColor[i].m_flag&&seriesColor[i].m_seriesname===node.childfieldname&&(seriesColor[i].m_seriesname===seriesColor[i].m_comparedfield?eval("result= '"+node.children[c]+"'"+operator+"'"+seriesColor[i].m_compareto+"'"):eval("result = "+parseFloat(node.nodeValue[c])+operator+parseFloat(seriesColor[i].m_compareto)),IsBoolean(result))&&(rangeColor=seriesColor[i].m_color)}rangeColor=rangeColor||this.m_fillcolor}else rangeColor=this.m_fillcolor;return rangeColor},DecompositionChart.prototype.clickEvents=function(s,t){var a=this,e=s.replace("rect","").replace(this.m_objectid,"").replace(/[^a-zA-Z0-9]/g,"")+this.m_objectid;$("#group"+e).remove(),t.map(function(t,e,i){var r;t.childfieldname==s&&0<t.childrenObjArr.length&&(r=t.childrenObjArr[0].childfieldname,t.childrenObjArr.forEach(function(t,e){t.showChildren="false"}),a.clickEvents(r,t.childrenObjArr))})},DecompositionChart.prototype.setNodeAnimation=function(t){var s=this;function a(t,e){$("#line"+e.childid[t]+s.m_objectid).remove();var i=s.closex-e.startx,r=s.closey-e.starty;$("#"+e.childid[t]+s.m_objectid).css("transform","translate("+i+"px, "+r+"px)"),$("#"+e.childid[t]+s.m_objectid).css("transition","transform 0.5s"),e.showChildren="false",t<e.childid.length-1?a(t+1,e):setTimeout(function(){var t=e.childfieldname.replace(/[^a-zA-Z0-9]/g,"")+s.m_objectid;$("#group"+t).remove()},400)}0<t.childrenObjArr.length&&t.childrenObjArr.map(function(t){IsBoolean(t.showChildren)&&(0<t.childrenObjArr.length?s.setNodeAnimation(t):a(0,t))}),a(0,t)},DecompositionChart.prototype.updateArrowInfo=function(t){var e=this,i=Object.keys(e.m_updatedhierarchylevel).indexOf(t);if(0<i&&0<Object.keys(e.m_updatedhierarchylevel).length||0<Object.keys(e.uparrow).length&&0<Object.keys(e.m_updatedhierarchylevel).length&&null!=e.m_updatedhierarchylevel[t]){var r,t=0==i?Object.keys(e.uparrow)[0]:e.m_updatedhierarchylevel[Object.keys(e.m_updatedhierarchylevel)[i-1]].nodeid,s=Object.keys(e.uparrow);for(r in-1<s.indexOf(t.toString())&&s.splice(s.indexOf(t.toString())),e.uparrow)s.includes(r)||delete e.uparrow[r]}else 0==Object.keys(e.m_updatedhierarchylevel).length&&(e.uparrow={})},DecompositionChart.prototype.createContexLevels=function(t,e){for(var s=this,i=s.m_contexthierarchy,r=(s.field=e.fieldName,s.clickednodeinfo=e,$("#contexleveldiv").remove(),""),a=0,o=i.length;a<o;a++)r+='<tr style="font-style:'+this.m_labelfontstyle+";color:#000000;font-weight:"+this.m_labelfontweight+";font-family:"+selectGlobalFont(this.m_labelfontfamily)+'"><td>'+i[a]+"</td></tr>";e='<table id="contexleveldiv">'+r+"</table>";s.m_designMode||$("body").append(e),$("#contexleveldiv").css({display:"block",position:"absolute",left:t.left+10+"px",top:t.top+10+"px",background:"#ffffff"}),s.hideToolTip(),$(".dropdown-menu-context-menu").remove(),$("#contexleveldiv tr").click(function(){var t=$(this).children("td").html(),e=s.clickednodeinfo,i=(null==s.m_updatedhierarchylevel[e.fieldName]&&(s.m_updatedhierarchylevel[e.fieldName]=[],s.m_updatedhierarchylevel[e.fieldName].levels=[],s.m_updatedhierarchylevel[e.fieldName].id,s.m_updatedhierarchylevel[e.fieldName].nodeid),s.m_updatedhierarchylevel[e.fieldName].levels=Array.from(s.m_contexthierarchy),s.m_updatedhierarchylevel[e.fieldName].id=e.nodeName,s.m_updatedhierarchylevel[e.fieldName].nodeid=e.id,s.m_contextseriesfields.splice(s.m_contextseriesfields.indexOf(s.field)+1),{});for(j=0;j<s.m_contextseriesfields.length;j++){var r=s.m_contextseriesfields[j];i[r]=s.m_updatedhierarchylevel[r]}s.m_updatedhierarchylevel=i;e=s.m_seriesNames[s.m_seriesDNames.indexOf(t)];s.m_contextseriesfields.indexOf(e)<0&&s.m_contextseriesfields.push(e),s.m_seriesfields=s.m_contextseriesfields,null!=s.uparrow&&0<Object.keys(s.uparrow).length&&s.updateArrowInfo(t),$("#contexleveldiv").remove(),s.init(),s.drawChart()}),$(".draggablesParentDiv").click(function(){$("#contexleveldiv").remove()})},DecompositionChart.prototype.trimText=function(t,e,i,r){if(t=isNaN(t)?t.replace(/\s*$/,""):t.toString(),this.ctx.font=i+"px "+selectGlobalFont(r),e<this.ctx.measureText(t).width){for(var s=t.split(""),a="",o=0;o<s.length;o++){if(!(e>this.ctx.measureText(a+s[o]).width)){a+="..";break}a+=s[o]}return a}return t},DecompositionChart.prototype.getFormattedText=function(t,e){this.setFormatter(),this.setSecondaryFormatter();var i,r;return t%1!=0&&e<1?t=this.setPrecision(t,0):"default"!==e&&(t=this.setPrecision(t,e)),"none"!=this.m_formater&&""!=this.m_formater||"none"!=this.m_secondaryformater&&""!=this.m_secondaryformater||(t=this.setPrecision(t,e)),t=this.m_util.updateTextWithFormatter(t,this.m_secondaryUnitSymbol,e),t="auto"!=this.m_secondaryUnitSymbol?(0!=e&&null!=e?t=this.setPrecision(t,e):t<1&&t%1!=0&&(t=this.setPrecision(t,2)),this.addSecondaryFormater(t=t%1==0&&"default"===e?+t:t,this.m_secondaryUnitSymbol)):(i=getNumberFormattedSymbol(+t,this.m_unit),r=getNumberFormattedNumericValue(+t,e,this.m_unit),t=this.setPrecision(r,e),0!=e&&null!=e?t=this.setPrecision(t,e):t<1&&t%1!=0&&(t=this.setPrecision(t,2)),this.addSecondaryFormater(t=t%1==0&&"default"===e?+t:t,i)),t=getFormattedNumberWithCommas(t,this.m_numberformatter,this.m_unit),t=null!=this.m_unitSymbol?this.m_util.addFormatter(t,this.m_unitSymbol,this.m_formatterPosition,e):t},DecompositionChart.prototype.setPrecision=function(t,e){return 0!==(t=+t)&&"default"!==e?t.toFixed(e):+t},DecompositionChart.prototype.addSecondaryFormater=function(text,secondaryUnitSymbol){var textValue=text;try{eval("var formattedText = this.m_util.addUnitAs"+this.m_secondaryFormatterPosition+"(textValue,secondaryUnitSymbol);")}catch(e){}return formattedText.toString()},DecompositionChart.prototype.setFormatter=function(){var t,e;this.m_unitSymbol="",this.m_formatterPosition="","none"!=this.m_formater&&""!=this.m_formater&&(t=this.getUnit(),e=this.getFormater(),"none"!=t)&&""!=t&&(this.m_unitSymbol=this.m_util.getFormatterSymbol(e,t),this.m_formatterPosition=this.getSignPosition())},DecompositionChart.prototype.setSecondaryFormatter=function(){var t,e;this.m_secondaryUnitSymbol="",this.m_secondaryFormatterPosition="","none"!=this.m_secondaryformater&&""!=this.m_secondaryformater&&"Percent"!=this.getUnit()&&(t=this.getSecondaryUnit(),e=this.getSecondaryFormater(),""!=t&&"none"!=t&&null!=t&&(this.m_secondaryUnitSymbol=this.m_util.getFormatterSymbol(e,t)),this.m_secondaryFormatterPosition="suffix")},DecompositionChart.prototype.generateControlPoints=function(t,e){var i,r=[],s=+t[0],t=+t[1],a=+e[0],e=+e[1];if(s<t)return a=a,i=t-(t-s)/2,e=e,r.push(s+(t-s)/2),r.push(a),r.push(i),r.push(e),r},DecompositionChart.prototype.drawLinespath=function(t,e,i,r){for(var s,a,r="#group"+r+this.m_objectid,o="",n=i.length,h=0;h<n;h++)null!=e.yPositionArray[h+1]&&null!=(a=this.createBezierPath(e.xPositionArray[h],e.yPositionArray[h],i[0],i[1],i[2],i[3],e.xPositionArray[h+1],e.yPositionArray[h+1]))&&(o+=a);null!=o&&(s=e.getLineDashArray(e.lineType,e.lineWidth),(a=e.createPath(e.color[0],e.lineWidth,s)).setAttributeNS(null,"d",o),a.setAttributeNS(null,"id",e.id),this.m_path=a,$(r).append(a),document.documentMode)},DecompositionChart.prototype.createBezierPath=function(t,e,i,r,s,a,o,n){return""!==t&&""!==e&&""!==i&&""!==r&&""!==s&&""!==a&&""!==o&&""!==n?"M "+t+" "+e+" C "+i+" "+r+" "+s+" "+a+" "+o+" "+n:void 0},DecompositionChart.prototype.getSeriesInfo=function(){return{axis:"left",chart:"line",data:["300","100"]}},DecompositionChart.prototype.initCanvas=function(){$("#draggableDiv"+this.m_objectid).remove(),this.initializeDraggableDivAndCanvas()},DecompositionChart.prototype.initializeDraggableDivAndCanvas=function(){this.setDashboardNameAndObjectId(),this.m_draggableDiv=this.createDraggableDiv(this.m_chartContainer,this.m_zIndex),this.createDraggableCanvas(this.m_draggableDiv),this.setCanvasContext(),this.createSVG(),$("#draggableCanvas"+this.m_objectid).hide(),this.initMouseMoveEvent(this.m_chartContainer),this.initMouseClickEventForSVG(this.svgContainerId)},DecompositionChart.prototype.createStackGroup=function(t,e,i,r){var s=document.createElementNS("http://www.w3.org/2000/svg","g");s.setAttribute("id",e+i+this.m_objectid),s.setAttribute("class",e),s.setAttribute("data-fieldIndex",i),s.setAttribute("data-fieldName",r),$("#"+this.chartSvg).append(s)},DecompositionChart.prototype.createSVG=function(){this.svgContainerId="svgContainer"+this.m_objectid,$("#"+this.svgContainerId).remove();var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("xlink","http://www.w3.org/1999/xlink"),t.setAttribute("width",this.m_width),t.setAttribute("height",this.m_height),t.setAttribute("id",this.svgContainerId),$("#draggableDiv"+this.m_objectid).append(t),this.chartDiv()},DecompositionChart.prototype.createChartSVG=function(){this.chartSvg="chartSvg"+this.m_objectid,$("#"+this.chartSvg).remove();var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("xlink","http://www.w3.org/1999/xlink"),t.setAttribute("width",this.m_width),t.setAttribute("height",this.m_height),t.setAttribute("id",this.chartSvg),$("#chartSvgContainer"+this.m_objectid).append(t)},DecompositionChart.prototype.chartDiv=function(){var t=this,e=(this.chartSvgContainerId="chartSvgContainer"+t.m_objectid,$("#"+t.chartSvgContainerId).remove(),document.createElement("div"));e.style.width=this.m_width+"px",e.style.height=this.m_height+"px",e.style.position="absolute",e.style.top=this.m_height,e.style.overflow="auto",e.setAttribute("id",this.chartSvgContainerId),$("#draggableDiv"+t.m_objectid).append(e),1==t.getBgGradients().split(",").length?$("#draggableDiv"+t.m_objectid).css("background",t.getBgGradients()):$("#draggableDiv"+t.m_objectid).css("background-image","linear-gradient("+t.m_bggradientrotation+" , "+t.getBgGradients()+")"),this.createChartSVG()},DecompositionChart.prototype.initializeCalculation=function(){var t=this.updateSeriesData(this.visibleSeriesInfo.seriesData),e=this.updateSeriesData(this.m_categoryData);this.calculateMinimumMaximum(t),this.setChartDrawingArea(),this.m_calculation.init(this,e,this.visibleSeriesInfo.seriesData),this.m_xPositionArray=this.m_calculation.getXPositionArray(),this.m_yPositionArray=this.m_calculation.getYPositionArray(),this.m_barWidth=this.m_calculation.getbarWidth(),this.m_noofseries=this.m_calculation.xAxisData.length,this.m_barGap=this.m_calculation.getBarGap(),this.m_barWidthArray=this.m_calculation.getstackHeightArray(),IsBoolean(this.getCounterFlagForSeriesVisiblity())&&IsBoolean(this.m_showmarkingorpercentvalue)?(this.m_percentageArray=!IsBoolean(this.m_showpercentvalue)||IsBoolean(this.getCheckedAllPosContainigZero())?this.getPercentage():this.getRoundValue(this.getPercentage(),100),this.m_showPerCentageFlag=!0):(this.m_percentageArray=this.getArrayWhenPercentFlagIsFalse(),this.m_seriesInitializeFlag=!1),this.setColorsForSeries(),this.initializeBars(),this.initializeDataLabel()},DecompositionChart.prototype.calculateMinimumMaximum=function(t){var e=IsBoolean(this.m_isRepeaterPart)&&IsBoolean(this.m_parentObj.m_repeatercommonmarker)?this.getAllSeriesDataForRepeater():t,e="clustered"==this.m_charttype.toLowerCase()||"overlaid"==this.m_charttype.toLowerCase()||"stacked"==this.m_charttype.toLowerCase()&&1===t[0].length?this.calculateMinMaxValue(e):this.calculateFinalMinMaxValue(t),t=e.min,e=e.max,t=this.getCalculateNiceScale(t,e,this.m_basezero,this.m_autoaxissetup,this.m_minimumaxisvalue,this.m_maximumaxisvalue,this.m_width);this.min=t.min,this.max=t.max,this.m_numberOfMarkers=t.markerArray.length,this.m_xAxisText=t.step,this.m_xAxisMarkersArray=t.markerArray},DecompositionChart.prototype.calculateFinalMinMaxValue=function(t){var e=0,i=0;if("stacked"==this.m_charttype.toLowerCase()||""==this.m_charttype.toLowerCase())for(var r=0,s=t.length;r<s;r++){for(var a=0,o=0,n=0,h=t[r].length;n<h;n++)0<=t[r][n]?a=+a+ +(isNaN(t[r][n])?0:t[r][n]):o=+o+ +(isNaN(t[r][n])?0:t[r][n]);e<=a&&(e=+a),+o<i&&(i=+o)}else if("100%"==this.m_charttype){for(var l=!1,r=0,s=t.length;r<s;r++)for(var n=0,m=t[r].length;n<m;n++)if(t[r][n]<0){l=!0;break}e=100,i=IsBoolean(l)?-100:0}return{max:e,min:i}},DecompositionChart.prototype.getCheckedAllPosContainigZero=function(){for(var t=!0,e=0,i=this.m_seriesData[this.m_seriesVisiblityPosition].length;e<i;e++)0!=this.m_seriesData[this.m_seriesVisiblityPosition][e]&&(t=!1);return t},DecompositionChart.prototype.getArrayWhenPercentFlagIsFalse=function(){for(var t=[],e=0,i=this.m_seriesData.length;e<i;e++)t[e]=0;return t},DecompositionChart.prototype.getPercentage=function(){for(var t=[],e=this.getSumOfSeriesData(),i=0,r=this.m_seriesData[this.m_seriesVisiblityPosition].length;i<r;i++)IsBoolean(this.m_showpercentvalue)?(0<this.m_seriesData[this.m_seriesVisiblityPosition][i]?t[i]=this.m_seriesData[this.m_seriesVisiblityPosition][i]/e*100:t[i]=0,this.m_showPercentValueFlag=!0):t[i]=this.m_seriesData[this.m_seriesVisiblityPosition][i];return t},DecompositionChart.prototype.getSumOfSeriesData=function(){for(var t=0,e=0,i=this.m_seriesData[this.m_seriesVisiblityPosition].length;e<i;e++)"NaN"==this.m_seriesData[this.m_seriesVisiblityPosition][e]&&(this.m_seriesData[this.m_seriesVisiblityPosition][e]=0),0<this.m_seriesData[this.m_seriesVisiblityPosition][e]&&(t=+t+ +this.m_seriesData[this.m_seriesVisiblityPosition][e]);return t},DecompositionChart.prototype.getAllSeriesDataForRepeater=function(){for(var t=[],e=0;e<this.m_parentObj.m_seriesNames.length;e++)if(t[e]=[],IsBoolean(this.m_parentObj.m_seriesVisibleArr[this.m_parentObj.m_seriesNames[e]]))for(var i=0;i<this.m_parentObj.m_dataProvider.length;i++){var r=removeCommaFromSrting(this.m_parentObj.m_dataProvider[i][this.m_parentObj.m_seriesNames[e]]);t[e][i]=r}return t=this.getUpdateSeriesDataWithCategory(t)},DecompositionChart.prototype.initializeDataLabel=function(){this.m_valueTextSeries={};for(var t,e,i=0,r=0;r<this.m_seriesNames.length;r++)IsBoolean(this.m_seriesVisibleArr[this.m_seriesNames[r]])&&("overlaid"!=this.m_charttype.toLowerCase()&&!IsBoolean(this.m_seriesDataLabelProperty[r].showDataLabel)||(this.m_datalablebackgroundrect=!!IsBoolean(this.m_seriesDataLabelProperty[r].datalabelBackgroundRect)||this.m_datalablebackgroundrect,this.m_valueTextSeries[this.m_seriesNames[r]]=new ValueTextSeries,"100%"==this.m_charttype&&void 0!==this.m_seriesDataLabelProperty[i].showPercentValue&&IsBoolean(this.m_seriesDataLabelProperty[i].showPercentValue)&&(this.m_seriesDataForDataLabel[i]=this.getPercentageForHundred()[i]),t="overlaid"==this.m_charttype.toLowerCase()?this.m_seriesDataLabelPropertyOverlaid[i]:this.m_seriesDataLabelProperty[r],e="overlaid"==this.m_charttype.toLowerCase()?this.m_actualseriesdatamap[i]:this.m_seriesData[r],this.m_valueTextSeries[this.m_seriesNames[r]].init(this.m_xPositionArray[i],this.m_yPositionArray[i],this,this.m_seriesDataForDataLabel[i],t,e,this.m_barWidth,this.m_barWidthArray[i])),i++)},DecompositionChart.prototype.getColorsForSeries=function(){return this.m_seriesColorsArray},DecompositionChart.prototype.setColorsForSeries=function(){if(this.m_seriesColorsArray=[],IsBoolean(this.m_enablecolorfromdrill)&&IsBoolean(this.m_startDrill))for(var t=0,e=this.visibleSeriesInfo.seriesData.length;t<e;t++){this.m_seriesColorsArray[t]=[];for(var i=0,r=this.visibleSeriesInfo.seriesData[t].length;i<r;i++)this.m_seriesColorsArray[t][i]=this.m_drillColor}else if("overlaid"==this.m_charttype||"Overlaid"==this.m_charttype)this.m_seriesColorsArray=this.m_calculation.getSeriesColorForOverlaid();else if(!IsBoolean(this.m_designMode)&&""!=this.getCategoryColors()&&0<this.getCategoryColors().getCategoryColor().length&&IsBoolean(this.getCategoryColors().getshowColorsFromCategoryName()))for(var s=this.getCategoryColors().getCategoryColorsForCategoryNames(this.getCategoryData()[0],this.m_categoryFieldColor),t=0,e=this.visibleSeriesInfo.seriesData.length;t<e;t++){this.m_seriesColorsArray[t]=[];for(i=0,r=this.visibleSeriesInfo.seriesData[t].length;i<r;i++)this.m_seriesColorsArray[t][i]=s[i]}else if(IsBoolean(this.m_designMode)||""==this.getCategoryColors()||IsBoolean(this.getCategoryColors().getshowColorsFromCategoryName())&&0!=this.getCategoryColors().getCategoryColor().length||""==this.getConditionalColors()||null==this.getConditionalColors()||!(0<this.getConditionalColors().getConditionalColor().length))for(var a=this.visibleSeriesInfo.seriesColor,t=0,e=this.visibleSeriesInfo.seriesData.length;t<e;t++){this.m_seriesColorsArray[t]=[];for(i=0,r=this.visibleSeriesInfo.seriesData[t].length;i<r;i++)this.m_seriesColorsArray[t][i]=a[t]}else for(var o=this.getConditionalColors().getConditionalColorsForConditions(this.visibleSeriesInfo.seriesName,this.visibleSeriesInfo.seriesColor,this.visibleSeriesInfo.seriesData,this),t=0,e=this.visibleSeriesInfo.seriesData.length;t<e;t++){this.m_seriesColorsArray[t]=[];for(var i=0,r=this.visibleSeriesInfo.seriesData[t].length;i<r;i++)this.m_seriesColorsArray[t][i]=o[t][i]}},DecompositionChart.prototype.updateSeriesData=function(t){var e=[];if(null!=t&&null!==t&&""!==t&&0!=t.length)for(var i=0,r=t[0].length;i<r;i++){e[i]=[];for(var s=0,a=t.length;s<a;s++)e[i][s]=t[s][i]}return e},DecompositionChart.prototype.drawObject=function(){this.drawSVGObject()},DecompositionChart.prototype.drawTitle=function(){this.m_title.draw()},DecompositionChart.prototype.drawSubTitle=function(){this.m_subTitle.draw()},DecompositionChart.prototype.drawLoaderIcon=function(t,e){var i=this,r=document.createElement("div");r.setAttribute("id","dcloaderImage"+i.m_objectid),r.setAttribute("class","loaderImage"),$("#chartSvgContainer"+i.m_objectid).append(r),$("#dcloaderImage"+i.m_objectid).css({"z-index":i.m_zIndex+2,left:t+"px",top:e+"px"}).on("click",function(){$("#loaderImageContent"+i.m_objectid).toggle("slide",{direction:"up"},200),$("#loaderImageContentArrow"+i.m_objectid).toggle()}).append('<div style="position:absolute;height:100%;width:100%;left:0px;top:0px;" class="la-ball-clip-rotate la-dark la-lg loaderImageRotation"><div style="border-width:2px;height:80%;width:80%;"></div></div>'),$("#dcloaderImage"+i.m_objectid).show()},DecompositionChart.prototype.setSVGDimension=function(){var t=this.m_subTitle.m_titleMargin+(IsBoolean(this.m_subTitle.m_showsubtitle)?null!=this.m_subTitle.m_subtitleText?+this.m_subTitle.m_subtitleText.getBBox().height:+this.m_subTitle.m_subTitleBarHeight:0);$("#GradientRect"+this.m_objectid).css("height",t+"px"),$("#"+this.chartSvgContainerId).css("top",t+"px"),$("#"+this.chartSvgContainerId).css("height",this.m_height-t+"px"),$("#"+this.chartSvg).css("height",this.m_height-t-10+"px")},DecompositionChart.prototype.drawChartFrame=function(){this.m_chartFrame.drawSVGFrame(),this.getBGGradientColorToContainer()},DecompositionChart.prototype.getBGGradientColorToContainer=function(){var t=document.createElementNS("http://www.w3.org/2000/svg","defs"),e=document.createElementNS(NS,"filter"),i=(e.setAttribute("id","stackShadow"+this.m_objectid),document.createElementNS(NS,"feOffset")),r=(i.setAttribute("dx","0"),i.setAttribute("dy","0"),i.setAttribute("result","offOut"),i.setAttribute("in","SourceGraphic"),document.createElementNS(NS,"feGaussianBlur")),s=(r.setAttribute("result","blurOut"),r.setAttribute("in","offOut"),r.setAttribute("stdDeviation","1"),document.createElementNS(NS,"feColorMatrix")),a=(s.setAttribute("in","blurOut"),s.setAttribute("result","color-out"),s.setAttribute("type","matrix"),s.setAttribute("values",hex2Matrix(this.m_stackshadowcolor,this.m_stackshadowopacity)),document.createElementNS(NS,"feBlend"));a.setAttribute("in","SourceGraphic"),a.setAttribute("in2","color-out"),a.setAttribute("mode","normal"),e.appendChild(i),e.appendChild(r),e.appendChild(s),e.appendChild(a),t.appendChild(e),$("#"+this.svgContainerId).append(t)},DecompositionChart.prototype.drawDataLabel=function(){for(var t,e=0,i=this.m_seriesNames.length;e<i;e++)IsBoolean(this.m_seriesVisibleArr[this.m_seriesNames[e]])&&(t=this.m_valueTextSeries[this.m_seriesNames[e]],"overlaid"!=this.m_charttype.toLowerCase()&&!IsBoolean(this.m_seriesDataLabelProperty[e].showDataLabel)||(this.createDataLabelGroup(t,"datalabelgrp",e,this.m_seriesNames[e]),t.drawValueTextSeries()))},DecompositionChart.prototype.drawSVGCross=function(t,e,i,r,s,a,o,n,h){var l=this,m=this.drawSVGLine(t,e,t+i,e+i,r,s,a,o,n,"1"),r=this.drawSVGLine(t+i,e,t,e+i,r,s,a,o,n,"1"),s=drawSVGRect(t,e,i,i,this.m_fillcolor),a=(s.setAttributeNS(null,"fill-opacity","0"),this.createStackGroup("","crossgroup"+h,"","Group"));return $("#crossgroup"+h+this.m_objectid).append(m,r,s),$("#crossgroup"+h+this.m_objectid).on("click",function(t){t.preventDefault(),t.stopPropagation();var t=this.id.split("crossgroup")[1].split(l.m_objectid)[0],e=l.m_contextseriesfields.indexOf(t),i=(null!=l.uparrow&&l.updateArrowInfo(t),l.m_contextseriesfields.splice(e,1),Array.from(l.m_seriesDNames)),r={},t=Array.from(l.m_contextseriesfields),s=Array.from(l.m_seriesNames);l.m_contextseriesfields.length;t.map(function(t,e){i.splice(s.indexOf(t),1),s.splice(s.indexOf(t),1),r[t]={},r[t].levels=Array.from(i),r[t].id=null==l.m_updatedhierarchylevel[t]?void 0:l.m_updatedhierarchylevel[t].id,r[t].nodeid=null==l.m_updatedhierarchylevel[t]?void 0:l.m_updatedhierarchylevel[t].nodeid}),l.m_updatedhierarchylevel=r,$("#contexleveldiv").remove(),0==l.m_seriesfields.length&&((e=Array.from(l.m_seriesfields)).push(l.m_seriesNames[0]),l.m_seriesfields=e,l.m_contexthierarchy=void 0),l.init(),l.drawChart()}),a},DecompositionChart.prototype.drawSVGArrow=function(t,e,i,r,s,a,o,n,h,l,m){var d,c,p=this,_=this.createStackGroup("","arrowgroup"+h,"","Group"),n=""!=n?n:this.m_fillcolor;return null!=this.uparrow[p.m_childdata[h].parentid]&&IsBoolean(this.lastLevel[p.m_childdata[h].parentid])||(d=this.drawSVGLine(t-+m,e,t,e+ +m,r,s,a,o,n,l),c=this.drawSVGLine(t,e+ +m,t+ +m,e,r,s,a,o,n,l),(e=drawSVGRect(t-+m-5,e-5,2*m+10,+m+10,this.m_fillcolor)).setAttributeNS(null,"fill-opacity","0"),this.createStackGroup("","uparrowgroup"+h,"","Group"),$("#uparrowgroup"+h+this.m_objectid).append(d,c,e),$("#arrowgroup"+h+this.m_objectid).append($("#uparrowgroup"+h+this.m_objectid))),0<p.uparrow[p.m_childdata[h].parentid]&&(d=this.arrowmargin,c=this.drawSVGLine(t-+m,d,t,d-+m,r,s,a,o,n,l),e=this.drawSVGLine(t,d-+m,t+ +m,d,r,s,a,o,n,l),(r=drawSVGRect(t-+m-5,d-+m-5,2*m+10,+m+10,this.m_fillcolor)).setAttributeNS(null,"fill-opacity","0"),this.createStackGroup("","downarrowgroup"+h,"","Group"),$("#downarrowgroup"+h+this.m_objectid).append(c,e,r),$("#arrowgroup"+h+this.m_objectid).append($("#downarrowgroup"+h+this.m_objectid))),$("#uparrowgroup"+h+this.m_objectid).on("click",function(t){t.preventDefault(),t.stopPropagation(),p.arrowclicked="true";t=this.id.split("arrowgroup")[1].split(p.m_objectid)[0],IsBoolean(p.m_showcontextlevels)&&""!=p.m_childdata[t].childfieldname&&p.updateArrowInfo(p.m_childdata[t].childfieldname),null!=p.uparrow[p.m_childdata[t].parentid]?p.uparrow[p.m_childdata[t].parentid]=p.uparrow[p.m_childdata[t].parentid]+1:p.uparrow[p.m_childdata[t].parentid]=1,t=Object.keys(p.m_drawnode).indexOf(p.m_childdata[t].fieldName);-1!==t&&Object.keys(p.m_drawnode).slice(t).forEach(function(t){delete p.m_drawnode[t]}),p.drawLoaderIcon($(this)[0].childNodes[1].getBBox().x,$(this)[0].childNodes[1].getBBox().y),$(this).remove(),setTimeout(function(){p.init(),p.drawChart()},100)}),$("#downarrowgroup"+h+this.m_objectid).on("click",function(t){t.preventDefault(),t.stopPropagation(),p.arrowclicked="true";t=this.id.split("arrowgroup")[1].split(p.m_objectid)[0],null!=p.uparrow[p.m_childdata[t].parentid]&&(p.uparrow[p.m_childdata[t].parentid]=p.uparrow[p.m_childdata[t].parentid]-1),t=Object.keys(p.m_drawnode).indexOf(p.m_childdata[t].fieldName);-1!==t&&Object.keys(p.m_drawnode).slice(t).forEach(function(t){delete p.m_drawnode[t]}),p.drawLoaderIcon($(this)[0].childNodes[1].getBBox().x,$(this)[0].childNodes[1].getBBox().y),$(this).remove(),setTimeout(function(){p.init(),p.drawChart()},100)}),_},DecompositionChart.prototype.drawSVGLine=function(t,e,i,r,s,a,o,n,h,l){var m=document.createElementNS(NS,"line");return m.style.stroke=h,m.style.opacity=1,m.setAttribute("stroke-width",l),m.setAttribute(s+o,t+"px"),m.setAttribute(a+o,e+"px"),m.setAttribute(s+n,i+"px"),m.setAttribute(a+n,r+"px"),m},DecompositionChart.prototype.drawSVGText=function(t,e,i,r,s,a,o,n,h,l,m,d,c,p,_,g){var u=document.createElementNS(NS,"text");return u.setAttribute("text-anchor",l),u.setAttribute("fill",h),u.setAttribute("font-size",d+"px"),u.setAttribute("font-weight",m),u.setAttribute("font-family",selectGlobalFont(c)),u.setAttribute("font-style",p),u.setAttribute("stroke-width",.1),u.setAttribute("alignment-baseline","baseline"),u.setAttribute(o,e+"px"),u.setAttribute(n,i+"px"),void 0!==_&&u.setAttribute("id",_),void 0!==g?this.getLayoutText(u,t,e,r,s,a,g):this.getLayoutText(u,t,e,r,s,a),u},DecompositionChart.prototype.getLayoutText=function(t,e,i,r,s,a,o){for(var n=e,h=document.createElementNS(NS,"tspan"),l=(h.setAttributeNS(null,"x",i),void 0!==o&&h.setAttributeNS(null,"dy",o),h.setAttribute("title",e),t.appendChild(h),h.textContent="..",h.getComputedTextLength()),m=(h.textContent=e,h.getComputedTextLength());r-l<m;)n=n.slice(0,-1),h.textContent=n,m=h.getComputedTextLength();n!=e?n+="..":n=e,h.textContent=n},DecompositionChart.prototype.getArraySUM=function(t){for(var e=0,i=0,r=t.length;i<r;i++)t[i]<0&&(t[i]=-1*t[i]),isNaN(t[i])||(e=+e+ +t[i]);return e},DecompositionChart.prototype.getUpdateSeriesDataWithCategory=function(t){for(var e=[],i=0,r=t[0].length;i<r;i++){e[i]=[];for(var s=0,a=t.length;s<a;s++)e[i][s]=t[s][i]}return e},DecompositionChart.prototype.setPercentageForHundred=function(){for(var t=this.getUpdateSeriesDataWithCategory(this.visibleSeriesInfo.seriesData),e=(this.m_SeriesDataInPerForHundredChart,[]),i=0,r=t.length;i<r;i++){var s=this.getArraySUM(t[i]);e[i]=[];for(var a=0,o=t[i].length;a<o;a++)""===t[i][a]||isNaN(t[i][a])?e[i][a]=0:e[i][a]=t[i][a]/s*100}0<e.length&&(this.m_SeriesDataInPerForHundredChart=this.getUpdateSeriesDataForHundredPercentageChart(e))},DecompositionChart.prototype.getUpdateSeriesDataForHundredPercentageChart=function(t){for(var e=[],i=0,r=t[0].length;i<r;i++){e[i]=[];for(var s=0,a=t.length;s<a;s++)e[i][s]=t[s][i]}for(i=0,r=this.visibleSeriesInfo.seriesData.length;i<r;i++)for(var s=0,o=this.visibleSeriesInfo.seriesData[i].length;s<o;s++)isNaN(this.visibleSeriesInfo.seriesData[i][s])||+this.visibleSeriesInfo.seriesData[i][s]<0&&(e[i][s]=-1*e[i][s]);return e},DecompositionChart.prototype.getPercentageForHundred=function(){return this.m_SeriesDataInPerForHundredChart},DecompositionChart.prototype.getVisibleActualSeriesData=function(){for(var t=[],e=0,i=0;this.m_seriesData.length>i;i++)IsBoolean(this.m_seriesVisibleArr[this.m_seriesNames[i]])&&(t[e]=[],t[e]=this.m_seriesDataForToolTip[i],e++);return t},DecompositionChart.prototype.getToolTipData=function(t,e){var i;if(!IsBoolean(this.m_isEmptySeries)&&!IsBoolean(this.isEmptyCategory)&&IsBoolean(this.isVisibleSeries())&&IsBoolean("None"!==this.m_customtextboxfortooltip.dataTipType)){var r="clustered"==this.m_charttype?this.m_barWidth*this.m_yPositionArray.length:this.m_barWidth,s="";if(t>=this.getStartX()&&t<=this.getEndX()&&e<=this.getStartY()&&e>=this.getEndY()){for(var a=this.getVisibleActualSeriesData(),o=(this.yPositions=this.m_calculation.getYPositionforToolTip(),this.getPercentageForHundred()),n=0,h=this.yPositions.length;n<h;n++)if(e<=+this.yPositions[n]+ +r&&e>=+this.yPositions[n]){if((i={cat:""}).data=new Array,i.cat=this.getCategoryData()[0][n],"Default"==this.m_customtextboxfortooltip.dataTipType){for(var l=0,m=0,d=a.length;l<d;l++){var c=[],p=(c[0]={shape:this.legendMap[this.getSeriesNames()[l]].shape},IsBoolean(this.m_enablecolorfromdrill)&&IsBoolean(this.m_startDrill)?c[0].color="overlaid"!=this.m_charttype?this.getColorsForSeries()[l][n]:this.m_drillColor:c[0].color="overlaid"!=this.m_charttype?this.getColorsForSeries()[l][n]:this.visibleSeriesInfo.seriesColor[l],c[1]=this.visibleSeriesInfo.seriesDisplayName[l],s=""==a[l][n]||isNaN(a[l][n])||null==a[l][n]||"null"==a[l][n]?a[l][n]:(p=+a[l][n])%1!=0&&"default"!==this.m_tooltipprecision?p.toFixed(this.m_tooltipprecision):+a[l][n],this.getUpdatedFormatterForToolTip(s,this.visibleSeriesInfo.seriesName[l]));if(c[2]=p,"100%"==this.m_charttype&&1<this.getSeriesDisplayNames().length){"auto"==this.m_tooltipproperties.tooltippercentprecision?0==countDecimal(o[l][n].toString())?c[3]=o[l][n]+"%":(c[3]=o[l][n].toFixed(2),c[3]=c[3]%1==0?(+c[3]).toFixed()+"%":c[3]+"%"):c[3]=o[l][n].toFixed(this.m_tooltipproperties.tooltippercentprecision)+"%";for(var _=0,g=0;g<=l;g++)isNaN(a[g][n])||(_+=+a[g][n]);for(var u=0,y=0;y<=l;y++)isNaN(o[y][n])||(u+=o[y][n]);IsBoolean(this.m_tooltipproperties.showcummulativesum)&&(c[4]=this.getNumberWithCommas(_)),IsBoolean(this.m_tooltipproperties.showcummulativepercent)&&(c[5]=u.toFixed(2)+"%")}i.data[m]=c,m++}i.highlightIndex=this.getDrillColor(t,e),IsBoolean(this.m_controlledtooltip)&&(i=this.updateTooltipData(i));break}i=this.getDataProvider()[n]}}else this.hideToolTip()}return i},DecompositionChart.prototype.getDrillColor=function(t,e){if(!IsBoolean(this.m_isEmptySeries)&&!IsBoolean(this.isEmptyCategory)&&(this.xPositionArr=this.m_calculation.getXPositionArray(),this.yAxisDataArray=this.m_calculation.getYPositionArray(),this.m_barWidthArray=this.m_calculation.getstackHeightArray(),t>=this.getStartX())&&t<=this.getEndX()&&e<=this.getStartY()&&e>=this.getEndY()){var i,r="stacked"==this.m_charttype?0:this.m_drillminstackheight;if(IsBoolean(this.m_basezero)&&(i=this.getVisibleActualSeriesData()),"overlaid"!=this.m_charttype){for(var s=0,a=this.yAxisDataArray.length;s<a;s++)for(var o,n=0,h=this.yAxisDataArray[s].length;n<h;n++)if(m=+this.m_barWidthArray[s][n]<0?(o=+this.m_barWidthArray[s][n]<-r?+this.m_barWidthArray[s][n]:-r,l=+this.xPositionArr[s][n],+this.xPositionArr[s][n]+o):(o=IsBoolean(this.m_basezero)&&+i[s][n]<0?0:+this.m_barWidthArray[s][n]>r?+this.m_barWidthArray[s][n]:r,l=+this.xPositionArr[s][n]+o,+this.xPositionArr[s][n]),t<=l&&m<=t&&e<=+this.yAxisDataArray[s][n]+ +this.m_barWidth&&e>=+this.yAxisDataArray[s][n])return s}else for(s=this.yAxisDataArray.length-1;0<=s;s--)for(var l,m,n=this.yAxisDataArray[s].length-1;0<=n;n--)if(m=+this.m_barWidthArray[s][n]<0?(o=+this.m_barWidthArray[s][n]<-r?+this.m_barWidthArray[s][n]:-r,l=+this.xPositionArr[s][n],+this.xPositionArr[s][n]+o):(o=IsBoolean(this.m_basezero)&&+i[s][n]<0?0:+this.m_barWidthArray[s][n]>r?+this.m_barWidthArray[s][n]:r,l=+this.xPositionArr[s][n]+o,+this.xPositionArr[s][n]),t<=l&&m<=t&&e<=+this.yAxisDataArray[s][n]+ +this.m_barWidth&&e>=+this.yAxisDataArray[s][n])return this.m_calculation.m_originalindexforoverlaiddata[2][s][n]}},DecompositionChart.prototype.getDrillDataPoints=function(t,e){if(!IsBoolean(this.m_isEmptySeries)&&!IsBoolean(this.isEmptyCategory)&&IsBoolean(this.isVisibleSeries())&&(this.xPositionArr=this.m_calculation.getXPositionArray(),this.yAxisDataArray=this.m_calculation.getYPositionArray(),this.m_barWidthArray=this.m_calculation.getstackHeightArray(),t>=this.getStartX())&&t<=this.getEndX()&&e<=this.getStartY()&&e>=this.getEndY()){var i,r=!1,s="stacked"==this.m_charttype?0:this.m_drillminstackheight;if(IsBoolean(this.m_basezero)&&(i=this.getVisibleActualSeriesData()),"overlaid"!=this.m_charttype){for(var a=0,o=this.yAxisDataArray.length;a<o;a++)for(var n,h=0,l=this.yAxisDataArray[a].length;h<l;h++)if(v=+this.m_barWidthArray[a][h]<0?(n=+this.m_barWidthArray[a][h]<-s?+this.m_barWidthArray[a][h]:-s,x=+this.xPositionArr[a][h],+this.xPositionArr[a][h]+n):(n=IsBoolean(this.m_basezero)&&+i[a][h]<0?0:+this.m_barWidthArray[a][h]>s?+this.m_barWidthArray[a][h]:s,x=+this.xPositionArr[a][h]+n,+this.xPositionArr[a][h]),t<=x&&v<=t&&e<=+this.yAxisDataArray[a][h]+ +this.m_barWidth&&e>=+this.yAxisDataArray[a][h]){for(var m=this.getFieldNameValueMap(h),d=this.getColorsForSeries()[a][h],c=this.visibleSeriesInfo.seriesName[a],p=this.visibleSeriesInfo.seriesDisplayName[a],_=m[c],g=(m.drillField=c,m.drillDisplayField=p,m.drillValue=_,r=!0,m.drillIndex=h,this.m_categoryNames),u=[],h=0;h<g.length;h++)u.push(m[g[h]]);return m.drillCategoryNames=g,m.drillCategory=u,IsBoolean(this.m_drilltoggle)?this.m_drilltoggle=!1:this.m_drilltoggle=!0,{drillRecord:m,drillColor:d}}if("stacked"==this.m_charttype&&!r)for(var y=0,o=this.yPositions.length;y<o;y++)if(e<=+this.yPositions[y]+ +this.m_barWidth&&e>=+this.yPositions[y])for(var f=0,b=this.xPositionArr.length;f<b;f++)if(t>=this.xPositionArr[f][y]&&t<=this.xPositionArr[f][y]+this.m_drillminstackheight||t<=this.xPositionArr[f][y]+this.m_barWidthArray[f][y]&&t>=this.xPositionArr[f][y]-this.m_drillminstackheight)return m=this.getFieldNameValueMap(y),d=this.m_drillColor,_=p=c="",m.drillField=c,m.drillDisplayField=p,m.drillValue=_,r=!0,{drillRecord:m,drillColor:d}}else for(a=this.yAxisDataArray.length-1;0<=a;a--)for(var x,v,h=this.yAxisDataArray[a].length-1;0<=h;h--)if(v=+this.m_barWidthArray[a][h]<0?(n=+this.m_barWidthArray[a][h]<-s?+this.m_barWidthArray[a][h]:-s,x=+this.xPositionArr[a][h],+this.xPositionArr[a][h]+n):(n=IsBoolean(this.m_basezero)&&+i[a][h]<0?0:+this.m_barWidthArray[a][h]>s?+this.m_barWidthArray[a][h]:s,x=+this.xPositionArr[a][h]+n,+this.xPositionArr[a][h]),t<=x&&v<=t&&e<=+this.yAxisDataArray[a][h]+ +this.m_barWidth&&e>=+this.yAxisDataArray[a][h])return m=this.getFieldNameValueMap(h),d=this.getColorsForSeries()[a][h],c=this.visibleSeriesInfo.seriesName[this.m_calculation.m_originalindexforoverlaiddata[2][a][h]],p=this.visibleSeriesInfo.seriesDisplayName[this.m_calculation.m_originalindexforoverlaiddata[2][a][h]],_=m[c],m.drillField=c,m.drillDisplayField=p,m.drillValue=_,m.drillIndex=h,IsBoolean(this.m_drilltoggle)?this.m_drilltoggle=!1:this.m_drilltoggle=!0,{drillRecord:m,drillColor:d}}},DecompositionChart.prototype.setLineAnimation=function(t){t.style.strokeDashoffset="0";var e,i=t.getTotalLength(),r=(t.style.transition=t.style.WebkitTransition="none",t.style.strokeDasharray||t.getAttribute("stroke-dasharray"));""!=r?(e=r.split(/[\s,]/).map(function(t){return parseFloat(t)||0}).reduce(function(t,e){return t+e}),r=new Array(Math.ceil(i/e)).join(r+" "),t.style.strokeDasharray=r+"0, "+e,t.style.strokeDashoffset=e*e,t.getBoundingClientRect()):(t.style.strokeDasharray=i+" "+i,t.style.strokeDashoffset=i,t.getBoundingClientRect(),t.style.transitionDelay="0.2s"),t.style.transition=t.style.WebkitTransition="stroke-dashoffset 0.5s linear",t.style.strokeDashoffset="0"},DSLineSeries.prototype.init=function(t,e,i,r,s,a,o,n,h,l){this.m_chart=s,this.seriesName=o,this.ctx=this.m_chart.ctx,this.color=t,this.width=r,this.xPositionArray=e,this.yPositionArray=i,this.plotTrasparency=a,this.fillTrasparency=l,this.lineWidth=n,this.lineType=h;s="left"==this.m_chart.getSeriesInfo(this.seriesName).axis?this.m_chart.leftAxisInfo:this.m_chart.rightAxisInfo;this.basePoint=this.getBasePoint(s)},DSLineSeries.prototype.getBasePoint=function(t){t=t.min<0&&t.max<0?this.m_chart.getEndY():t.min<0&&0<t.max?this.m_chart.getStartY()-Math.abs((this.m_chart.getStartY()-this.m_chart.getEndY())/(t.max-t.min)*t.min):this.m_chart.getStartY();return t},DSLineSeries.prototype.drawLineSeries=function(t){"curve"==this.m_chart.m_lineform&&this.xPositionArray.length<500?IsBoolean(this.m_chart.m_fillarea)&&this.m_chart.getSeriesFillAreaMap()[this.m_chart.getSeriesNames()[t]]?this.drawSplinesArea(t):this.drawSplines(t):IsBoolean(this.m_chart.m_fillarea)&&this.m_chart.getSeriesFillAreaMap()[this.m_chart.getSeriesNames()[t]]?this.drawSegmentArea(t):this.drawSegmentLines(t)},DSLineSeries.prototype.createBezierPathArea=function(t,e,i,r,s,a,o,n,h,l,m){return""!=t&&""!=e&&""!=i&&""!=r&&""!=s&&""!=a&&""!=o&&""!=n?0==h?"M "+t+" "+l+"L "+t+" "+e+" C "+i+" "+r+" "+s+" "+a+" "+o+" "+n:h==m?"L "+t+" "+e+" C "+i+" "+r+" "+s+" "+a+" "+o+" "+n+"L "+o+" "+l:"L "+t+" "+e+" C "+i+" "+r+" "+s+" "+a+" "+o+" "+n:void 0},DSLineSeries.prototype.drawSegmentArea=function(t){for(var e=this,i=this.xPositionArray,r=this.yPositionArray,s=e.m_chart.scaleFlag?"#linegrpslider"+t+e.m_chart.m_objectid:"#linestackgrp"+t+e.m_chart.m_objectid,a=(this.clipFillArea(),this.getAreaPath(i,r,e.basePoint)),o=this.getLineDashArray(this.lineType,this.lineWidth),n=0;n<a.length;n++){var h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttribute("d",a[n]),h.setAttribute("clip-path","url(#clipPath"+e.m_chart.m_objectid+")"),h.setAttribute("stroke-dasharray",o),h.setAttribute("style","stroke:"+e.color[0]+"; stroke-width:"+e.lineWidth+";fill:"+hex2rgb(e.m_chart.m_fillareacolor,this.fillTrasparency)+";"),$(s).append(h)}},DSLineSeries.prototype.drawSegmentLines=function(t){var e,i,r=this,s=this.xPositionArray,a=this.yPositionArray,t=r.m_chart.scaleFlag?"#linegrpslider"+t+r.m_chart.m_objectid:"#linestackgrp"+t+r.m_chart.m_objectid,o=this.pathString(s,a,r.m_chart.getStartY(),r.m_chart.getEndY()),s=IsBoolean(this.m_chart.m_continuousline)?this.pathStringContinuous(s,a,r.m_chart.getStartY(),r.m_chart.getEndY()):void 0;null!=o&&""!=o&&(a=this.getLineDashArray(this.lineType,this.lineWidth),(e=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",o),e.setAttribute("stroke-dasharray",a),e.setAttribute("style","stroke:"+r.color[0]+"; stroke-width:"+r.lineWidth+";fill:none;"),$(t).append(e),i=!!document.documentMode,IsBoolean(this.m_chart.m_enableanimation))&&IsBoolean(!this.m_chart.scaleFlag)&&!i&&this.setLineAnimation(e),null!=s&&""!=s&&(o=this.getLineDashArray(this.m_chart.getLineType(this.lineType),this.lineWidth),(a=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",s),a.setAttribute("stroke-dasharray",o),a.setAttribute("style","stroke:"+r.color[0]+"; stroke-width:"+r.lineWidth+";fill:none;"),$(t).append(a),i=!!document.documentMode,IsBoolean(this.m_chart.m_enableanimation))&&IsBoolean(!this.m_chart.scaleFlag)&&!i&&this.setLineAnimation(a)},DSLineSeries.prototype.createPath=function(t,e,i){e=void 0===e?"3":e;var r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttributeNS(null,"fill","none"),r.setAttribute("stroke-dasharray",i),r.setAttributeNS(null,"stroke",t),r.setAttributeNS(null,"stroke-width",e),r},DSLineSeries.prototype.drawSplines=function(t){for(var e,i,r,s=this,t=(px=this.computeControlPoints(this.xPositionArray),py=this.computeControlPoints(this.yPositionArray),s.m_chart.scaleFlag?"#linegrpslider"+t+s.m_chart.m_objectid:"#linestackgrp"+t+s.m_chart.m_objectid),a="",o="",n=px.p1.length,h=0;h<n;h++)if(this.yPositionArray[h]<=s.m_chart.getStartY()&&this.yPositionArray[h]>=s.m_chart.getEndY()&&this.yPositionArray[h+1]<=s.m_chart.getStartY()&&this.yPositionArray[h+1]>=s.m_chart.getEndY())null!=(e=this.createBezierPath(this.xPositionArray[h],this.yPositionArray[h],px.p1[h],py.p1[h],px.p2[h],py.p2[h],this.xPositionArray[h+1],this.yPositionArray[h+1]))&&(a+=e);else if(IsBoolean(this.m_chart.m_continuousline)){for(var l=0,m=0,d=h;0<=d;d--)if(""!=this.yPositionArray[d]&&null!=this.yPositionArray[d]&&!isNaN(this.yPositionArray[d])){l=d;break}for(var c,p=h+1;p<=this.xPositionArray.length;p++)if(""!=this.yPositionArray[p]&&null!=this.yPositionArray[p]&&!isNaN(this.yPositionArray[p])){m=p;break}""==this.yPositionArray[l]||null==this.yPositionArray[l]||isNaN(this.yPositionArray[l])||0==m||(c=this.createBezierPath(this.xPositionArray[l],this.yPositionArray[l],px.p1[l],py.p1[l],px.p2[l],py.p2[l],this.xPositionArray[m],this.yPositionArray[m]));for(var _=!0,g=h;0<g;g--)if(c=="M"+o.split("M")[g]){_=!1;break}null!=c&&IsBoolean(_)&&(o+=c)}null!=a&&(r=this.getLineDashArray(this.lineType,this.lineWidth),(e=this.createPath(this.color[0],this.lineWidth,r)).setAttributeNS(null,"d",a),$(t).append(e),r=!!document.documentMode,IsBoolean(this.m_chart.m_enableanimation))&&IsBoolean(!this.m_chart.scaleFlag)&&!r&&this.setLineAnimation(e),null!=o&&(i=this.getLineDashArray(this.m_chart.getLineType(this.lineType),this.lineWidth),(c=this.createPath(this.color[0],this.lineWidth,i)).setAttributeNS(null,"d",o),$(t).append(c),r=!!document.documentMode,IsBoolean(this.m_chart.m_enableanimation))&&IsBoolean(!this.m_chart.scaleFlag)&&!r&&this.setLineAnimation(c)},DSLineSeries.prototype.getLineDashArray=function(t,e){return"dot"===t?[+e,2*e+1,0,0]:"dash1"===t?[+e,+e,4*e,+e]:"dash"===t?[2*e,2*e+1,0,0]:[]},DSLineSeries.prototype.createBezierPath=function(t,e,i,r,s,a,o,n){return""!==t&&""!==e&&""!==i&&""!==r&&""!==s&&""!==a&&""!==o&&""!==n?"M "+t+" "+e+" C "+i+" "+r+" "+s+" "+a+" "+o+" "+n:void 0},DSLineSeries.prototype.computeControlPoints=function(t){var e=new Array,i=new Array,r=t.length-1,s=new Array,a=new Array,o=new Array,n=new Array;a[s[0]=0]=2,o[0]=1,n[0]=t[0]+2*t[1];for(var h=1;h<r-1;h++)s[h]=1,a[h]=4,o[h]=1,n[h]=4*t[h]+2*t[h+1];s[r-1]=2,a[r-1]=7,o[r-1]=0,n[r-1]=8*t[r-1]+t[r];for(h=1;h<r;h++){var l=s[h]/a[h-1];a[h]=a[h]-l*o[h-1],n[h]=n[h]-l*n[h-1]}e[r-1]=n[r-1]/a[r-1];for(h=r-2;0<=h;--h)e[h]=(n[h]-o[h]*e[h+1])/a[h];for(h=0;h<r-1;h++)i[h]=2*t[h+1]-e[h+1];return i[r-1]=.5*(t[r]+e[r-1]),{p1:e,p2:i}},DSLineSeries.prototype.pathString=function(t,e,i,r){for(var s="",a=0,o=t.length,n=0;n<o;n++)Math.floor(e[n])<=Math.ceil(i)&&Math.ceil(e[n])>=Math.floor(r)?0==(a=""==e[n]?0:a)?""!=e[n]&&(s+="M"+t[n]+","+e[n],a++):s+="L"+t[n]+","+e[n]:a=0;return s},DSLineSeries.prototype.pathStringContinuous=function(t,e,i,r){for(var s="",a=t.length,o=0;o<a;o++)if(""==e[o]){for(var n=0,h=0,l=o-1;0<=l;l--)if(""!=this.yPositionArray[l]&&null!=this.yPositionArray[l]&&!isNaN(this.yPositionArray[l])){n=l;break}for(var m=o+1;m<=this.xPositionArray.length;m++)if(""!=this.yPositionArray[m]&&null!=this.yPositionArray[m]&&!isNaN(this.yPositionArray[m])){h=m;break}""==this.yPositionArray[n]||null==this.yPositionArray[n]||isNaN(this.yPositionArray[n])||0==h||(s=(s+="M"+t[n]+","+e[n])+"L"+t[h]+","+e[h])}return s};
//# sourceMappingURL=DecompositionChart.min.js.map